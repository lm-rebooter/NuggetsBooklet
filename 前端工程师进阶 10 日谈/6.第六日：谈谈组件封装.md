# ç¬¬å…­å¤© UIç»„ä»¶å°è£…

## ç¬¬ä¸€ä¸ªæ•…äº‹ï¼šé¦–é¡µè½®æ’­å›¾

ç»„ä»¶å°è£…æ˜¯ä¸€ä¸ªå‰ç«¯å·¥ç¨‹å¸ˆè¿›é˜¶çš„å¿…ç»ä¹‹è·¯ã€‚ç»„ä»¶å°è£…æ˜¯æŒ‡Webé¡µé¢ä¸ŠæŠ½å‡ºæ¥ä¸€ä¸ªä¸ªåŒ…å«æ¨¡ç‰ˆï¼ˆHTMLï¼‰ã€åŠŸèƒ½ï¼ˆJavascriptï¼‰å’Œæ ·å¼ï¼ˆCSSï¼‰çš„å•å…ƒã€‚æ‰€ä»¥ï¼Œä»Šå¤©çš„å†…å®¹ï¼Œæˆ‘ä»¬å°†å¸¦ä½ äº†è§£ç»„ä»¶å°è£…çš„å¼€å‘æ€è·¯ï¼Œè®©ä½ çš„ç»„ä»¶å…·å¤‡**å°è£…æ€§**ã€**æ­£ç¡®æ€§**ã€**æ‰©å±•æ€§**å’Œ**å¤ç”¨æ€§**ã€‚

æˆ‘ä»¬ä»¥å®ç°ä¸€ä¸ªé¦–é¡µè½®æ’­å›¾çš„UIç»„ä»¶ä¸ºä¾‹ï¼Œè¿™ä¸ªç»„ä»¶çš„æ•ˆæœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/dc61f6b645bc4180b4b64c556b7d149a~tplv-k3u1fbpfcp-zoom-1.image)

ä¸Šå›¾ä¸­çš„ç»„ä»¶å®ç°äº†3ä¸ªåŠŸèƒ½ï¼š

1. å››å¼ å›¾ç‰‡å¾ªç¯æ’­æ”¾ï¼Œæ¯å¼ å›¾ç‰‡åœç•™è‹¥å¹²æ—¶é—´ï¼›
1. å½“ç”¨æˆ·ç‚¹å‡»å·¦å³ä¸¤è¾¹çš„å°ç®­å¤´æ—¶ï¼Œå›¾ç‰‡åˆ†åˆ«åˆ‡æ¢åˆ°ä¸Šä¸€å¼ /ä¸‹ä¸€å¼ ï¼›
1. å½“ç”¨æˆ·ç‚¹å‡»åº•éƒ¨çš„å°åœ†ç‚¹çš„æ—¶å€™ï¼Œåˆ™ç«‹å³è·³åˆ°å°åœ†ç‚¹é¡ºåºæ‰€å¯¹åº”çš„é‚£å¼ å›¾ç‰‡ã€‚

ä¸‹é¢ï¼Œæˆ‘ä»¬å°±å¸¦ä½ ä¸€æ­¥æ­¥å®ç°è¿™ä¸ªç»„ä»¶ï¼š

### ç¬¬ä¸€æ­¥ï¼šç¡®å®šUIç»„ä»¶çš„HTMLç»“æ„ã€‚

æ ¹æ®æ•ˆæœå›¾ï¼Œè¿™ä¸ªç»„ä»¶åŒ…å«äº†4å¼ å›¾ç‰‡ï¼Œ4å¼ å›¾ç‰‡å°±éœ€è¦æœ‰4ä¸ªHTMLå…ƒç´ æ¥å°è£…ã€‚ä½ å¯ä»¥é‡‡ç”¨4ä¸ªå—çº§å…ƒç´ æ¥å®‰æ’ï¼Œæ¯”å¦‚`div`å…ƒç´ ç­‰ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥å°†è¿™4å¼ å›¾çœ‹ä½œæ˜¯ä¸€ä¸ªå›¾ç‰‡åˆ—è¡¨ï¼Œä½¿ç”¨åˆ—è¡¨å…ƒç´ ä½œä¸ºå›¾ç‰‡çš„å®¹å™¨ï¼š

```html
<div class="slider">
  <ul>
    <li class="slider__item--selected">
      <img src="https://p5.ssl.qhimg.com/t0119c74624763dd070.png"/>
    </li>
    <li class="slider__item">
      <img src="https://p4.ssl.qhimg.com/t01adbe3351db853eb3.jpg"/>
    </li>
    <li class="slider__item">
      <img src="https://p2.ssl.qhimg.com/t01645cd5ba0c3b60cb.jpg"/>
    </li>
    <li class="slider__item">
      <img src="https://p4.ssl.qhimg.com/t01331ac159b58f5478.jpg"/>
    </li>
  </ul>
  <a class="slider__next"></a>
  <a class="slider__previous"></a>
  <div class="slider__control">
    <span class="slider__control-buttons--selected"></span>
    <span class="slider__control-buttons"></span>
    <span class="slider__control-buttons"></span>
    <span class="slider__control-buttons"></span>
  </div>
</div>
```

ä¸Šé¢çš„HTMLç»“æ„ä¸­ï¼Œé¦–å…ˆæ˜¯ä¸€ä¸ªå¤§çš„å®¹å™¨ï¼Œ`div.slider`ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ª`ul`åˆ—è¡¨ï¼Œåˆ—è¡¨ä¸­æ˜¯åŒ…å«å››å¼ å›¾ç‰‡çš„å››ä¸ª`li`å…ƒç´ ã€‚

è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸¤ä¸ª`<a>`å…ƒç´ åˆ†åˆ«è¡¨ç¤ºâ€œä¸‹ä¸€å¼ â€œå’Œâ€ä¸Šä¸€å¼ â€œçš„æ§åˆ¶
```html
<a class="slider__next"></a> 
<a class="slider__previous"></a>
```

ç”¨å››ä¸ª`<span>`å…ƒç´ è¡¨ç¤ºåº•éƒ¨çš„å››ä¸ªå°åœ†ç‚¹çš„æ§åˆ¶ï¼š

```html
<div class="slider__control">
  <span class="slider__control-buttons--selected"></span>
  <span class="slider__control-buttons"></span>
  <span class="slider__control-buttons"></span>
  <span class="slider__control-buttons"></span>
</div>
```

_å½“ç„¶è¿™äº›æ§åˆ¶ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨å…¶ä»–çš„HTMLå…ƒç´ æ¥è¡¨ç¤ºã€‚_

ğŸ’¡æ³¨æ„ï¼šè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨çš„CSSè§„åˆ™åæœ‰ç‚¹ç‰¹åˆ«ï¼Œå¦‚æœä½ æ˜¯ç¬¬ä¸€æ¬¡è§åˆ°å¯èƒ½ä¼šè§‰å¾—æœ‰äº›å¥‡æ€ªã€‚å®é™…ä¸Šè¿™é‡Œçš„å‘½åæ˜¯ä¸€ç§CSSä¹¦å†™è§„èŒƒï¼Œå«åš`BEM`ï¼Œæ˜¯è‹±æ–‡`Block-Element-Modifier`çš„ç®€å†™ã€‚

è¿™ä¸€è§„èŒƒé‡‡ç”¨ä¸‰ä¸ªéƒ¨åˆ†æ¥æè¿°è§„åˆ™ï¼Œé¦–å…ˆæ˜¯Blockè¡¨ç¤ºç»„ä»¶åï¼Œè¿™ä¸ªä»»åŠ¡æ˜¯å†™è½®æ’­å›¾ï¼Œæˆ‘ä»¬ç»™è¿™ä¸ªç»„ä»¶èµ·åå­—å«`slider`ã€‚ç„¶åæ˜¯Elementï¼Œæ¯”å¦‚å¯¹åº”çš„åˆ—è¡¨é¡¹`li`å…ƒç´ ï¼Œè¡¨ç¤ºitemï¼Œæ‰€ä»¥å®ƒçš„classå°±æ˜¯`slider__item`ï¼Œè¿™é‡ŒBlockå’ŒElementä¹‹é—´ä½¿ç”¨åŒä¸‹åˆ’çº¿`__`è¿æ¥ã€‚æœ€åæ˜¯Modifierè¡¨ç¤ºçŠ¶æ€ï¼Œå…¶ä¸­ä¸€ä¸ªåˆ—è¡¨çš„çŠ¶æ€æ˜¯`selected`ï¼Œæ‰€ä»¥æœ€ç»ˆçš„classæ˜¯`slider__item--selected`ï¼Œè¿™é‡ŒElementå’ŒModifierä¹‹é—´ä½¿ç”¨åŒæ¨ªæ `--`è¿æ¥ã€‚

åœ¨æ¯”è¾ƒå¤æ‚çš„UIç»„ä»¶ä¸­ï¼Œä½¿ç”¨`BEM`æœ‰å‡ ä¸ªå¥½å¤„ï¼š

1. è®©CSSè§„åˆ™ä¿æŒç›¸å¯¹ç®€å•ï¼Œåªç”¨ä¸€ä¸ªclasså°±èƒ½å®šä½å¯¹åº”çš„å…ƒç´ ï¼Œè¿™æ ·ä¼˜å…ˆçº§ä¹Ÿç›¸å¯¹æ‰å¹³ï¼Œç®¡ç†èµ·æ¥ä¸å®¹æ˜“å†²çªã€‚

1. é˜…è¯»ä»£ç çš„äººä¸€çœ¼å¯ä»¥çŸ¥é“ä¸€ä¸ªå…ƒç´ æ˜¯å“ªä¸ªç»„ä»¶çš„å“ªä¸ªéƒ¨åˆ†ã€‚ç”±äºç»„ä»¶å¤æ‚çš„æ—¶å€™ï¼ŒHTMLä»£ç æ¯”è¾ƒé•¿ï¼Œå¯èƒ½å…ƒç´ ç¦»ç»„ä»¶å®¹å™¨æ¯”è¾ƒè¿œï¼Œå¦‚æœä½¿ç”¨æ™®é€šå±‚çº§å…³ç³»ï¼Œä½ çœ‹åˆ°ä¸€ä¸ª`.item`å…ƒç´ ï¼Œé™¤éæ‰¾åˆ°å¤–å±‚çš„`.slider`ï¼Œä½ æ‰èƒ½çŸ¥é“å®ƒå±äº`.slider`ç»„ä»¶è€Œä¸æ˜¯å…¶ä»–ç»„ä»¶çš„`.item`ï¼Œé‚£æ ·åœ¨HTMLä»£ç å¾ˆå¤æ‚çš„æ—¶å€™æ‰¾èµ·æ¥å°±æ¯”è¾ƒè´¹åŠ²ã€‚

### ç¬¬äºŒæ­¥ï¼šè®¾ç½®å…ƒç´ çš„æ ·å¼

ç„¶åæ ¹æ®æ•ˆæœå›¾ï¼Œæˆ‘ä»¬ç»™è¿™æ®µHTMLä»£ç æ·»åŠ CSSæ ·å¼ã€‚

é¦–å…ˆï¼Œæˆ‘ä»¬ç»™`class=slider`çš„`div`å…ƒç´ è®¾ç½®äº†å®½åº¦å’Œé«˜åº¦ï¼Œä»¥åŠå–æ¶ˆ`ul`å…ƒç´ é»˜è®¤çš„åˆ—è¡¨æ ·å¼ï¼š

```css
.slider {
  position: relative;
  width: 790px;
  height: 340px;
}

.slider ul {
  list-style-type:none;
  position: relative;
  width: 100%;
  height: 100%;
  padding: 0;
  margin: 0;
}
```

ç„¶åï¼Œå°†`class=slider__item`å’Œ`class=slider__item--selected`çš„`li`å…ƒç´ çš„positionå±æ€§è®¾ç½®ä¸ºç»å¯¹å®šä½ï¼ˆabsoluteï¼‰ï¼Œè¿™æ ·å°±èƒ½å¤Ÿå°†è¿™4å¼ å›¾ç‰‡é‡å æ˜¾ç¤ºåœ¨åŒä¸€ä¸ªä½ç½®ã€‚å¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼š

```css
.slider__item,
.slider__item--selected {
  position: absolute;
  transition: opacity 1s;
  opacity: 0;
  text-align: center;
}

.slider__item--selected {
  transition: opacity 1s;
  opacity: 1;
}
```

å…¶ä¸­ï¼Œ`transition: opacity 1s`è¡¨ç¤ºè®¾ç½®å›¾ç‰‡é€æ˜åº¦å˜åŒ–çš„åŠ¨ç”»ï¼Œæ—¶é—´ä¸º1ç§’ã€‚çŠ¶æ€ä¸º`slider__item`æ—¶ï¼Œæ˜¾ç¤ºä¸ºé€æ˜ã€‚çŠ¶æ€ä¸º`slider__item--selected`æ—¶æ˜¾ç¤ºä¸ºä¸é€æ˜ã€‚

æ¥ç€æ˜¯æ§åˆ¶å…ƒç´ çš„æ ·å¼ï¼š

```css
.slider__next,
.slider__previous{
  display: inline-block;
  position: absolute;
  top: 50%; /*å®šä½åœ¨å½•æ’­å›¾ç»„ä»¶çš„çºµå‘ä¸­é—´çš„ä½ç½®*/
  margin-top: -25px;
  width: 30px;
  height:50px;
  text-align: center;
  font-size: 24px;
  line-height: 50px;
  overflow: hidden;
  border: none;
  color: white;
  background: rgba(0,0,0,0.2); /*è®¾ç½®ä¸ºåŠé€æ˜*/
  cursor: pointer; /*è®¾ç½®é¼ æ ‡ç§»åŠ¨åˆ°è¿™ä¸ªå…ƒç´ æ—¶æ˜¾ç¤ºä¸ºæ‰‹æŒ‡çŠ¶*/
  opacity: 0; /*åˆå§‹çŠ¶æ€ä¸ºé€æ˜*/
  transition: opacity .5s; /*è®¾ç½®é€æ˜åº¦å˜åŒ–çš„åŠ¨ç”»ï¼Œæ—¶é—´ä¸º.5ç§’*/
}

.slider__previous {
  left: 0; /*å®šä½åœ¨sliderå…ƒç´ çš„æœ€å·¦è¾¹*/
}

.slider__next {
  right: 0; /*å®šä½åœ¨sliderå…ƒç´ çš„æœ€å³è¾¹*/
}

.slider:hover .slider__previous {
  opacity: 1;
}

.slider:hover .slider__next {
  opacity: 1;
}

.slider__previous:after {
  content: '<';
}

.slider__next:after {
  content: '>';
}
```

ä¸Šé¢çš„è§„åˆ™ä¸­ï¼Œ`.slider__next,
.slider__previous`åˆ†åˆ«è¡¨ç¤ºâ€œå‘ä¸‹ä¸€å¼ â€å’Œâ€œå‘ä¸Šä¸€å¼ â€çš„æ§åˆ¶ã€‚åˆå§‹çŠ¶æ€ä¸‹ï¼Œè¿™ä¸¤ä¸ªæ§åˆ¶å…ƒç´ çš„èƒŒæ™¯è‰²ä¸ºåŠé€æ˜ï¼Œå­—ä½“é¢œè‰²æ˜¯ç™½è‰²ã€‚

`.slider:hover .slider__previous` å’Œ `.slider:hover .slider__next`è¿™ä¸¤æ¡è§„åˆ™è¡¨ç¤ºå½“é¼ æ ‡æ‚¬åœåœ¨`class=slider`çš„å…ƒç´ ä¸Šæ—¶ï¼Œæ˜¾ç¤ºå·¦å³ä¸¤ä¾§çš„æ§åˆ¶å…ƒç´ ã€‚

æœ€åï¼Œå®šä¹‰åº•éƒ¨å››ä¸ªå°ç‚¹çš„æ ·å¼ï¼š

```css
.slider__control{
  position: relative;
  display: table; /* table å¸ƒå±€*/
  background-color: rgba(255, 255, 255, 0.5);
  padding: 5px;
  border-radius: 12px;
  bottom: 30px;
  margin: auto;
}

.slider__control-buttons,
.slider__control-buttons--selected{
  display: inline-block;
  width: 15px;
  height: 15px;
  border-radius: 50%;/*è®¾ç½®ä¸ºåœ†å½¢*/
  margin: 0 5px;
  background-color: white;
  cursor: pointer;
}

.slider__control-buttons--selected {
  background-color: red;
}
```

ä¸Šé¢çš„è§„åˆ™ä¸­ï¼Œ

- ç¬¬ä¸€æ¡è§„åˆ™è¡¨ç¤ºç»™å››ä¸ªå°åœ†ç‚¹è®¾ç½®ä¸€ä¸ªç°è‰²çš„èƒŒæ™¯ã€‚å…¶ä¸­çš„`position: relative; display: table;`å£°æ˜è¡¨ç¤ºå°†å®ƒçš„å­å…ƒç´ ï¼ˆä¹Ÿå°±æ˜¯4ä¸ªå°åœ†ç‚¹ï¼‰é‡‡ç”¨ç›¸å¯¹å®šä½å’Œtableå¸ƒå±€ï¼Œè®©å®ƒä»¬å›ºå®šæ˜¾ç¤ºåœ¨å›¾ç‰‡ä¸­éƒ¨ä¸‹æ–¹ã€‚

- ç¬¬äºŒæ¡è§„åˆ™è®¾ç½®äº†å°åœ†ç‚¹çš„å¤§å°ï¼Œå½¢çŠ¶ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œå°åœ†ç‚¹çš„é¢œè‰²ï¼ˆç™½è‰²ï¼‰ï¼Œä»¥åŠé¼ æ ‡æ»‘å…¥åçš„çŠ¶æ€ï¼ˆpointer)

- ç¬¬ä¸‰æ¡è§„åˆ™è¡¨ç¤ºï¼Œå½“é€‰æ‹©åï¼Œå°åœ†ç‚¹çš„é¢œè‰²å˜æˆçº¢è‰²ã€‚

### ç¬¬ä¸‰æ­¥ï¼šè®¾è®¡API

é¡µé¢çš„ä¸»ä½“ç»“æ„å’Œæ ·å¼å®Œæˆä¹‹åï¼Œæˆ‘ä»¬éœ€è¦æ ¹æ®ç»„ä»¶çš„åŠŸèƒ½ï¼Œä¸ºè¯¥ç»„ä»¶è®¾è®¡APIã€‚

æˆ‘ä»¬å›é¡¾ä¸€ä¸‹è¿™ä¸ªç»„ä»¶çš„éœ€æ±‚ï¼š

- å››å¼ å›¾ç‰‡å¾ªç¯æ’­æ”¾ï¼Œæ¯å¼ å›¾ç‰‡åœç•™è‹¥å¹²æ—¶é—´ï¼›
- å½“ç”¨æˆ·ç‚¹å‡»å·¦å³ä¸¤è¾¹çš„å°ç®­å¤´æ—¶ï¼Œå›¾ç‰‡åˆ†åˆ«åˆ‡æ¢åˆ°ä¸Šä¸€å¼ /ä¸‹ä¸€å¼ ï¼›
- å½“ç”¨æˆ·ç‚¹å‡»ä¸­ä¸‹éƒ¨çš„å°åœ†ç‚¹çš„æ—¶å€™ï¼Œåˆ™ç«‹å³è·³åˆ°å°åœ†ç‚¹é¡ºåºæ‰€å¯¹åº”çš„é‚£å¼ å›¾ç‰‡ã€‚

æ ¹æ®ä¸Šè¿°çš„éœ€æ±‚å‘¢ï¼Œæˆ‘ä»¬è®¾è®¡äº†4ä¸ªç»„ä»¶API:

- slideTo(idx) - åˆ‡æ¢æ˜¾ç¤ºidxæŒ‡ç¤ºä½ç½®çš„å›¾ç‰‡
- slideNext() - åˆ‡æ¢åˆ°ä¸‹ä¸€å¼ å›¾
- slidePrevious() - åˆ‡æ¢åˆ°ä¸Šä¸€å¼ å›¾
- getSelectedItem() - è·å–é€‰ä¸­çš„å›¾ç‰‡
- getSelectedItemIndex() - è·å–é€‰ä¸­çš„å›¾ç‰‡çš„ä½ç½®

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/28bdaa91489d4af59988a24f83c9f46c~tplv-k3u1fbpfcp-zoom-1.image)

ç„¶åï¼Œå°†è¿™ä¸ªç»„ä»¶å°è£…ä¸ºä¸€ä¸ªç±»â€”â€”sliderï¼š

```js
class Slider {
  constructor({container}) {
    this.container = container;
    this.items = Array.from(container.querySelectorAll('.slider__item, .slider__item--selected'));
  }

  /*
    é€šè¿‡é€‰æ‹©å™¨`.slider__item--selected`è·å¾—è¢«é€‰ä¸­çš„å…ƒç´ 
  */
  getSelectedItem() {
    const selected = this.container.querySelector('.slider__item--selected');
    return selected;
  }

  /*
    è¿”å›é€‰ä¸­çš„å…ƒç´ åœ¨itemsæ•°ç»„ä¸­çš„ä½ç½®ã€‚
  */
  getSelectedItemIndex() {
    return this.items.indexOf(this.getSelectedItem());
  }

  slideTo(idx) {
    const selected = this.getSelectedItem();
    if(selected) { // å°†ä¹‹å‰é€‰æ‹©çš„å›¾ç‰‡æ ‡è®°ä¸ºæ™®é€šçŠ¶æ€
      selected.className = 'slider__item';
    }
    const item = this.items[idx];
    if(item) { // å°†å½“å‰é€‰ä¸­çš„å›¾ç‰‡æ ‡è®°ä¸ºé€‰ä¸­çŠ¶æ€
      item.className = 'slider__item--selected';
    }
  }

  /*
    å°†ä¸‹ä¸€å¼ å›¾ç‰‡æ ‡è®°ä¸ºé€‰ä¸­çŠ¶æ€
  */
  slideNext() {
    const currentIdx = this.getSelectedItemIndex();
    const nextIdx = (currentIdx + 1) % this.items.length;
    this.slideTo(nextIdx);
  }

  /*
    å°†ä¸Šä¸€å¼ å›¾ç‰‡æ ‡è®°ä¸ºé€‰ä¸­çŠ¶æ€
  */
  slidePrevious() {
    const currentIdx = this.getSelectedItemIndex();
    const previousIdx = (this.items.length + currentIdx - 1) % this.items.length;
    this.slideTo(previousIdx);
  }
}
```
ä¸Šé¢çš„ä»£ç ä¸­ï¼šSliderçš„æ„é€ å™¨ä¸­çš„å‚æ•°`{container}`è¡¨ç¤ºæ”¾ç½®è¿™4å¼ å›¾ç‰‡çš„çˆ¶å®¹å™¨ã€‚åœ¨æ„é€ å™¨ä¸­ï¼Œæˆ‘ä»¬è·å–äº†è¿™ä¸ªçˆ¶å®¹å™¨ä¸‹æ‰€æœ‰çš„`<li>`å…ƒç´ ã€‚

ç„¶åï¼Œé€šè¿‡`setInterval`æ–¹æ³•å®ç°å¾ªç¯æ’­æ”¾ï¼Œé—´éš”ä¸º3ç§’ï¼š

```js
const container = document.querySelector('.slider');
const slider = new Slider({container});
setInterval(() => {
  slider.slideNext();
}, 3000);
```

è¿™æ ·ï¼Œæˆ‘ä»¬çš„è½®æ’­å›¾å°±ä»¥æ¯3ç§’çš„åˆ‡æ¢ä¸€æ¬¡é¢‘ç‡åŠ¨èµ·æ¥äº†ã€‚

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d2bc4605c44a40c983b60f65be31ba47~tplv-k3u1fbpfcp-zoom-1.image)

### ç¬¬å››æ­¥ï¼šå®ç°ç”¨æˆ·æ§åˆ¶

å®ç°äº†ç»„ä»¶çš„APIåï¼Œæˆ‘ä»¬è¿˜éœ€è¦å®ç°ç”¨æˆ·æ§åˆ¶åŠŸèƒ½ï¼š

- å½“ç”¨æˆ·ç‚¹å‡»å·¦å³ä¸¤è¾¹çš„å°ç®­å¤´æ—¶ï¼Œå›¾ç‰‡åˆ†åˆ«åˆ‡æ¢åˆ°ä¸Šä¸€å¼ /ä¸‹ä¸€å¼ ï¼Œå¹¶ç‚¹äº®ä¸è¯¥å›¾ç‰‡ç›¸å¯¹åº”çš„å°åœ†ç‚¹ï¼›
- å½“ç”¨æˆ·é¼ æ ‡ç§»è¿›åˆ°åº•éƒ¨å°åœ†ç‚¹æ—¶ï¼Œåˆ™ç«‹å³è·³åˆ°å°åœ†ç‚¹é¡ºåºæ‰€å¯¹åº”çš„é‚£å¼ å›¾ç‰‡ï¼Œåœæ­¢è½®æ’­ï¼›
- å½“ç”¨æˆ·é¼ æ ‡ç§»å‡ºåº•éƒ¨å°åœ†ç‚¹åï¼Œå›¾ç‰‡å†æ¬¡æ¢å¤è½®æ’­ã€‚

æˆ‘ä»¬å°†æ„é€ å™¨ä¿®æ”¹ä¸ºä¸‹é¢è¿™æ ·ï¼š

```js
constructor({container, cycle = 3000} = {}) {
  this.container = container;
  this.items = Array.from(container.querySelectorAll('.slider__item, .slider__item--selected'));
  this.cycle = cycle;

  const controller = this.container.querySelector('.slider__control');
  const buttons = controller.querySelectorAll('.slider__control-buttons, .slider__control-buttons--selected');

  controller.addEventListener('mouseover', (evt) => {
    const idx = Array.from(buttons).indexOf(evt.target);
    if(idx >= 0) {
      this.slideTo(idx);
      this.stop();
    }
  });

  controller.addEventListener('mouseout', (evt) => {
    this.start();
  });

  /*
    æ³¨å†Œslideäº‹ä»¶ï¼Œå°†é€‰ä¸­çš„å›¾ç‰‡å’Œå°åœ†ç‚¹è®¾ç½®ä¸ºselectedçŠ¶æ€
  */
  this.container.addEventListener('slide', (evt) => {
    const idx = evt.detail.index;
    const selected = controller.querySelector('.slider__control-buttons--selected');
    if(selected) selected.className = 'slider__control-buttons';
    buttons[idx].className = 'slider__control-buttons--selected';
  });

  const previous = this.container.querySelector('.slider__previous');
  previous.addEventListener('click', (evt) => {
    this.stop();
    this.slidePrevious();
    this.start();
    evt.preventDefault();
  });

  const next = this.container.querySelector('.slider__next');
  next.addEventListener('click', (evt) => {
    this.stop();
    this.slideNext();
    this.start();
    evt.preventDefault();
  });
}
```

å¦‚ä¸Šä»£ç æ‰€ç¤ºï¼Œå‚æ•°`cycle`è¡¨ç¤ºå¾ªç¯æ’­æ”¾çš„æ—¶é—´é—´éš”ï¼Œé»˜è®¤ä¸º3ç§’ã€‚ç„¶åæ˜¯æ¯ä¸ªæ§åˆ¶å…ƒç´ ç›¸åº”çš„äº‹ä»¶å¤„ç†ã€‚ä¸‹é¢ï¼Œæˆ‘ä»¬æ¥ä¾æ¬¡åˆ†æä¸€ä¸‹å®ƒä»¬ã€‚

ç¬¬ä¸€ä¸ªç”¨æˆ·äº‹ä»¶ï¼šå½“é¼ æ ‡ç§»å…¥æˆ–ç§»å‡ºå°åœ†ç‚¹äº‹ä»¶

```js
const controller = this.container.querySelector('.slider__control');

const buttons = controller.querySelectorAll('.slider__control-buttons, .slider__control-buttons--selected');

controller.addEventListener('mouseover', (evt) =>{
  const idx = Array.from(buttons).indexOf(evt.target);
  if(idx >= 0){
    this.slideTo(idx);
    this.stop(); // åœæ­¢è‡ªåŠ¨å¾ªç¯æ’­æ”¾
  }
});

controller.addEventListener('mouseout', (evt) => {
  this.start(); // å¼€å§‹è‡ªåŠ¨å¾ªç¯æ’­æ”¾
});
```
ä¸Šé¢ä»£ç è¡¨ç¤ºï¼šå½“é¼ æ ‡ç§»åŠ¨åˆ°å°åœ†ç‚¹ä¸Šæ–¹çš„æ—¶å€™ï¼ˆmouseoverï¼‰ï¼Œåˆ¤æ–­å½“å‰é€‰ä¸­çš„æ˜¯ç¬¬å‡ ä¸ªå°åœ†ç‚¹ï¼Œåœæ­¢è‡ªåŠ¨å¾ªç¯æ’­æ”¾åŠŸèƒ½ï¼Œç„¶ååˆ‡æ¢åˆ°å¯¹åº”çš„å›¾ç‰‡ã€‚å½“é¼ æ ‡ç§»å‡ºcontrollerå…ƒç´ åï¼ˆmouseoutï¼‰ï¼Œé‡å¯è‡ªåŠ¨å¾ªç¯æ’­æ”¾åŠŸèƒ½ã€‚

è¿™é‡Œå‘¢ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹çœ‹`stop()`å’Œ`start()`çš„å®ç°ï¼š

```js
start() {
  this.stop();
  this._timer = setInterval(() => this.slideNext(), this.cycle);
}

stop() {
  clearInterval(this._timer);
}
```

å¦‚ä¸Šä»£ç æ‰€ç¤ºï¼š`start()`æ–¹æ³•å¯åŠ¨äº†ä¸€ä¸ªå®šæ—¶å™¨ï¼Œæ¯éš”`cycle`ç§’æ‰§è¡Œä¸€æ¬¡`slideNext()`ã€‚`stop()`åˆ™æ˜¯åœæ­¢è¿™ä¸ªå®šæ—¶å™¨ã€‚


ç¬¬äºŒä¸ªç”¨æˆ·äº‹ä»¶ï¼šç‚¹å‡»ä¸Šä¸€å¼ æˆ–ä¸‹ä¸€å¼ äº‹ä»¶

```js
const previous = this.container.querySelector('.slider__previous');
previous.addEventListener('click', evt => {
  this.stop();
  this.slidePrevious();
  this.start();
  evt.preventDefault();
});

const next = this.container.querySelector('.slider__next');
next.addEventListener('click', evt => {
  this.stop();
  this.slideNext();
  this.start();
  evt.preventDefault();
});
```
å¦‚ä¸Šä»£ç æ‰€ç¤ºï¼šå½“ç”¨æˆ·ç‚¹å‡»ä¸Šä¸€å¼ æ—¶ï¼Œç¨‹åºåœæ­¢å®šæ—¶å™¨ï¼Œç„¶åæ‰§è¡Œ`slidePrevious()`æ–¹æ³•ï¼Œè®©å›¾ç‰‡å‘å‰ç¿»ä¸€å¼ ï¼Œç„¶åé‡å¯å®šæ—¶å™¨ã€‚ç±»ä¼¼çš„ï¼Œå½“ç”¨æˆ·ç‚¹å‡»ä¸‹ä¸€å¼ æ—¶ï¼Œå…ˆåœæ­¢å®šæ—¶å™¨ï¼Œç„¶åå‘åç¿»ä¸€å¼ ï¼Œå†é‡å¯å®šæ—¶å™¨ã€‚

ç¬¬ä¸‰ä¸ªæ˜¯å¤„ç†ä¸€ä¸ªè‡ªå®šä¹‰äº‹ä»¶ â€”â€” slideäº‹ä»¶ï¼š

```js
this.container.addEventListener('slide', evt => {
  const idx = evt.detail.index
  const selected = controller.querySelector('.slider__control-buttons--selected');
  if(selected) selected.className = 'slider__control-buttons';
  buttons[idx].className = 'slider__control-buttons--selected';
});
```

å¯¹åº”åœ°ï¼Œä¿®æ”¹`slideTo`æ–¹æ³•ï¼ŒåŠ å…¥è‡ªå®šä¹‰äº‹ä»¶è§¦å‘ã€‚

```js
slideTo(idx) {
  const selected = this.getSelectedItem();
  if(selected) {
    selected.className = 'slider__item';
  }
  const item = this.items[idx];
  if(item) {
    item.className = 'slider__item--selected';
  }

  const detail = {index: idx};
  const event = new CustomEvent('slide', {bubbles: true, detail});
  this.container.dispatchEvent(event);
}
```

è¿™ä¸ªè‡ªå®šä¹‰äº‹ä»¶ï¼ˆCustomEventï¼‰ï¼Œå®ƒçš„ä½œç”¨æ˜¯è®©åº•éƒ¨å°åœ†ç‚¹æ§ä»¶ç›‘å¬`slideTo`æ–¹æ³•ã€‚å½“`slideTo`æ–¹æ³•æ‰§è¡Œåï¼Œè¿™ä¸ªæ–¹æ³•å°±ä¼šåˆ†å‘ä¸€æ¬¡`slide`äº‹ä»¶ï¼Œç„¶ååœ¨è¿™ä¸ªäº‹ä»¶ä¸­ï¼Œæ›´æ–°åº•éƒ¨å°åœ†ç‚¹çš„çŠ¶æ€ï¼Œè®©å°åœ†ç‚¹çš„çŠ¶æ€å’Œå„è‡ªçš„å›¾ç‰‡çŠ¶æ€å¯¹åº”èµ·æ¥ã€‚

æœ€åå°†è°ƒç”¨è¿‡ç¨‹æ”¹æˆï¼š

```js
const slider = new Slider({container});
slider.start();
```

åˆ°æ­¤ï¼Œè¿™ä¸ªç»„ä»¶çš„å…¨éƒ¨åŠŸèƒ½å°±å®Œæˆäº†ã€‚[åœ¨çº¿æ¼”ç¤º](https://junyux.github.io/FE-Advance/day06/index1.html)

é€šè¿‡è½®æ’­ç»„ä»¶ç¼–å†™è¿‡ç¨‹ï¼Œæˆ‘ä»¬å¯ä»¥æ€»ç»“ä¸€ä¸‹ç»„ä»¶è®¾è®¡çš„ä¸€èˆ¬æ€§æ­¥éª¤ï¼š

1. è®¾è®¡HTMLç»“æ„
1. è®¾è®¡ç»„ä»¶çš„API
1. è®¾è®¡ç”¨æˆ·æ§åˆ¶æµç¨‹

ä»ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™ä¸ªè½®æ’­ç»„ä»¶å®ç°äº†**å°è£…æ€§**å’Œ**æ­£ç¡®æ€§**ï¼Œä½†æ˜¯ç¼ºå°‘äº†**å¯æ‰©å±•æ€§**ã€‚è¿™ä¸ªç»„ä»¶åªèƒ½æ»¡è¶³è‡ªèº«çš„ä½¿ç”¨ï¼Œå®ƒçš„å®ç°ä»£ç å¾ˆéš¾æ‰©å±•åˆ°å…¶ä»–çš„ç»„ä»¶ï¼Œå½“æœ‰åŠŸèƒ½å˜åŒ–æ—¶ï¼Œä¹Ÿéœ€è¦ä¿®æ”¹å…¶è‡ªèº«å†…éƒ¨çš„ä»£ç ã€‚

æ¯”å¦‚äº§å“ç»ç†å› ä¸ºæŸç§åŸå› ï¼Œå¸Œæœ›å°†å›¾ç‰‡ä¸‹æ–¹çš„å°åœ†ç‚¹æš‚æ—¶å»æ‰ï¼Œåªä¿ç•™å·¦å³ç®­å¤´ã€‚é‚£ä¹ˆåœ¨è¿™ä¸ªç‰ˆæœ¬ä¸­ï¼Œå°±éœ€è¦è¿™ä¹ˆåšï¼š

1. æ³¨é‡Šæ‰HTMLä¸­`.slider__control`ç›¸å…³çš„ä»£ç 
1. ä¿®æ”¹Sliderç»„ä»¶ï¼Œæ³¨é‡Šæ‰ä¸å°åœ†ç‚¹æ§åˆ¶ç›¸å…³çš„ä»£ç 

åˆæˆ–è€…ï¼Œå°†æ¥éœ€è¦ä¸ºè¿™ä¸ªç»„ä»¶æ·»åŠ æ–°çš„ç”¨æˆ·æ§åˆ¶ï¼Œéƒ½éœ€è¦å¯¹è¿™ä¸ªç»„ä»¶è¿›è¡Œå†ä¿®æ”¹ã€‚

é‚£ä¹ˆï¼Œå¦‚ä½•å¯ä»¥é¿å…è¿™æ ·çš„ä¿®æ”¹ï¼Œè®©ç»„ä»¶å…·å¤‡**å¯æ‰©å±•æ€§**å‘¢ï¼Ÿ

## ç¬¬äºŒä¸ªæ•…äº‹ï¼šç»„ä»¶çš„æ’ä»¶åŒ–

ä¸Šä¸€ä¸ªæ•…äº‹ä¸­çš„è½®æ’­ç»„ä»¶å°è£…ï¼Œæˆ‘ä»¬å®ç°äº†**å°è£…æ€§**å’Œ**æ­£ç¡®æ€§**ã€‚ä½†è¿™ä»…èƒ½æ»¡è¶³é¡¹ç›®å½“å‰çš„åŸºæœ¬è¦æ±‚ï¼Œæ˜¯å¯¹åˆçº§å·¥ç¨‹å¸ˆçš„åŸºæœ¬è¦æ±‚ï¼Œè€Œ**å¯æ‰©å±•æ€§**å’Œ**å¯å¤ç”¨æ€§**ï¼Œåˆ™å¯¹äºæ•´ä¸ªé¡¹ç›®çš„æœªæ¥æœ‰å¾ˆå¤§çš„å¸®åŠ©ï¼Œæ˜¯å¯¹é«˜çº§å·¥ç¨‹å¸ˆçš„è¦æ±‚ã€‚åœ¨å‰ç«¯UIç»„ä»¶ä¸­ï¼Œæå‡å¯æ‰©å±•æ€§çš„åŸºæœ¬æ€è·¯ï¼Œæ˜¯**æ’ä»¶åŒ–**ã€‚

é‚£ä¹ˆï¼Œå¯¹äºè¿™ä¸ªå›¾ç‰‡è½®æ’­ç»„ä»¶æ¥è¯´ï¼Œå®ƒçš„æ’ä»¶åŒ–å¯ä»¥æ˜¯å°†ç”¨æˆ·æ§åˆ¶ç»„ä»¶ä»Sliderç»„ä»¶ä¸­å‰¥ç¦»å‡ºæ¥ï¼Œåšæˆæ’ä»¶ï¼Œè¿™æ ·æ‰èƒ½æé«˜Sliderç»„ä»¶çš„å¯æ‰©å±•æ€§ã€‚

åœ¨å›¾ç‰‡è½®æ’­ç»„ä»¶ä¸­ï¼Œç”¨æˆ·çš„æ§åˆ¶ç»„ä»¶åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼šå›¾ç‰‡ä¸‹éƒ¨çš„å°åœ†ç‚¹ä»¥åŠå·¦å³ç¿»é¡µæŒ‰é’®ã€‚æˆ‘ä»¬åˆ†åˆ«ç”¨`controller`ã€`previous`ã€`next`ä¸‰ä¸ªå˜é‡æ¥åˆ†åˆ«å¤„ç†å®ƒä»¬ã€‚

ç°åœ¨æˆ‘ä»¬æ¥é‡æ„ä¸€ä¸‹ä¸Šä¸€ç‰ˆçš„ä»£ç ï¼š

```js
constructor({container, cycle = 3000} = {}) {
  this.container = container;
  this.items = Array.from(container.querySelectorAll('.slider__item, .slider__item--selected'));
  this.cycle = cycle;
}

registerPlugins(...plugins) {
  plugins.forEach(plugin => plugin(this));
}
```

å¦‚ä¸Šä»£ç æ‰€ç¤ºï¼šåœ¨Slidersç±»çš„æ„é€ å™¨ä¸­ï¼Œæˆ‘ä»¬å°†æ³¨å†Œæ§åˆ¶æµç¨‹çš„ä»£ç ç§»é™¤ï¼Œå¢åŠ äº†ä¸€ä¸ªæ–°çš„æ–¹æ³•å«`registerPlugins`ã€‚è¿™ä¸ªæ–¹æ³•æ¥å—ä¸€ç»„å‚æ•°`plugins`ï¼Œæ¯ä¸ª`plugin`æœ¬èº«æ˜¯ä¸€ä¸ªåˆå§‹åŒ–å‡½æ•°ï¼Œå¯ä»¥åšä»»ä½•äº‹æƒ…ã€‚

ç„¶åï¼Œæˆ‘ä»¬å°†ä¹‹å‰å†™åœ¨æ„é€ å™¨çš„æ§åˆ¶æµç¨‹ä»£ç ç§»åˆ°å¯¹åº”çš„æ’ä»¶ä¸­ï¼š

```js
/* å°åœ†ç‚¹æ§ä»¶ */
function pluginController(slider) {
  const controller = slider.container.querySelector('.slider__control');
  if(controller) {
    const buttons = controller.querySelectorAll('.slider__control-buttons, .slider__control-buttons--selected');
    controller.addEventListener('mouseover', (evt) => {
      const idx = Array.from(buttons).indexOf(evt.target);
      if(idx >= 0) {
        slider.slideTo(idx);
        slider.stop();
      }
    });

    controller.addEventListener('mouseout', (evt) => {
      slider.start();
    });

    slider.container.addEventListener('slide', (evt) => {
      const idx = evt.detail.index;
      const selected = controller.querySelector('.slider__control-buttons--selected');
      if(selected) selected.className = 'slider__control-buttons';
      buttons[idx].className = 'slider__control-buttons--selected';
    });
  }
}

function pluginPrevious(slider) {
  const previous = slider.container.querySelector('.slider__previous');
  if(previous) {
    previous.addEventListener('click', (evt) => {
      slider.stop();
      slider.slidePrevious();
      slider.start();
      evt.preventDefault();
    });
  }
}

function pluginNext(slider) {
  const next = slider.container.querySelector('.slider__next');
  if(next) {
    next.addEventListener('click', (evt) => {
      slider.stop();
      slider.slideNext();
      slider.start();
      evt.preventDefault();
    });
  }
}
```

å¦‚ä¸Šä»£ç æ‰€ç¤ºï¼Œ`pluginController`ã€`pluginPrevious`å’Œ`pluginNext`åˆ†åˆ«è¡¨ç¤ºå°åœ†ç‚¹æ§åˆ¶å’Œå·¦å³ç¿»é¡µæ§åˆ¶æ’ä»¶ã€‚æ¯ä¸ªæ’ä»¶æ¥å—ä¸€ä¸ªSliderçš„å®ä¾‹ã€‚ç„¶åï¼Œå°†å„è‡ªçš„ç”¨æˆ·äº‹ä»¶æ³¨å†Œåœ¨å¯¹åº”çš„æ’ä»¶ä¸Šã€‚

ğŸ’¡æ³¨æ„ï¼šæˆ‘ä»¬åœ¨ `Slider.registerPlugins` å¯¹è±¡æ–¹æ³•é‡Œï¼Œç»™æ¯ä¸ª `plugin`ï¼ˆå³ï¼šæ’ä»¶ï¼‰ä¼ å…¥å½“å‰çš„ slider å¯¹è±¡å®ä¾‹ã€‚åœ¨æ’ä»¶çš„åˆå§‹åŒ–å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ‹¿åˆ°è¿™ä¸ª slider å¯¹è±¡ã€‚è¿™ç§å°†ä¾èµ–å¯¹è±¡ä¼ å…¥æ’ä»¶åˆå§‹åŒ–å‡½æ•°çš„æ–¹å¼ï¼Œå«åš**ä¾èµ–æ³¨å…¥**ã€‚

**ä¾èµ–æ³¨å…¥**æ˜¯ä¸€ç§ç»„ä»¶/æ’ä»¶è§£è€¦åˆçš„åŸºæœ¬æ€è·¯ï¼Œåœ¨UIè®¾è®¡ä¸­ç»å¸¸è¢«ä½¿ç”¨ï¼Œåœ¨æˆ‘ä»¬åç»­çš„è¯¾ç¨‹ä¸­è¿˜ä¼šè§åˆ°ã€‚

æœ€åå†å°†æ’ä»¶æ³¨å†Œåˆ°sliderå¯¹è±¡ä¸Šï¼š

```js
const container = document.querySelector('.slider');
const slider = new Slider({container});
slider.registerPlugins(pluginController, pluginPrevious, pluginNext);
slider.start();
```

æ‰€ä»¥ï¼Œæœ€ç»ˆï¼Œè¿™ä¸€ç‰ˆçš„JSä»£ç æ˜¯è¿™æ ·çš„ï¼š

[åœ¨çº¿æ¼”ç¤º](https://junyux.github.io/FE-Advance/day06/index2.html)

```js
class Slider {
  constructor({container, cycle = 3000} = {}) {
    this.container = container;
    this.items = Array.from(container.querySelectorAll('.slider__item, .slider__item--selected'));
    this.cycle = cycle;
  }

  registerPlugins(...plugins) {
    plugins.forEach(plugin => plugin(this));
  }

  /*
    é€šè¿‡é€‰æ‹©å™¨`.slider__item--selected`è·å¾—è¢«é€‰ä¸­çš„å…ƒç´ 
  */
  getSelectedItem() {
    const selected = this.container.querySelector('.slider__item--selected');
    return selected;
  }

  /*
    è¿”å›é€‰ä¸­çš„å…ƒç´ åœ¨itemsæ•°ç»„ä¸­çš„ä½ç½®ã€‚
  */
  getSelectedItemIndex() {
    return this.items.indexOf(this.getSelectedItem());
  }

  slideTo(idx) {
    const selected = this.getSelectedItem();
    if(selected) {
      selected.className = 'slider__item';
    }
    const item = this.items[idx];
    if(item) {
      item.className = 'slider__item--selected';
    }

    const detail = {index: idx};
    const event = new CustomEvent('slide', {bubbles: true, detail});
    this.container.dispatchEvent(event);
  }

  /*
    å°†ä¸‹ä¸€å¼ å›¾ç‰‡æ ‡è®°ä¸ºé€‰ä¸­çŠ¶æ€
  */
  slideNext() {
    const currentIdx = this.getSelectedItemIndex();
    const nextIdx = (currentIdx + 1) % this.items.length;
    this.slideTo(nextIdx);
  }

  /*
    å°†ä¸Šä¸€å¼ å›¾ç‰‡æ ‡è®°ä¸ºé€‰ä¸­çŠ¶æ€
  */
  slidePrevious() {
    const currentIdx = this.getSelectedItemIndex();
    const previousIdx = (this.items.length + currentIdx - 1) % this.items.length;
    this.slideTo(previousIdx);
  }

  start() {
    this.stop();
    this._timer = setInterval(() => this.slideNext(), this.cycle);
  }

  stop() {
    clearInterval(this._timer);
  }
}

/* å°åœ†ç‚¹æ§ä»¶ */
function pluginController(slider) {
  const controller = slider.container.querySelector('.slider__control');
  if(controller) {
    const buttons = controller.querySelectorAll('.slider__control-buttons, .slider__control-buttons--selected');
    controller.addEventListener('mouseover', (evt) => {
      const idx = Array.from(buttons).indexOf(evt.target);
      if(idx >= 0) {
        slider.slideTo(idx);
        slider.stop();
      }
    });

    controller.addEventListener('mouseout', (evt) => {
      slider.start();
    });

    slider.container.addEventListener('slide', (evt) => {
      const idx = evt.detail.index;
      const selected = controller.querySelector('.slider__control-buttons--selected');
      if(selected) selected.className = 'slider__control-buttons';
      buttons[idx].className = 'slider__control-buttons--selected';
    });
  }
}

function pluginPrevious(slider) {
  const previous = slider.container.querySelector('.slider__previous');
  if(previous) {
    previous.addEventListener('click', (evt) => {
      slider.stop();
      slider.slidePrevious();
      slider.start();
      evt.preventDefault();
    });
  }
}

function pluginNext(slider) {
  const next = slider.container.querySelector('.slider__next');
  if(next) {
    next.addEventListener('click', (evt) => {
      slider.stop();
      slider.slideNext();
      slider.start();
      evt.preventDefault();
    });
  }
}

const container = document.querySelector('.slider');
const slider = new Slider({container});
slider.registerPlugins(pluginController, pluginPrevious, pluginNext);
slider.start();
```

è¿™ä¸ªç‰ˆæœ¬ä¸­ï¼Œæˆ‘ä»¬å°†ç»„ä»¶æ ¸å¿ƒå’Œæ’ä»¶éƒ¨åˆ†è¿›è¡Œäº†åˆ†ç¦»ï¼Œè¿™æ ·å°±å…è®¸æˆ‘ä»¬çš„ç»„ä»¶éšæ—¶å‡å°‘æˆ–è€…å¢åŠ ç”¨æˆ·æ§åˆ¶ã€‚æ¯”å¦‚ï¼Œä¸Šä¸€æ•…äº‹ä¸­ï¼Œå½“æˆ‘ä»¬çš„äº§å“ç»ç†è¦æ±‚å»æ‰å›¾ç‰‡ä¸‹æ–¹çš„å°åœ†ç‚¹æ§åˆ¶æ—¶ï¼Œæˆ‘ä»¬è‡ªéœ€è¦ç®€å•å°†å°åœ†ç‚¹ä»æ’ä»¶æ³¨å†Œä¸­å»æ‰ï¼Œå®Œå…¨ä¸éœ€è¦ä¿®æ”¹ç»„ä»¶ä»£ç ã€‚

```js
slider.registerPlugins(pluginPrevious, pluginNext);
```

å¦‚æœï¼Œæœ‰ä¸€å¤©ï¼Œäº§å“ç»ç†åˆéœ€è¦å¯¹è¿™ä¸ªç»„ä»¶æ·»åŠ æ–°çš„ç”¨æˆ·æ§åˆ¶ï¼Œæ¯”å¦‚ï¼Œæ·»åŠ ä¸€ä¸ªæŒ‰é’®å«â€œè¯•è¯•æ‰‹æ°”â€ï¼Œç‚¹å‡»è¯¥æŒ‰é’®ï¼Œè®©è½®æ’­å›¾éšæœºåˆ‡æ¢åˆ°ä¸€å¼ å›¾ç‰‡ä¸Šï¼Œé‚£ä¹ˆä»¬æˆ‘ä»¬åªéœ€è¦è¿™æ ·åšï¼š

åœ¨HTMLä»£ç ä¸­å¢åŠ â€œè¯•è¯•æ‰‹æ°”â€œè¿™ä¸ªæŒ‰é’®ï¼š

```html
<button class="lucky">è¯•è¯•æ‰‹æ°”</button>
```

ç„¶ååˆ›å»ºè¿™ä¸ªæ’ä»¶ï¼š

```js
function  pluginLucky(slider) {
  const luckyBtn = document.querySelector('.lucky');
  if(luckyBtn) {
    luckyBtn.addEventListener('click', evt => {
      slider.stop();
      slider.slideTo(Math.floor(Math.random() * slider.items.length));
      slider.start();
      evt.preventDefault();
    });
  }
}
```

æœ€åå°†å®ƒæ³¨å†Œåˆ°sliderä¸­å»å³å¯ï¼š

```js
slider.registerPlugins(pluginController, pluginPrevious, pluginNext, pluginLucky);
```

ç”±æ­¤å¯è§ï¼Œæ’ä»¶åŒ–ä¹‹åï¼Œç»„ä»¶çš„å¯æ‰©å±•æ€§å¾—åˆ°äº†å¢å¼ºï¼Œç°åœ¨æˆ‘ä»¬å¯ä»¥ä»»æ„æ‰©å±•æ’ä»¶ï¼Œè€Œä¸ç”¨ä¿®æ”¹Slideræœ¬èº«çš„æ ¸å¿ƒä»£ç äº†ã€‚

è¿™æ—¶ï¼Œä½ å¯èƒ½å‘ç°äº†å¦ä¸€ä¸ªé—®é¢˜ â€”â€” ç»„ä»¶çš„HTMLå’ŒJSæ˜¯åˆ†å¼€å†™çš„ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬ä¿®æ”¹ç»„ä»¶æœ¬èº«å’Œå¢åŠ æ’ä»¶çš„æ—¶å€™ï¼Œä¸å¯é¿å…åœ°éœ€è¦åŒæ—¶ä¿®æ”¹HTMLå’ŒJSä»£ç ã€‚

æ¯”å¦‚ï¼Œäº§å“ç»ç†å¸Œæœ›æˆ‘ä»¬å°†å›¾ç‰‡æ•°é‡ä»å››å¼ å¢åŠ ä¸ºå…­å¼ ï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦ä¿®æ”¹ç»„ä»¶å’Œæ’ä»¶çš„HTMLï¼ˆå³ï¼šå¢åŠ `<li>`å…ƒç´ å’Œå°åœ†ç‚¹æ§åˆ¶ï¼‰ã€‚ç”šè‡³ç°åœ¨è¿ä¿®æ”¹ä¸€å¼ å›¾ç‰‡çš„URLï¼Œæˆ‘ä»¬ä¹Ÿéœ€è¦æ‰‹å·¥ä¿®æ”¹HTMLå†…å®¹ã€‚è¿™ä¹Ÿä¸ç¬¦åˆå‰é¢è¯¾ç¨‹ä¸­å­¦è¿‡çš„æ•°æ®æŠ½è±¡åŸåˆ™ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬éœ€è¦å»æ‰ç»„ä»¶çš„HTMLä»£ç ï¼Œè®©JSæ¥æ¸²æŸ“ç»„ä»¶éœ€è¦çš„HTMLã€‚

é‚£ä¹ˆï¼Œæˆ‘ä»¬å¦‚ä½•è®©JSæ¸²æŸ“ç»„ä»¶çš„HTMLå‘¢ï¼Ÿ

## ç¬¬ä¸‰ä¸ªæ•…äº‹ ç»„ä»¶çš„æ¨¡æ¿åŒ–

ä¸ºäº†è®©JSæ¸²æŸ“ç»„ä»¶çš„HTMLï¼Œæˆ‘ä»¬éœ€è¦å°†ç»„ä»¶**æ¨¡æ¿åŒ–**ã€‚

ä¸ºäº†æ–¹ä¾¿å®ç°æ¨¡æ¿åŒ–ï¼Œæˆ‘ä»¬éœ€è¦é‡æ„ç»„ä»¶çš„éƒ¨åˆ†API:

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/97046646db134e5a96b2e84d893dc578~tplv-k3u1fbpfcp-zoom-1.image)

å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬ç»™Sliderç»„ä»¶æ·»åŠ äº†ä¸€ä¸ª`render()`æ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•æ˜¯ç”¨äºæ¸²æŸ“Sliderç»„ä»¶çš„HTMLéƒ¨åˆ†ã€‚ç„¶åï¼Œæˆ‘ä»¬å°†æ’ä»¶ç”±åŸå…ˆå•ä¸€çš„åˆå§‹åŒ–å‡½æ•°é‡æ„ä¸ºä¸€ä¸ªåŒ…å«`render()`æ–¹æ³•å’Œ`initialize()`æ–¹æ³•çš„å¯¹è±¡ã€‚å…¶ä¸­`render()`æ–¹æ³•æ˜¯ç”¨æ¥æ¸²æŸ“æ’ä»¶çš„HTMLéƒ¨åˆ†ï¼Œè€Œ`initialize()`æ–¹æ³•åˆ™æ˜¯ç”¨äºæ³¨å†Œå’Œæ’ä»¶å¯¹åº”çš„ç”¨æˆ·äº‹ä»¶ã€‚

é¦–å…ˆï¼Œæˆ‘ä»¬æ¥æ¸²æŸ“Sliderç»„ä»¶çš„HTMLï¼š

```js
class Slider {
  constructor({container, images = [], cycle = 3000} = {}) {
    this.container = container;
    this.data = images;
    this.container.innerHTML = this.render(this.data);
    this.items = Array.from(this.container.querySelectorAll('.slider__item, .slider__item--selected'));
    this.cycle = cycle;
    this.slideTo(0);
  }

  render(images) {
    const content = images.map(image => `
      <li class="slider__item">
        <img src="${image}"/>
      </li>    
    `.trim());

    return `<ul>${content.join('')}</ul>`;
  }
  
  /*æ­¤å¤„çœç•¥ç»„ä»¶å…¶ä»–çš„API*/
}
```

å¦‚ä¸Šä»£ç æ‰€ç¤ºï¼šæˆ‘ä»¬å°†æ•°æ®æºï¼ˆè¿™é‡Œå°±æ˜¯å›¾ç‰‡æ•°ç»„ï¼‰ä¼ é€’ç»™Sliderç»„ä»¶ã€‚ç„¶åSliderçš„æ„é€ å™¨åˆ©ç”¨è¿™ä¸ªæ•°æ®æºæ¸²æŸ“è‡ªå·±çš„HTML â€”â€” `this.container.innerHTML = this.render(this.data);`ï¼Œå†å°†è¿™éƒ¨åˆ†HTMLæ·»åŠ åˆ°containerå…ƒç´ ä¸­å»ã€‚

```js
const images = ['https://p5.ssl.qhimg.com/t0119c74624763dd070.png',
  'https://p4.ssl.qhimg.com/t01adbe3351db853eb3.jpg',
  'https://p2.ssl.qhimg.com/t01645cd5ba0c3b60cb.jpg',
  'https://p4.ssl.qhimg.com/t01331ac159b58f5478.jpg'];

const container = document.querySelector('.slider');
const slider = new Slider({container, images});
```

ä¸Šé¢è¿™æ®µè°ƒç”¨ä»£ç æ¸²æŸ“çš„ç»“æœå¦‚ä¸‹ï¼š

```HTML
<ul>
  <li class="slider__item">
    <img src="https://p5.ssl.qhimg.com/t0119c74624763dd070.png"/>
  </li>
  <li class="slider__item">
    <img src="https://p4.ssl.qhimg.com/t01adbe3351db853eb3.jpg"/>
  </li>
  <li class="slider__item">
    <img src="https://p2.ssl.qhimg.com/t01645cd5ba0c3b60cb.jpg"/>
  </li>
  <li class="slider__item">
    <img src="https://p4.ssl.qhimg.com/t01331ac159b58f5478.jpg"/>
  </li>
</ul>
```

è¿™æ ·ï¼Œç»„ä»¶çš„HTMLä»£ç éƒ¨åˆ†å°±ç®€åŒ–ä¸ºä¸‹é¢çš„å½¢å¼ï¼š

```html
<div class="slider"></div>
```

<!-- ç„¶åï¼Œæˆ‘ä»¬ä¿®æ”¹äº†`registerPlugin`æ–¹æ³•ï¼Œå…ˆå°†`this.data`æ•°æ®ä¼ ç»™`plugin`çš„`render()`æ–¹æ³•å»æ„é€ æ’ä»¶çš„HTMLç»“æ„ï¼Œç„¶åå†è°ƒç”¨`intialize()`å®Œæˆæ’ä»¶çš„åˆå§‹åŒ–ã€‚ -->

ç„¶åï¼Œæˆ‘ä»¬ä¸ºæ¯ä¸ªæ’ä»¶æ·»åŠ æ¸²æŸ“ä»£ç ï¼š

```js
const pluginController = { // å°åœ†ç‚¹æ’ä»¶
  render(images){ //éšç€å›¾ç‰‡æ•°é‡çš„å¢åŠ ï¼Œå°åœ†ç‚¹å…ƒç´ ä¹Ÿéœ€è¦å¢åŠ 
    return `
      <div class="slider__control">
        ${images.map((image, i) => `
            <span class="slider__control-buttons${i===0?'--selected':''}"></span>
        `).join('')}
      </div>    
    `.trim();
  },

  initialize(slider){
    const controller = slider.container.querySelector('.slider__control');
    
    if(controller){
      const buttons = controller.querySelectorAll('.slider__control-buttons, .slider__control-buttons--selected');
      controller.addEventListener('mouseover', evt => {
        const idx = Array.from(buttons).indexOf(evt.target);
        if(idx >= 0){
          slider.slideTo(idx);
          slider.stop();
        }
      });

      controller.addEventListener('mouseout', evt => {
        slider.start();
      });

      slider.container.addEventListener('slide', evt => {
        const idx = evt.detail.index
        const selected = controller.querySelector('.slider__control-buttons--selected');
        if(selected) selected.className = 'slider__control-buttons';
        buttons[idx].className = 'slider__control-buttons--selected';
      });
    }    
  }
};

const pluginPrevious = {
  render(){
    return `<a class="slider__previous"></a>`;
  },

  initialize(slider){
    const previous = slider.container.querySelector('.slider__previous');
    if(previous){
      previous.addEventListener('click', evt => {
        slider.stop();
        slider.slidePrevious();
        slider.start();
        evt.preventDefault();
      });
    }  
  }
};

const pluginNext = {
  render(){
    return `<a class="slider__next"></a>`;
  },

  initialize(slider){
    const previous = slider.container.querySelector('.slider__next');
    if(previous){
      previous.addEventListener('click', evt => {
        slider.stop();
        slider.slideNext();
        slider.start();
        evt.preventDefault();
      });
    }  
  }
};
```

å¦‚ä¸Šä»£ç æ‰€ç¤ºï¼šæ¯ä¸ªæ’ä»¶éƒ½è¢«æ„é€ æˆä¸€ä¸ªå¯¹è±¡ã€‚æ¯ä¸ªå¯¹è±¡ä¸­éƒ½æœ‰ä¸€ä¸ª`render`æ–¹æ³•ï¼Œè´Ÿè´£æ¸²æŸ“å„è‡ªçš„HTMLã€‚`initialize`æ–¹æ³•åˆ™æ˜¯è´Ÿè´£æ³¨å†Œå„è‡ªçš„ç”¨æˆ·äº‹ä»¶ã€‚

ä¸ºäº†å°†æ¯ä¸ªæ’ä»¶æ·»åŠ åˆ°Sliderç»„ä»¶ä¸­ï¼Œæˆ‘ä»¬éœ€è¦ä¿®æ”¹Sliderçš„`Slider.registerPlugins()`æ–¹æ³•ï¼š

```js
registerPlugins(...plugins) {
  plugins.forEach((plugin) => {
    const pluginContainer = document.createElement('div');
    pluginContainer.className = 'slider__plugin';
    pluginContainer.innerHTML = plugin.render(this.data);
    this.container.appendChild(pluginContainer);
    plugin.initialize(this);
  });
}
```
 
å¦‚ä¸Šä»£ç æ‰€ç¤ºï¼šSliderç»„ä»¶ä¸ºæ¯ä¸ªpluginåˆ›å»ºäº†ä¸€ä¸ª`class=slider__plugin`çš„å®¹å™¨ï¼Œç„¶åå°†æ’ä»¶çš„HTMLå…ƒç´ æ·»åŠ åˆ°è¿™ä¸ªå®¹å™¨ä¸­ï¼Œå†æŠŠè¿™ä¸ªå®¹å™¨æ·»åŠ åˆ°Sliderç»„ä»¶ä¸­å»ï¼Œæœ€åå†è°ƒç”¨æ’ä»¶çš„`initialize`æ–¹æ³•ï¼Œä»¥ä¾¿ä¸ºæ¯ä¸ªæ’ä»¶æ·»åŠ å„è‡ªçš„ç”¨æˆ·æ§åˆ¶ã€‚

è¿™æ¬¡é‡æ„çš„å®Œæ•´ä»£ç å¦‚ä¸‹ï¼š

[åœ¨çº¿æ¼”ç¤º](https://junyux.github.io/FE-Advance/day06/index3.html)

```js
class Slider {
  constructor({container, images = [], cycle = 3000} = {}) {
    this.container = container;
    this.data = images;
    this.container.innerHTML = this.render(this.data);
    this.items = Array.from(this.container.querySelectorAll('.slider__item, .slider__item--selected'));
    this.cycle = cycle;
    this.slideTo(0);
  }

  render(images) {
    const content = images.map(image => `
      <li class="slider__item">
        <img src="${image}"/>
      </li>    
    `.trim());

    return `<ul>${content.join('')}</ul>`;
  }

  registerPlugins(...plugins) {
    plugins.forEach((plugin) => {
      const pluginContainer = document.createElement('div');
      pluginContainer.className = 'slider__plugin';
      pluginContainer.innerHTML = plugin.render(this.data);
      this.container.appendChild(pluginContainer);
      plugin.initialize(this);
    });
  }

  /*
    é€šè¿‡é€‰æ‹©å™¨`.slider__item--selected`è·å¾—è¢«é€‰ä¸­çš„å…ƒç´ 
  */
  getSelectedItem() {
    const selected = this.container.querySelector('.slider__item--selected');
    return selected;
  }

  /*
    è¿”å›é€‰ä¸­çš„å…ƒç´ åœ¨itemsæ•°ç»„ä¸­çš„ä½ç½®ã€‚
  */
  getSelectedItemIndex() {
    return this.items.indexOf(this.getSelectedItem());
  }

  slideTo(idx) {
    const selected = this.getSelectedItem();
    if(selected) {
      selected.className = 'slider__item';
    }
    const item = this.items[idx];
    if(item) {
      item.className = 'slider__item--selected';
    }

    const detail = {index: idx};
    const event = new CustomEvent('slide', {bubbles: true, detail});
    this.container.dispatchEvent(event);
  }

  /*
    å°†ä¸‹ä¸€å¼ å›¾ç‰‡æ ‡è®°ä¸ºé€‰ä¸­çŠ¶æ€
  */
  slideNext() {
    const currentIdx = this.getSelectedItemIndex();
    const nextIdx = (currentIdx + 1) % this.items.length;
    this.slideTo(nextIdx);
  }

  /*
    å°†ä¸Šä¸€å¼ å›¾ç‰‡æ ‡è®°ä¸ºé€‰ä¸­çŠ¶æ€
  */
  slidePrevious() {
    const currentIdx = this.getSelectedItemIndex();
    const previousIdx = (this.items.length + currentIdx - 1) % this.items.length;
    this.slideTo(previousIdx);
  }

  start() {
    this.stop();
    this._timer = setInterval(() => this.slideNext(), this.cycle);
  }

  stop() {
    clearInterval(this._timer);
  }
}

const pluginController = { // å°åœ†ç‚¹æ’ä»¶
  render(images) { // éšç€å›¾ç‰‡æ•°é‡çš„å¢åŠ ï¼Œå°åœ†ç‚¹å…ƒç´ ä¹Ÿéœ€è¦å¢åŠ 
    return `
      <div class="slider__control">
        ${images.map((image, i) => `
            <span class="slider__control-buttons${i === 0 ? '--selected' : ''}"></span>
        `).join('')}
      </div>    
    `.trim();
  },

  initialize(slider) {
    const controller = slider.container.querySelector('.slider__control');

    if(controller) {
      const buttons = controller.querySelectorAll('.slider__control-buttons, .slider__control-buttons--selected');
      controller.addEventListener('mouseover', (evt) => {
        const idx = Array.from(buttons).indexOf(evt.target);
        if(idx >= 0) {
          slider.slideTo(idx);
          slider.stop();
        }
      });

      controller.addEventListener('mouseout', (evt) => {
        slider.start();
      });

      slider.container.addEventListener('slide', (evt) => {
        const idx = evt.detail.index;
        const selected = controller.querySelector('.slider__control-buttons--selected');
        if(selected) selected.className = 'slider__control-buttons';
        buttons[idx].className = 'slider__control-buttons--selected';
      });
    }
  },
};

const pluginPrevious = {
  render() {
    return '<a class="slider__previous"></a>';
  },

  initialize(slider) {
    const previous = slider.container.querySelector('.slider__previous');
    if(previous) {
      previous.addEventListener('click', (evt) => {
        slider.stop();
        slider.slidePrevious();
        slider.start();
        evt.preventDefault();
      });
    }
  },
};

const pluginNext = {
  render() {
    return '<a class="slider__next"></a>';
  },

  initialize(slider) {
    const previous = slider.container.querySelector('.slider__next');
    if(previous) {
      previous.addEventListener('click', (evt) => {
        slider.stop();
        slider.slideNext();
        slider.start();
        evt.preventDefault();
      });
    }
  },
};

const images = ['https://p5.ssl.qhimg.com/t0119c74624763dd070.png',
  'https://p4.ssl.qhimg.com/t01adbe3351db853eb3.jpg',
  'https://p2.ssl.qhimg.com/t01645cd5ba0c3b60cb.jpg',
  'https://p4.ssl.qhimg.com/t01331ac159b58f5478.jpg'];

const container = document.querySelector('.slider');
const slider = new Slider({container, images});
slider.registerPlugins(pluginController, pluginPrevious, pluginNext);
slider.start();
```

æ¨¡æ¿åŒ–ä¹‹åï¼Œä»£ç çš„å¯æ‰©å±•æ€§å¾—åˆ°äº†è¿›ä¸€æ­¥çš„æå‡ã€‚ç°åœ¨ï¼Œå¦‚æœæˆ‘ä»¬å¢åŠ æˆ–è€…å‡å°‘è½®æ’­å›¾ç‰‡æ•°é‡ï¼Œåªéœ€è¦ä¿®æ”¹æ•°æ®ä¸­imagesæ•°ç»„çš„å…ƒç´ ä¸ªæ•°ã€‚å¦‚æœæˆ‘ä»¬éœ€è¦æˆ–è€…ä¸éœ€è¦æŸä¸ªæ’ä»¶ï¼Œæˆ‘ä»¬åªéœ€è¦ä¿®æ”¹ä¼ ç»™`registerPlugins()`æ–¹æ³•çš„å‚æ•°å³å¯ã€‚å¯ä»¥è¯´ï¼Œè¿™ä¸€ç‰ˆä»£ç çš„å¯æ‰©å±•æ€§æ˜¯è¾¾åˆ°äº†å‘å¸ƒè¦æ±‚çš„è¾ƒé«˜æ ‡å‡†çš„ã€‚

è¿™ä¸ªç‰ˆæœ¬çš„ç»„ä»¶è™½ç„¶å…·æœ‰è¾ƒé«˜çš„å¯æ‰©å±•æ€§ï¼Œä½†æ˜¯å®ƒç¼ºå°‘**å¯å¤ç”¨æ€§**ã€‚è¿™é‡Œçš„å¯å¤ç”¨æ€§æ˜¯æŒ‡ï¼Œè¿™å¥—ç»„ä»¶ï¼ˆåŒ…æ‹¬Sliderçš„æ’ä»¶ï¼‰æ²¡æœ‰ç»Ÿä¸€çš„è§„èŒƒã€‚å¦‚æœæˆ‘ä»¬çš„åŒäº‹åŒæ ·éœ€è¦è®¾ç½®ä¸€å¥—ç»„ä»¶ï¼Œå…¶ä¸­ä¹Ÿæœ‰å°åœ†ç‚¹ç»„ä»¶ï¼Œä½†æ˜¯ä»–ä½¿ç”¨çš„æ¸²æŸ“æ–¹æ³•æ˜¯`draw()`è€Œä¸æ˜¯`render()`ï¼Œç»„ä»¶äº‹ä»¶çš„æ³¨å†Œä½¿ç”¨çš„ä¹Ÿä¸æ˜¯`initialized()`æ–¹æ³•ï¼Œ é‚£ä¹ˆè¿™ä¸ªåŒäº‹å°±éœ€è¦å†é‡å¤å¼€å‘ä¸€ä¸ªå°åœ†ç‚¹ç»„ä»¶ã€‚è¿™æ ·ä»£ç çš„å¯å¤ç”¨æ€§å°±æ¯”è¾ƒå·®äº†ã€‚æ‰€ä»¥ï¼Œä¸ºäº†æé«˜ä»£ç å¯å¤ç”¨æ€§ï¼Œæˆ‘ä»¬éœ€è¦ä¸ºç»„ä»¶è®¾è®¡ä¸€å¥—è§„èŒƒã€‚å¤§å®¶åŒæ—¶éµå¾ªè¿™å¥—è§„èŒƒï¼Œå°±èƒ½è®©ä¸åŒå¼€å‘è€…è®¾è®¡çš„ç»„ä»¶è¢«ä»–äººå¤ç”¨ã€‚

é‚£ä¹ˆï¼Œå¦‚ä½•å®ç°ç»„ä»¶çš„ç»Ÿä¸€è§„èŒƒå‘¢ï¼Ÿ

## ç¬¬å››ä¸ªæ•…äº‹ï¼šè®¾è®¡ç»„ä»¶æ¡†æ¶

ä¸ºäº†æé«˜ç»„ä»¶çš„å¤ç”¨æ€§ï¼Œæˆ‘ä»¬éœ€è¦ä¸ºç»„ä»¶è®¾è®¡ä¸€ä¸ª**ç»Ÿä¸€çš„è§„èŒƒ**ã€‚å®ç°è¿™ä¸ªç»Ÿä¸€çš„è§„èŒƒï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è®¾è®¡ä¸€å¥—é€šç”¨çš„**ç»„ä»¶æœºåˆ¶**ï¼Œå¹¶ä»¥è¿™å¥—æœºåˆ¶ä¸ºåŸåˆ™æ„å»ºä¸€ä¸ªåº“ã€‚è¿™ä¸ª**é€šç”¨æœºåˆ¶**å®é™…ä¸Šæä¾›äº†ä»£ç è®¾è®¡å’ŒæŠ½è±¡çš„ä¸€å¥—é€šç”¨è§„èŒƒï¼Œè€Œéµå¾ªè¿™å¥—è§„èŒƒçš„åŸºç¡€åº“ï¼Œå®é™…ä¸Šå°±æ˜¯å®Œæ•´çš„**UIç»„ä»¶æ¡†æ¶**ã€‚

è®¾è®¡UIç»„ä»¶æ¡†æ¶æ˜¯ä¸€ä»¶æ¯”è¾ƒå¤æ‚çš„äº‹æƒ…ï¼Œå› ä¸ºè¦è€ƒè™‘è®¸å¤šç»†èŠ‚ã€‚ä½†åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å¯ä»¥ç®€è¦åœ°è®¾è®¡ä¸€ä¸ªåŸºç¡€ç®€åŒ–ç‰ˆã€‚

æˆ‘ä»¬ç»§ç»­ä¿®æ”¹ä¸Šä¸€ç‰ˆçš„è®¾è®¡ï¼Œæç‚¼å‡ºé€šç”¨çš„Componentç±»ï¼š

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0865da3352d447caaaaf96411b26a393~tplv-k3u1fbpfcp-zoom-1.image)

å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œä¸€ä¸ªç»„ä»¶ Component åŒ…å«ä»¥ä¸‹ API:

- static name - é™æ€å±æ€§ï¼Œè¡¨ç¤ºè¿™ä¸ªç»„ä»¶çš„åç§°
- contructor({container, data, parent}) - ç»„ä»¶æ„é€ å‡½æ•°
- registerSubComponents(...Comps) - ç»™å½“å‰ç»„ä»¶æ³¨å†Œå­ç»„ä»¶
- render(data) - æ¸²æŸ“HTMLæ¨¡æ¿

```js
class Component {
  static name = 'component';

  constructor({container, data, parent = null} = {}) {
    this.data = data;
    this.container = container;
    this.container.innerHTML = this.render(this.data);
  }

  registerSubComponents(...Comps) {
    const data = this.data;
    const container = this.container;
    this.children = this.children || [];
    Comps.forEach((Comp) => {
      const subContainer = document.createElement('div');
      const sub = new Comp({container: subContainer, data, parent: this});
      container.appendChild(subContainer);
      this.children.push(sub);
    });
  }

  render(data) {
    /* abstract */
    return '';
  }
}
```

ç„¶å Slider å’Œå…¶ä»–å‡ ä¸ªæ’ä»¶éƒ½ä½œä¸ºç»„ä»¶ç±»ç»§æ‰¿è‡ª Componentã€‚

Slider ç»„ä»¶ï¼š

```js
class Slider extends Component {
  static name = 'slider';

  constructor({container, images = [], cycle = 3000} = {}) {
    super({container, data: images});
    this.items = Array.from(this.container.querySelectorAll('.slider__item, .slider__item--selected'));
    this.cycle = cycle;
    this.slideTo(0);
  }

  render(images) {
    const content = images.map(image => `
      <li class="slider__item">
        <img src="${image}"/>
      </li>    
    `.trim());

    return `<ul>${content.join('')}</ul>`;
  }

  getSelectedItem() {
    const selected = this.container.querySelector('.slider__item--selected');
    return selected;
  }

  getSelectedItemIndex() {
    return this.items.indexOf(this.getSelectedItem());
  }

  slideTo(idx) {
    const selected = this.getSelectedItem();
    if(selected) {
      selected.className = 'slider__item';
    }
    const item = this.items[idx];
    if(item) {
      item.className = 'slider__item--selected';
    }

    const detail = {index: idx};
    const event = new CustomEvent('slide', {bubbles: true, detail});
    this.container.dispatchEvent(event);
  }

  slideNext() {
    const currentIdx = this.getSelectedItemIndex();
    const nextIdx = (currentIdx + 1) % this.items.length;
    this.slideTo(nextIdx);
  }

  slidePrevious() {
    const currentIdx = this.getSelectedItemIndex();
    const previousIdx = (this.items.length + currentIdx - 1) % this.items.length;
    this.slideTo(previousIdx);
  }

  start() {
    this.stop();
    this._timer = setInterval(() => this.slideNext(), this.cycle);
  }

  stop() {
    clearInterval(this._timer);
  }
}
```

SliderController ç»„ä»¶ï¼š

```js
class SliderController extends Component {
  static name = 'slider__control';

  constructor({container, data, parent: slider}) {
    super({container, data});

    const buttons = container.querySelectorAll('.slider__control-buttons, .slider__control-buttons--selected');
    container.addEventListener('mouseover', (evt) => {
      const idx = Array.from(buttons).indexOf(evt.target);
      if(idx >= 0) {
        slider.slideTo(idx);
        slider.stop();
      }
    });

    container.addEventListener('mouseout', (evt) => {
      slider.start();
    });

    slider.container.addEventListener('slide', (evt) => {
      const idx = evt.detail.index;
      const selected = container.querySelector('.slider__control-buttons--selected');
      if(selected) selected.className = 'slider__control-buttons';
      buttons[idx].className = 'slider__control-buttons--selected';
    });
  }

  render(images) {
    return `
      <div class="slider__control">
        ${images.map((image, i) => `
            <span class="slider__control-buttons${i === 0 ? '--selected' : ''}"></span>
        `).join('')}
      </div>    
    `.trim();
  }
}
```

SliderPrevious å’Œ SliderNext ç»„ä»¶ï¼š

```js
class SliderPrevious extends Component {
  constructor({container, parent: slider}) {
    super({container});
    const previous = container.querySelector('.slider__previous');
    previous.addEventListener('click', (evt) => {
      slider.stop();
      slider.slidePrevious();
      slider.start();
      evt.preventDefault();
    });
  }

  render() {
    return '<a class="slider__previous"></a>';
  }
}

class SliderNext extends Component {
  constructor({container, parent: slider}) {
    super({container});
    const previous = container.querySelector('.slider__next');
    previous.addEventListener('click', (evt) => {
      slider.stop();
      slider.slidePrevious();
      slider.start();
      evt.preventDefault();
    });
  }

  render() {
    return '<a class="slider__next"></a>';
  }
}
```

è¿™æ ·ï¼Œæˆ‘ä»¬å°±ä»¥ç»„ä»¶åŒ–çš„æ–¹å¼å®ç°äº†è¿™ä¸ªç‰ˆæœ¬çš„è½®æ’­å›¾ï¼Œå®Œæ•´çš„JSä»£ç å¦‚ä¸‹ï¼š

[åœ¨çº¿æ¼”ç¤º](https://junyux.github.io/FE-Advance/day06/index4.html)

```js
class Component {
  static name = 'component';

  constructor({container, data, parent = null} = {}) {
    this.data = data;
    this.container = container;
    this.container.innerHTML = this.render(this.data);
  }

  registerSubComponents(...Comps) {
    const data = this.data;
    const container = this.container;
    this.children = this.children || [];
    Comps.forEach((Comp) => {
      const subContainer = document.createElement('div');
      const sub = new Comp({container: subContainer, data, parent: this});
      container.appendChild(subContainer);
      this.children.push(sub);
    });
  }

  render(data) {
    /* abstract */
    return '';
  }
}

class Slider extends Component {
  static name = 'slider';

  constructor({container, images = [], cycle = 3000} = {}) {
    super({container, data: images});
    this.items = Array.from(this.container.querySelectorAll('.slider__item, .slider__item--selected'));
    this.cycle = cycle;
    this.slideTo(0);
  }

  render(images) {
    const content = images.map(image => `
      <li class="slider__item">
        <img src="${image}"/>
      </li>    
    `.trim());

    return `<ul>${content.join('')}</ul>`;
  }

  getSelectedItem() {
    const selected = this.container.querySelector('.slider__item--selected');
    return selected;
  }

  getSelectedItemIndex() {
    return this.items.indexOf(this.getSelectedItem());
  }

  slideTo(idx) {
    const selected = this.getSelectedItem();
    if(selected) {
      selected.className = 'slider__item';
    }
    const item = this.items[idx];
    if(item) {
      item.className = 'slider__item--selected';
    }

    const detail = {index: idx};
    const event = new CustomEvent('slide', {bubbles: true, detail});
    this.container.dispatchEvent(event);
  }

  slideNext() {
    const currentIdx = this.getSelectedItemIndex();
    const nextIdx = (currentIdx + 1) % this.items.length;
    this.slideTo(nextIdx);
  }

  slidePrevious() {
    const currentIdx = this.getSelectedItemIndex();
    const previousIdx = (this.items.length + currentIdx - 1) % this.items.length;
    this.slideTo(previousIdx);
  }

  start() {
    this.stop();
    this._timer = setInterval(() => this.slideNext(), this.cycle);
  }

  stop() {
    clearInterval(this._timer);
  }
}

class SliderController extends Component {
  static name = 'slider__control';

  constructor({container, data, parent: slider}) {
    super({container, data});

    const buttons = container.querySelectorAll('.slider__control-buttons, .slider__control-buttons--selected');
    container.addEventListener('mouseover', (evt) => {
      const idx = Array.from(buttons).indexOf(evt.target);
      if(idx >= 0) {
        slider.slideTo(idx);
        slider.stop();
      }
    });

    container.addEventListener('mouseout', (evt) => {
      slider.start();
    });

    slider.container.addEventListener('slide', (evt) => {
      const idx = evt.detail.index;
      const selected = container.querySelector('.slider__control-buttons--selected');
      if(selected) selected.className = 'slider__control-buttons';
      buttons[idx].className = 'slider__control-buttons--selected';
    });
  }

  render(images) {
    return `
      <div class="slider__control">
        ${images.map((image, i) => `
            <span class="slider__control-buttons${i === 0 ? '--selected' : ''}"></span>
        `).join('')}
      </div>    
    `.trim();
  }
}

class SliderPrevious extends Component {
  constructor({container, parent: slider}) {
    super({container});
    const previous = container.querySelector('.slider__previous');
    previous.addEventListener('click', (evt) => {
      slider.stop();
      slider.slidePrevious();
      slider.start();
      evt.preventDefault();
    });
  }

  render() {
    return '<a class="slider__previous"></a>';
  }
}

class SliderNext extends Component {
  constructor({container, parent: slider}) {
    super({container});
    const previous = container.querySelector('.slider__next');
    previous.addEventListener('click', (evt) => {
      slider.stop();
      slider.slideNext();
      slider.start();
      evt.preventDefault();
    });
  }

  render() {
    return '<a class="slider__next"></a>';
  }
}

const images = ['https://p5.ssl.qhimg.com/t0119c74624763dd070.png',
  'https://p4.ssl.qhimg.com/t01adbe3351db853eb3.jpg',
  'https://p2.ssl.qhimg.com/t01645cd5ba0c3b60cb.jpg',
  'https://p4.ssl.qhimg.com/t01331ac159b58f5478.jpg'];

const container = document.querySelector('.slider');
const slider = new Slider({container, images});
slider.registerSubComponents(SliderController, SliderPrevious, SliderNext);
slider.start();
```

äºæ˜¯æˆ‘ä»¬å°±å¾—åˆ°äº†ä¸€ä¸ªè™½ç„¶ç®€å•ï¼Œå´è‡ªæˆä½“ç³»çš„â€œç»„ä»¶æ¡†æ¶â€ï¼Œè¿™å·²ç»ä¸ä»…ä»…æ˜¯è€ƒè™‘Sliderè¿™ä¸€ä¸ªç»„ä»¶çš„é—®é¢˜ï¼Œä¾æ®è¿™ä¸€å¥—åŸåˆ™ï¼Œæˆ‘ä»¬çš„æ¡†æ¶å¯ä»¥é€æ­¥æ·»åŠ å’Œå®ç°å…¶ä»–çš„UIç»„ä»¶ï¼Œå¹¶ä¸”å¯ä»¥è®©è¿™äº›ç»„ä»¶è¢«å…¶ä»–ç»„ä»¶å¤ç”¨ã€‚

è¿™æ ·å¤ç”¨æ€§çš„é—®é¢˜å°±å¾—åˆ°äº†è§£å†³ã€‚å½“ç„¶ï¼Œè¿™ä¸ªå°å°çš„ç»„ä»¶æ¡†æ¶è¿˜æœ‰è®¸å¤šç»†èŠ‚é—®é¢˜æœªè€ƒè™‘ã€‚

æ¯”å¦‚ï¼š

1. æˆ‘ä»¬æŠ½è±¡äº†HTMLå’ŒJSï¼Œå´æ²¡æœ‰æŠŠCSSåŒ…å«è¿›æ¥ã€‚
1. `registerSubComponents`æ–¹æ³•ä¼ å…¥çš„æ˜¯å­ç»„ä»¶ç±»ï¼Œå¦‚æœæˆ‘ä»¬è¦åˆ›å»ºå­ç»„ä»¶å¤šä¸ªå®ä¾‹ï¼Œè¿˜éœ€è¦ç»§ç»­å®Œå–„è¿™å¥—æœºåˆ¶æ‰èƒ½åšåˆ°ã€‚
1. æˆ‘ä»¬å¯ä»¥åœ¨å­ç»„ä»¶ä¸­æ‹¿åˆ°parentå¯¹è±¡ï¼Œç„¶åé€šè¿‡parent.containeréšæ„æ“ä½œçˆ¶ç»„ä»¶çš„HTMLç»“æ„ï¼Œè¿™å¯¼è‡´ä¸å®‰å…¨å’Œå¯èƒ½çš„å†²çªï¼Œä¹Ÿéœ€è¦å¼•å…¥é€‚å½“çš„æœºåˆ¶æ¥å¤„ç†è¿™ä¸€é—®é¢˜ã€‚

ä¸Šè¿°è¿™äº›é—®é¢˜å’Œå…¶ä»–ä¸€äº›é—®é¢˜æœ‰å¾…ç»§ç»­å®Œå–„ï¼Œåœ¨ä¸€èˆ¬è¾ƒæˆç†Ÿçš„UIæ¡†æ¶ä¸­ï¼Œè¿™äº›é—®é¢˜éƒ½æœ‰å¯¹åº”çš„è§£å†³æ–¹æ³•ï¼Œä¸è¿‡è¿™è¶…å‡ºäº†æˆ‘ä»¬è¯¾ç¨‹çš„èŒƒç•´ï¼Œæˆ‘ä»¬æŠŠè¿™äº›é—®é¢˜ç•™å¾…å…¶ä»–çš„è¯¾ç¨‹ã€‚