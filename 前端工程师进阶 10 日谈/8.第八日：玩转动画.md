# ç¬¬ä¸ƒå¤©

## ç¬¬ä¸€ä¸ªæ•…äº‹ï¼šåŒ€é€Ÿåœ†å‘¨è¿åŠ¨

åŠ¨ç”»æ˜¯ç½‘é¡µä¸­å¸¸è§çš„æ•ˆæœå…ƒç´ ã€‚æˆ‘ä»¬åœ¨å‰é¢çš„æ•…äº‹ä¸­ï¼Œä¹Ÿå·²ç»è§è¿‡äº†ä¸€äº›åŠ¨ç”»ï¼Œæ¯”å¦‚â€œè®©CSSåšæ›´å¤šçš„äº‹æƒ…â€è¿™ä¸€æ•…äº‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†CSSå…³é”®å¸§åŠ¨ç”»ã€‚

ç°ä»£æµè§ˆå™¨æ”¯æŒå¾ˆå¤šç§åŠ¨ç”»æ–¹å¼ï¼Œæ¯”å¦‚ï¼šCSSè¿‡æ¸¡åŠ¨ç”»ã€CSSå…³é”®å¸§åŠ¨ç”»ã€SVGåŠ¨ç”»ã€Web Animation APIï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ç”¨JSè‡ªå·±å®ç°åŠ¨ç”»ã€‚å¦å¤–è¿˜æœ‰è®¸å¤šä½¿ç”¨æ–¹ä¾¿å’ŒåŠŸèƒ½å¼ºå¤§çš„ç¬¬ä¸‰æ–¹åŠ¨ç”»åº“å¯ä»¥ä¾›æˆ‘ä»¬ä½¿ç”¨ã€‚

ä»Šå¤©çš„æ•…äº‹ï¼Œæˆ‘ä»¬å°†è®²è¿°ä¸¤ç§æœ€å¸¸ç”¨çš„åŠ¨ç”»æ¨¡å¼ï¼š
- å›ºå®šè½¨è¿¹çš„åŠ¨ç”»
- è¿ç»­çš„åŠ¨ç”»

### åœ†å‘¨è¿åŠ¨

ç¬¬ä¸€ä¸ªæ•…äº‹ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹çœ‹å›ºå®šè½¨è¿¹åŠ¨ç”»çš„å®ç°æ€è·¯ã€‚è¿™ä¸ªåŠ¨ç”»æ•ˆæœæ˜¯æ¨¡æ‹Ÿåœ°çƒå›´ç»•å¤ªé˜³åšåœ†å‘¨è¿åŠ¨ï¼š

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8901677a7d054b6093975ed21a08d602~tplv-k3u1fbpfcp-zoom-1.image)

å®ç°ä¸Šå›¾çš„åŠ¨ç”»çš„æ–¹å¼æœ‰å¾ˆå¤šï¼Œæ¯”è¾ƒç›´æ¥çš„æ˜¯é‡‡ç”¨JSæ¥å®ç°ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹JSå®ç°çš„æ–¹æ¡ˆã€‚

é¦–å…ˆï¼Œæˆ‘ä»¬ç”¨HTMLå…ƒç´ å±•ç¤ºåŠ¨ç”»å…ƒç´ ï¼š

```html
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Document</title>
</head>
<body>
  <div class="main">
    <div id="sun">ğŸŒ</div>
    <div id="earth">ğŸŒ</div>
  </div>
</body>
</html>
```
å¦‚ä¸Šä»£ç æ‰€ç¤ºï¼Œæˆ‘ä»¬ç”¨ä¸¤ä¸ª`div`å…ƒç´ åˆ†åˆ«ä»£è¡¨å¤ªé˜³å’Œåœ°çƒä¸¤ä¸ªå¯¹è±¡ã€‚

è¿™æ˜¯å¯¹åº”çš„CSSï¼Œè®¾ç½®äº†å¤ªé˜³å’Œåœ°çƒçš„åˆå§‹ä½ç½®å’ŒçŠ¶æ€ï¼š

```css
.main {
  width: 512px;
  height: 512px;
  position: relative;
}
#sun, #earth {
  position: absolute;
  transform: translate(-50%, -50%);
}
#sun {
  font-size: 5rem;
  left: 50%;
  top: 50%;
}
#earth {
  font-size: 2rem;
}
```

åœ¨æ²¡æœ‰æ·»åŠ åŠ¨ç”»çš„æ—¶å€™ï¼Œæ˜¾ç¤ºå‡ºæ¥çš„ç•Œé¢æ˜¯è¿™æ ·çš„ï¼š

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5e83ff0ce08c4a5c9bd85ef8a9e823d6~tplv-k3u1fbpfcp-zoom-1.image)

å¤ªé˜³ä½äº`div.main`å…ƒç´ æ­£ä¸­é—´ï¼Œå› ä¸ºæˆ‘ä»¬ç”¨äº†ä¸€ä¸ªç»å…¸çš„ç»å¯¹å®šä½å®ç°æ°´å¹³å‚ç›´å±…ä¸­çš„æ–¹æ³•ï¼š

```css
#sun, #earth {
  position: absolute;
  transform: translate(-50%, -50%);
}
#sun {
  font-size: 5rem;
  left: 50%;
  top: 50%;
}
```

æˆ‘ä»¬å°†`#sun`å…ƒç´ çš„`position`è®¾ä¸º`absolute`ï¼Œ`top`å’Œ`left`è®¾ä¸º50%ï¼Œæ­¤æ—¶å®ƒçš„å·¦ä¸Šè§’æ˜¯ä½äº`div.main`å…ƒç´ çš„ä¸­å¿ƒç‚¹çš„ã€‚ç„¶åæˆ‘ä»¬å†é€šè¿‡`transform: translate(-50%, -50%)`å°†å®ƒå·¦ç§»ã€ä¸Šç§»è‡ªèº«å®½é«˜çš„ä¸€åŠï¼Œè¿™æ ·å®ƒçš„ä¸­å¿ƒç‚¹å°±ä½äº`div.main`å…ƒç´ çš„ä¸­å¿ƒäº†ã€‚

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¦å®ç°çš„æ•ˆæœæ˜¯è®©åœ°çƒçš„è½¨è¿¹æ²¿ç€å›´ç»•ç€å¤ªé˜³çš„ç¯å½¢è¿åŠ¨ï¼Œé‚£ä¹ˆè¿™ä¸ªæ€ä¹ˆå®ç°å‘¢ï¼Ÿ

è¿™é‡Œæˆ‘ä»¬å¤ä¹ ä¸€ä¸‹é«˜ä¸­æ•°å­¦çŸ¥è¯†ï¼š

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/aa60879db6764cf48530d9fd2ef40d82~tplv-k3u1fbpfcp-zoom-1.image)

å¦‚å›¾æ‰€ç¤ºï¼Œåœ¨ç›´è§’åæ ‡ç³»ä¸­ï¼Œç‚¹på›´ç»•åŠå¾„rï¼Œåœ†å¿ƒåœ¨åŸç‚¹çš„åœ†å‘¨è¿åŠ¨ï¼Œå®ƒä»»æ„æ—¶åˆ»çš„åæ ‡`px`ï¼Œ`py`æ»¡è¶³ï¼š

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/35ebeda89831457fbf5d253465f884f7~tplv-k3u1fbpfcp-zoom-1.image)

âºæ˜¯åŸç‚¹åˆ°pç‚¹çš„çº¿æ®µä¸xè½´çš„å¤¹è§’ã€‚

è¿™æ˜¯**åœ†çš„å‚æ•°æ–¹ç¨‹**ã€‚

æ‰€ä»¥ï¼Œæˆ‘ä»¬è¦åšçš„å°±æ˜¯æŒ‰ç…§å‚æ•°æ–¹ç¨‹æ›´æ–°åœ°çƒçš„ä½ç½®å°±å¯ä»¥äº†ã€‚

å¦‚æœæˆ‘ä»¬çš„åŠ¨ç”»è®©åœ°çƒå›´ç»•å¤ªé˜³æ—‹è½¬ä¸€å‘¨çš„å‘¨æœŸæ˜¯Tï¼Œé‚£ä¹ˆï¼Œåœ°çƒçš„è§’é€Ÿåº¦`âµ = 2 * Math.PI / T`ï¼Œæ‰€ä»¥ï¼Œâºè§’æ˜¯ï¼š

```js
âº = âµt = 2 * Math.PI * t / T
```

æ‰€ä»¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡JSæ›´æ–°åœ°çƒå…ƒç´ çš„`left`å’Œ`top`å±æ€§ï¼Œè®©åœ°çƒè¿åŠ¨èµ·æ¥ï¼š

[åœ¨çº¿æ¼”ç¤º](https://junyux.github.io/FE-Advance/day08/index1-v1.html)

```js
const earth = document.getElementById('earth');
const x0 = 256;
const y0 = 256;
const radius = 128;
const T = 5000; // å‘¨æœŸ

function update(t) {
  const alpha = 2 * Math.PI * t / T;
  const x = x0 + radius * Math.cos(alpha);
  const y = y0 + radius * Math.sin(alpha);
  earth.style.left = `${x}px`;
  earth.style.top = `${y}px`;
  requestAnimationFrame(update);
}
update(0);
```

ä¸Šé¢çš„ä»£ç é‡Œï¼Œx0ã€y0æ˜¯åœ†å¿ƒï¼Œå› ä¸ºå¤ªé˜³ä¸åœ¨åæ ‡åŸç‚¹ï¼Œæ‰€ä»¥æœ€ç»ˆçš„å…¬å¼æ˜¯ï¼š

```js
const x = x0 + radius * Math.cos(alpha);
const y = y0 + radius * Math.sin(alpha);
```

ç„¶åæˆ‘ä»¬é€šè¿‡`requestAnimationFrame`ï¼Œè®¡ç®—xå’Œyï¼Œä¸æ–­æ›´æ–°`#earth`å…ƒç´ çš„`topã€left`å€¼ï¼š

```js
earth.style.left = `${x}px`;
earth.style.top = `${y}px`;
```

`requestAnimationFrame`æ˜¯æµè§ˆå™¨çš„APIï¼Œå®ƒçš„å‚æ•°æ˜¯ä¸€ä¸ªå›è°ƒå‡½æ•°ã€‚è¿™ä¸ªAPIå‘Šè¯‰æµè§ˆå™¨æœ‰ä¸€ä¸ªåŠ¨ç”»éœ€è¦æ‰§è¡Œæ‰§è¡Œï¼Œå¹¶ä¸”ä¼šåœ¨æµè§ˆå™¨ä¸‹æ¬¡é‡ç»˜ä¹‹å‰è°ƒç”¨æŒ‡å®šçš„å›è°ƒå‡½æ•°æ›´æ–°åŠ¨ç”»ã€‚

ç°åœ¨æˆ‘ä»¬æ¥æ€»ç»“ä¸€ä¸‹è¿™ç§åŠ¨ç”»å®ç°çš„æ€è·¯ï¼š

1. è®¾è®¡è½¨è¿¹æ–¹ç¨‹ï¼Œæ‰¾å‡ºåŠ¨ç”»å˜é‡å’Œæ—¶é—´çš„å…³ç³»
1. ç¡®å®šåŠ¨ç”»å‘¨æœŸå’Œä¸åŠ¨ç”»å˜é‡å¯¹åº”çš„CSSå±æ€§
1. é€šè¿‡`requestAnimationFrame`APIï¼Œåœ¨æµè§ˆå™¨é‡ç»˜å‘¨æœŸä¸­æ›´æ–°åŠ¨ç”»å˜é‡ï¼Œä»¥å®ç°æˆ‘ä»¬éœ€è¦çš„åŠ¨ç”»æ•ˆæœ

ä½¿ç”¨JSæ˜¯å®ç°å›ºå®šè½¨è¿¹åŠ¨ç”»çš„ä¸€ç§æ–¹æ³•ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨CSSåŠ¨ç”»æ¥æ˜¯å®ç°è¿™ç§ç±»å‹çš„åŠ¨ç”»ã€‚è¿™ä¸ªæ•…äº‹çš„å®ä¾‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨åˆ°äº†åœ†çš„å‚æ•°æ–¹ç¨‹ï¼Œè€ŒCSSåŠ¨ç”»ä¸å¤ªå¥½å®ç°æ­£ä½™å¼¦è®¡ç®—ã€‚æ‰€ä»¥ï¼Œä¸ºäº†ä½¿ç”¨CSSå®ç°åŠ¨ç”»ï¼Œæˆ‘ä»¬éœ€è¦è°ƒæ•´æˆ‘ä»¬çš„åŠ¨ç”»è®¡ç®—æ–¹å¼ï¼Œé‚£ä¹ˆè¦å¦‚ä½•è°ƒæ•´å‘¢ï¼Ÿ

<!-- è¿™ä¸ªç‰ˆæœ¬é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨äº†JavaScriptæ ¹æ®åœ†çš„å‚æ•°æ–¹ç¨‹æ¥ä¿®æ”¹`#earth`çš„CSSå±æ€§çš„æ–¹å¼æ¥å®ç°åœ°çƒç»•å¤ªé˜³æ—‹è½¬çš„æ•ˆæœã€‚è¿™ä¸ªç‰ˆæœ¬çš„è®¡ç®—å¹¶ä¸å¤æ‚ï¼Œåªè¦ç†è§£äº†åœ†çš„å‚æ•°æ–¹ç¨‹å°±å¾ˆå®¹æ˜“å†™å‡ºæ¥ã€‚ -->
<!-- ä¸è¿‡é™¤äº†ä½¿ç”¨åœ†çš„å‚æ•°æ–¹ç¨‹å¤–ï¼Œè¿˜æœ‰æ²¡æœ‰å…¶ä»–è§£å†³æ–¹æ³•å‘¢ï¼Ÿå°¤å…¶æ˜¯èƒ½å¦ä¸ç”¨JSï¼Œåªç”¨CSSå®ç°ï¼Ÿ -->

## ç¬¬äºŒä¸ªæ•…äº‹ï¼šåŒ€é€Ÿåœ†å‘¨è¿åŠ¨ 2.0

ä½¿ç”¨CSSåŠ¨ç”»å®ç°åœ†å‘¨è¿åŠ¨ï¼Œæˆ‘ä»¬ä¸èƒ½ä½¿ç”¨åœ†çš„å‚æ•°æ–¹ç¨‹ï¼Œè€Œéœ€è¦ä½¿ç”¨åœ†çš„æåæ ‡æ–¹ç¨‹æ¥å®ç°ã€‚ç„¶åå†é€šè¿‡CSSçš„transformå’Œrotateï¼Œå°±èƒ½æ¯”è¾ƒç®€å•çš„å®ç°åœ†å‘¨è¿åŠ¨äº†ã€‚

<!-- sä½†æ˜¯ï¼Œæˆ‘ä»¬ä¸è¦å¿˜è®°äº†ï¼Œåœ†é™¤äº†å‚æ•°æ–¹ç¨‹ä¹‹å¤–ï¼Œè¿˜æœ‰æåæ ‡æ–¹ç¨‹ï¼Œè€Œæ°å¥½ï¼ŒCSSçš„transformæ˜¯æ”¯æŒrotateçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å½“ç„¶å¯ä»¥æœ‰æ¯”è¾ƒç®€å•çš„ç”¨CSSåŠ¨ç”»å®ç°åœ†å‘¨è¿åŠ¨çš„åŠæ³•ã€‚ -->
é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦è°ƒæ•´ä¸€ä¸‹æˆ‘ä»¬çš„CSSæ ·å¼ï¼Œè®¾ç½®`transform-origin`å±æ€§æ”¹å˜å…ƒç´ æ—‹è½¬çš„å‚è€ƒç‚¹ï¼š

```css
.main {
  width: 512px;
  height: 512px;
  position: relative;
}
#sun, #earth {
  position: absolute;
}
#sun {
  transform: translate(-50%, -50%);
  font-size: 5rem;
  left: 50%;
  top: 50%;
}
#earth {
  left: 50%;
  top: calc(50% - 128px);
  transform-origin: 50% calc(50% + 128px);
  font-size: 2rem;
}
```
å¦‚ä¸Šä»£ç æ‰€ç¤ºï¼Œæˆ‘ä»¬è°ƒæ•´äº†åœ°çƒå…ƒç´ çš„åˆå§‹ä½ç½®å’Œæ—‹è½¬å‚è€ƒç‚¹ï¼Œä½¿ç”¨äº†ä¸¤ä¸ªè®¡ç®—å±æ€§å€¼: `top: calc(50% - 128px)` å’Œ `transform-origin: 50% calc(50% + 128px);`ã€‚

ğŸ‘‰ğŸ» CSSä¸­ï¼Œ`calc`å¯ä»¥ç”¨æ¥åœ¨CSSå±æ€§å€¼ä¸­æ‰§è¡Œä¸€äº›è®¡ç®—ï¼Œç‰¹åˆ«æœ‰ç”¨çš„æ˜¯ï¼Œ`calc`è®¡ç®—å¯ä»¥è‡ªåŠ¨è½¬æ¢å•ä½ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°†ç™¾åˆ†æ¯”å•ä½çš„æ•°å€¼å’Œpxå•ä½çš„å€¼è¿›è¡ŒåŠ å‡è®¡ç®—ã€‚

`top: calc(50% - 128px)`è¡¨ç¤ºå°†`#earth`å…ƒç´ çš„`top`å€¼è®¾åœ¨çˆ¶å®¹å™¨50%é«˜åº¦ï¼Œå¹¶å‘ä¸Šåç§»128pxçš„ä½ç½®ã€‚äºæ˜¯åœ°çƒå‡ºç°åœ¨å¤ªé˜³çš„æ­£ä¸Šæ–¹ï¼Œè·ç¦»å¤ªé˜³ä¸­å¿ƒç‚¹çš„è·ç¦»æ˜¯128pxã€‚

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/bfe07f24a29c4f5b804659f4ad34baf6~tplv-k3u1fbpfcp-zoom-1.image)

é»˜è®¤æƒ…å†µä¸‹ï¼Œ`transform`å±æ€§æ˜¯ä»¥å…ƒç´ è‡ªèº«ç›’å­çš„å·¦ä¸Šè§’ä½œä¸ºå‚è€ƒç‚¹çš„ã€‚è€Œåœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬éœ€è¦è®©åœ°çƒå…ƒç´ ä»¥å¤ªé˜³çš„ä¸­å¿ƒç‚¹ä½œä¸ºæ—‹è½¬çš„å‚è€ƒç‚¹ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦ä½¿ç”¨`transform-origin`å±æ€§æ”¹å˜åœ°çƒå…ƒç´ çš„å‚ç‚¹ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/bd65132a95234f93b9fb65ba14b0855d~tplv-k3u1fbpfcp-zoom-1.image)

<!-- å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬å°†`transform-origin`è®¾ä¸ºå¤ªé˜³çš„ä¸­å¿ƒç‚¹ï¼Œè¦ä½¿ç”¨çš„`transform-origin`å±æ€§å€¼ä¸º`50% calc(50% + 128px)`ã€‚ -->
ä»ä¸Šå›¾æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œä»¥å¤ªé˜³ä¸­å¿ƒä½œä¸ºæ—‹è½¬çš„å‚è€ƒç‚¹çš„ä½ç½®ä½äº`50% calc(50% + 128px)`ã€‚æ‰€ä»¥ï¼Œ`transform-origin: 50% calc(50% + 128px)`è¡¨ç¤ºå°†åœ°çƒçš„æ—‹è½¬å‚è€ƒç‚¹ä¿®æ”¹åˆ°å¤ªé˜³çš„ä¸­å¿ƒç‚¹ã€‚è¿™æ ·æ‰§è¡Œåœ°çƒçš„`transform`å±æ€§å°±èƒ½è®©åœ°çƒå›´ç€å¤ªé˜³è½¬äº†ã€‚

ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨CSSå…³é”®å¸§åŠ¨ç”»ï¼Œæ”¹å˜`tranform`çš„å€¼ï¼š

```css
@keyframes rotate {
  to {transform: translate(-50%, -50%) rotate(1turn)}
}
```

ç„¶åæˆ‘ä»¬ç»™`#earth`å…ƒç´ å¢åŠ åŠ¨ç”»ï¼š

```css
#earth {
  left: 50%;
  top: calc(50% - 128px);
  transform-origin: 50% calc(50% + 128px);
  font-size: 2rem;

  transform: translate(-50%, -50%) rotate(.0turn);
  animation: rotate 5s linear infinite;
}
```

æœ€åï¼Œå®Œæ•´çš„CSSå¦‚ä¸‹ï¼š

[åœ¨çº¿æ¼”ç¤º](https://junyux.github.io/FE-Advance/day08/index1-v2.html)

```css
.main {
  width: 512px;
  height: 512px;
  position: relative;
}
#sun, #earth {
  position: absolute;
}
#sun {
  transform: translate(-50%, -50%);
  font-size: 5rem;
  left: 50%;
  top: 50%;
}
#earth {
  left: 50%;
  top: calc(50% - 128px);
  transform-origin: 50% calc(50% + 128px);
  font-size: 2rem;

  transform: translate(-50%, -50%) rotate(.0turn);
  animation: rotate 5s linear infinite;
}

@keyframes rotate {
  to {transform: translate(-50%, -50%) rotate(1turn)}
}
```

è¿™æ ·æˆ‘ä»¬å°±å®ç°äº†çº¯CSSç‰ˆæœ¬çš„åœ°çƒç¯ç»•å¤ªé˜³æ—‹è½¬çš„åŠ¨ç”»ã€‚

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d1ce90fb58fb46b7976d7210704e7fcf~tplv-k3u1fbpfcp-zoom-1.image)

æ¯”è¾ƒä¸Šå›¾å’Œç¬¬ä¸€ä¸ªæ•…äº‹ä¸­çš„æ•ˆæœå›¾ï¼Œä½ å¯èƒ½ä¼šå‘ç°å®ƒä»¬ä¹‹é—´å­˜åœ¨ç»†å¾®çš„å·®åˆ«ã€‚ç¬¬ä¸€ç‰ˆæ˜¯é€šè¿‡å‚æ•°æ–¹ç¨‹è®¡ç®—åœ°çƒç›¸å¯¹åæ ‡ä½ç½®ï¼ŒåŠ¨æ€ä¿®æ”¹åæ ‡ä½ç½®æ¥å®ç°ï¼Œæ‰€ä»¥åœ°çƒæœ¬èº«ï¼Œé™¤äº†ä½ç½®ç›¸å¯¹å¤ªé˜³æ—‹è½¬ï¼Œå…¶ä»–çš„çŠ¶æ€éƒ½ä¿æŒä¸å˜ã€‚è€Œè¿™ä¸ªç‰ˆæœ¬æ˜¯é€šè¿‡æ—‹è½¬æ¥å®ç°çš„ï¼Œåœ°çƒçš„æ—‹è½¬å‚è€ƒç‚¹å§‹ç»ˆæ˜¯å¯¹ç€å¤ªé˜³çš„ä¸­å¿ƒç‚¹çš„ï¼Œæ‰€ä»¥çœ‹èµ·æ¥å¥½åƒåœ°çƒè‡ªèº«ä¹Ÿåœ¨æ—‹è½¬ã€‚è¿™å°±æ˜¯æ•ˆæœä¸Šçš„ç»†å¾®å·®å¼‚ã€‚
<!-- æ³¨æ„ï¼Œç»†èŠ‚ä¸Šï¼Œè¿™ä¸€ç‰ˆå’Œä¸Šä¸€ç‰ˆç•¥æœ‰ä¸åŒï¼Œå› ä¸ºä¸Šä¸€ç‰ˆæ˜¯é€šè¿‡å‚æ•°æ–¹ç¨‹è®¡ç®—åœ°çƒç›¸å¯¹åæ ‡ä½ç½®ï¼ŒåŠ¨æ€ä¿®æ”¹åæ ‡ä½ç½®æ¥å®ç°ï¼Œè€Œè¿™ä¸€ç‰ˆæ˜¯é€šè¿‡æ—‹è½¬æ¥å®ç°ï¼Œæ‰€ä»¥ä¸Šä¸€ç‰ˆçš„åœ°çƒæœ¬èº«ä¿æŒä¸å˜ï¼Œåªæ˜¯ä½ç½®ç›¸å¯¹å¤ªé˜³æ—‹è½¬ï¼Œè€Œè¿™ä¸€ç‰ˆï¼Œåœ°çƒæ•´ä½“å›´ç»•å¤ªé˜³ä¸­å¿ƒç‚¹æ—‹è½¬ï¼Œæ‰€ä»¥çœ‹èµ·æ¥å¥½åƒåœ°çƒè‡ªèº«ä¹Ÿåœ¨æ—‹è½¬ï¼Œè¿™æ˜¯æ•ˆæœä¸Šçš„ç»†å¾®å·®å¼‚ã€‚ -->

å½“ç„¶ï¼Œè¿™ä¸€ç‰ˆæˆ‘ä»¬åŒæ ·ä¹Ÿå¯ä»¥ä¸ç”¨CSSå…³é”®å¸§åŠ¨ç”»ï¼Œæ”¹ç”¨JSæ¥æ§åˆ¶ï¼Œæˆ‘ä»¬åªè¦å°†CSSåŠ¨ç”»å»æ‰ï¼Œæ·»åŠ ä»¥ä¸‹JSä»£ç ï¼š

```js
  const earth = document.getElementById('earth');
  const T = 5000; // 5ç§’

  function update(t) {
    earth.style.transform = `translate(-50%, -50%) rotate(${t / T}turn)`;
    requestAnimationFrame(update);
  }
  update(0);
```

å¦‚æœä½ è¿™ä¹ˆåšï¼Œä½ ä¼šå‘ç°åœ¨ä¸€äº›æµè§ˆå™¨ï¼ˆåŒ…æ‹¬æœ€æ–°çš„chromeæµè§ˆå™¨ï¼‰ä¸Šå‡ºç°å¥‡æ€ªçš„ç°è±¡ï¼š

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1e1fad299e1f47d8941480dcab610e2b~tplv-k3u1fbpfcp-zoom-1.image)

å¦‚å›¾æ‰€ç¤ºï¼Œä¼¼ä¹åœ°çƒåœ¨è¿åŠ¨åˆ°æŸäº›ä½ç½®çš„æ—¶å€™ä¼šçªç„¶æŠ–åŠ¨ä¸€ä¸‹ã€‚ä¸è¿‡è¿™ä¸ªä¸æ˜¯æˆ‘ä»¬ä»£ç çš„é—®é¢˜ï¼Œè€Œæ˜¯chromeæµè§ˆå™¨åœ¨å¤„ç†emojiæ–‡å­—çš„`transform`å±æ€§æ—¶äº§ç”Ÿçš„bugã€‚è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥å°†`rotate`æ¢æˆ`rotate3d`:

```js
  const earth = document.getElementById('earth');
  const T = 5000; // 5ç§’

  function update(t) {
    earth.style.transform = `translate(-50%, -50%) rotate3d(0, 0, 1, ${t / T}turn)`;
    requestAnimationFrame(update);
  }
  update(0);
```

è¿™é‡Œæˆ‘ä»¬ç”¨`rotate3d`æ¥ä»£æ›¿`rotate`ã€‚`rotate3d`æ¥å—4ä¸ªå‚æ•°ï¼Œå‰ä¸‰ä¸ªå‚æ•°å®šä¹‰ä¸€ä¸ªä¸‰ç»´å‘é‡ï¼Œç¬¬å››ä¸ªå‚æ•°è¡¨ç¤ºå›´ç»•è¯¥å‘é‡æ—‹è½¬ï¼Œæˆ‘ä»¬æ˜¯åœ¨å¹³é¢ä¸Šæ—‹è½¬ï¼Œè¦å›´ç»•zè½´ï¼Œæ‰€ä»¥å‰ä¸‰ä¸ªå‚æ•°æ˜¯`0,0,1`ã€‚

ç”¨`rotate3d`æ›¿ä»£`rotate`ä¹‹åï¼Œé—®é¢˜å°±æ¶ˆå¤±äº†ï¼Œè¿™æ ·æˆ‘ä»¬ä¾ç„¶å¯ä»¥ç”¨JSæ¥æ§åˆ¶åŠ¨ç”»ã€‚

ç¬¬ä¸€ä¸ªå’Œç¬¬äºŒä¸ªæ•…äº‹é˜è¿°äº†å›ºå®šè½¨è¿¹åŠ¨ç”»çš„å®ç°æ€è·¯ã€‚è§„å®šè½¨è¿¹åŠ¨ç”»ä¸ä»…ä»…æ˜¯åœ†å‘¨è¿åŠ¨ï¼Œå®ƒè¿˜åŒ…æ‹¬äº†æ¸å˜åŠ¨ç”»ï¼Œæ¤­åœ†ï¼Œè´å¡å°”æ›²çº¿ç­‰ç­‰ã€‚è¿™äº›åŠ¨ç”»æ—¢å¯ä»¥ä½¿ç”¨JSæ¥å®ç°ï¼Œä¹Ÿå¯ä»¥é‡‡ç”¨CSSæ¥å®ç°ã€‚å½“ç„¶ï¼Œå¦‚æœé‡‡ç”¨CSSåŠ¨ç”»å®ç°ï¼Œä½ è®¾è®¡çš„åŠ¨ç”»å˜é‡éœ€è¦è¢«CSSæ”¯æŒï¼Œå¦åˆ™æ˜¯æ— æ³•å®ç°ç”¨CSSæ¥å®ç°çš„ã€‚

ç”¨JSæˆ–CSSæ¥æ§åˆ¶åŠ¨ç”»ï¼Œå„æœ‰å„çš„å¥½å¤„ï¼ŒCSSåŠ¨ç”»æ›´ç®€å•ï¼Œèƒ½å¤Ÿä¿æŒWEBå¼€å‘å„å¸å…¶èŒçš„åŸåˆ™ï¼Œä½¿å¾—ä»£ç æ›´åŠ æ˜“äºç»´æŠ¤ã€‚è€ŒJSåŠ¨ç”»ï¼Œåœ¨ç»„åˆå¤æ‚çš„åŠ¨ç”»è¿‡ç¨‹æ—¶ï¼Œä¼šæ›´åŠ çµæ´»å’Œæ–¹ä¾¿ã€‚

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±æ¥çœ‹çœ‹æ›´åŠ å¤æ‚çš„åŠ¨ç”»åº”è¯¥å¦‚ä½•å®ç°â€”â€”è¿ç»­åŠ¨ç”»ã€‚

## ç¬¬ä¸‰ä¸ªæ•…äº‹ï¼šè‡ªç”±è½ä½“å’Œå¼¹è·³å°çƒ

åœ¨ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œç®€å•çš„åŠ¨ç”»ä½¿ç”¨CSSå®ç°ä¼šæ¯”è¾ƒæ–¹ä¾¿ï¼Œä½†æ˜¯ä¸€äº›æ¯”è¾ƒå¤æ‚çš„åŠ¨ç”»ï¼Œè¿˜æ˜¯éœ€è¦ä½¿ç”¨JSæ¥å®ç°ã€‚

æ¯”å¦‚æˆ‘ä»¬å®ç°ä¸€ä¸ªæ¨¡æ‹Ÿå°çƒè‡ªç”±è½ä½“åå¼¹è·³çš„åŠ¨ç”»æ•ˆæœï¼š

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/718582019a554b228cac6eb9918c9572~tplv-k3u1fbpfcp-zoom-1.image)

è¿™æ˜¯ç›¸å…³çš„HTMLä¸CSSï¼š

```html
<div id="sphere"></div>
<div id="ground"><div>
```

```css
#sphere {
  position: absolute;
  left: 100px;
  top: 100px;
  width: 20px;
  height: 20px;
  border-radius: 50%;
  background-color: #0af;
}

#ground {
  position: absolute;
  top: 420px;
  width: 600px;
  height: 10px;
  background: black;
}
```

è¿™æ˜¯ä¸€ä¸ªè¿ç»­çš„åŠ¨ç”»ï¼Œè¿ç»­çš„åŠ¨ç”»å®é™…æ˜¯ç”±å‡ ä¸ªä¸åŒçš„é˜¶æ®µçš„è½¨è¿¹åŠ¨ç”»ç»„åˆè€Œæˆã€‚æ¯”å¦‚ä¸Šé¢çš„ä¾‹å­ï¼Œå°±æ˜¯ç”±è‹¥å¹²ä¸ªè‡ªç”±è½ä½“åŠ¨ç”»å’ŒåŒ€å‡é€ŸåŠ¨ç”»ç»„åˆè€Œæˆã€‚åƒè¿™æ ·çš„åŠ¨ç”»ï¼Œä½¿ç”¨CSSåŠ¨ç”»å‡ ä¹æ²¡æ³•å®ç°ï¼Œè¿˜æ˜¯åº”è¯¥è€ƒè™‘ä½¿ç”¨JSåŠ¨ç”»ã€‚

ç¬¬ä¸€æ­¥ï¼Œæˆ‘ä»¬å…ˆå®ç°ä¸€ä¸ªè‡ªç”±è½åœ°åŠ¨ç”»ã€‚

æˆ‘ä»¬çŸ¥é“è‡ªç”±è½ä½“è¿åŠ¨æ˜¯ä¸€ä¸ªåˆé€Ÿåº¦ä¸º0çš„åŒ€åŠ é€Ÿè¿åŠ¨ï¼Œå‡è®¾å°çƒç¦»åœ°é¢é«˜åº¦ä¸ºSï¼Œè½åœ°çš„æ—¶é—´ä¸ºTï¼Œé‚£ä¹ˆæ ¹æ®è‡ªç”±è½ä½“è¿åŠ¨çš„å…¬å¼ï¼Œæˆ‘ä»¬å¯ä»¥è®¡ç®—å‡ºå°çƒçš„åŠ é€Ÿåº¦ä¸ºï¼š

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6d7b33bb3b5341e59a06bc29ba6940c7~tplv-k3u1fbpfcp-zoom-1.image)

é‚£ä¹ˆç»è¿‡tæ—¶é—´ï¼ˆt <= Tï¼‰ï¼Œå°çƒè¿åŠ¨çš„ä½ç§»ä¸ºï¼š

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c86af43c71144bedb41dc0e3ffecdc32~tplv-k3u1fbpfcp-zoom-1.image)

æ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·å®šä¹‰è‡ªç”±è½ä½“åŠ¨ç”»ï¼š

```js
const S = 400; // å°çƒç¦»åœ°çš„åˆå§‹é«˜åº¦
const T = 1000; // è½åœ°æ—¶é—´

const target = document.getElementById('sphere')

let startTime = Date.now();

function update() {
  const t = Date.now() - startTime;
  const p = Math.min(t / T, 1);
  const top = S * p ** 2;
  target.style.top = `${top}px`; // æ›´æ–°åŠ¨ç”»å˜é‡â€”â€”topå±æ€§
  if(p < 1) {
    requestAnimationFrame(update);
  }
}

update();
```

ä¸€ä¸ªè‡ªç”±è½ä½“çš„åŠ¨ç”»å°±å®ç°äº†ï¼š

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c5c22c8d779e4278897324ac5ffed06d~tplv-k3u1fbpfcp-zoom-1.image)

ä»¥ä¸Šæ˜¯åŠ¨ç”»çš„ç¬¬ä¸€é˜¶æ®µï¼Œç°åœ¨æˆ‘ä»¬éœ€è¦æ‰§è¡ŒåŠ¨ç”»çš„ç¬¬äºŒä¸ªé˜¶æ®µâ€”â€”å¼¹èµ·ã€‚

<!-- æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¦é¢å¯¹ä¸€ä¸ªé—®é¢˜ï¼Œé‚£å°±æ˜¯æˆ‘ä»¬è¦åœ¨ä¸€æ®µåŠ¨ç”»æ‰§è¡Œå®Œæˆä¹‹åï¼Œæ‰§è¡Œä¸‹ä¸€æ®µåŠ¨ç”»ã€‚è¿™æ˜¯ä¸€ä¸ªå¼‚æ­¥çš„è¿‡ç¨‹ã€‚ -->
å› ä¸ºå¼¹èµ·åŠ¨ç”»æ˜¯åœ¨è‡ªç”±è½ä½“åŠ¨ç”»ç»“æŸä¹‹åï¼Œæ‰€ä»¥å¼¹èµ·åŠ¨ç”»å¿…é¡»ç­‰å¾…è‡ªç”±è½ä½“åŠ¨ç”»æ‰§è¡Œç»“æŸåæ‰èƒ½å¼€å§‹æ‰§è¡Œã€‚è¿™å°±æ¶‰åŠåˆ°ä¸€ä¸ªå¼‚æ­¥çš„è¿‡ç¨‹ã€‚æˆ‘ä»¬éœ€è¦å¯¹åŠ¨ç”»è¿‡ç¨‹è¿›è¡Œä¸€ä¸‹ç®€å•çš„å°è£…ï¼Œè®©å®ƒå®ç°ä¸€ä¸ª`asyn/await`çš„è¿‡ç¨‹ã€‚

é¦–å…ˆï¼Œåˆ©ç”¨æˆ‘ä»¬ä¹‹å‰å­¦è¿‡çš„æ•°æ®æŠ½è±¡å’Œè¿‡ç¨‹æŠ½è±¡ï¼Œé‡æ„ä¸€ä¸‹ä¸Šé¢çš„ä»£ç ï¼š

```js
/*
  @target ç›®æ ‡åŠ¨ç”»å…ƒç´ 
  @duration åŠ¨ç”»ç»å†çš„æ—¶é—´
  @progress åŠ¨ç”»æ‰§è¡Œå›è°ƒå‡½æ•°
*/
function animate(target, duration, progress) {
  const startTime = Date.now();
  return new Promise((resolve) => {
    function update() {
      const t = Date.now() - startTime;
      const p = Math.min(t / duration, 1);
      progress(target, p);
      if(p < 1) {
        requestAnimationFrame(update);
      } else {
        resolve(p);
      }
    }
    update();
  });
}
```

è¿™æ ·ï¼Œè‡ªç”±è½ä½“çš„åŠ¨ç”»å°±å¯ä»¥å˜æˆï¼š

```js
const sphere = document.getElementById('sphere');

animate(sphere, 1000, (target, p) => {
  const top = 400 * p ** 2;
  target.style.top = `${top}px`;
});
```

æ³¨æ„ï¼Œæˆ‘ä»¬åœ¨`animate`æ–¹æ³•é‡Œè¿”å›äº†ä¸€ä¸ª`Promise`å¯¹è±¡ï¼Œè¿™æ ·çš„è¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡å¼‚æ­¥çš„`async/await`æ¥è¿ç»­æ‰§è¡ŒåŠ¨ç”»ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬å°±æ¥å®ç°å¼¹èµ·çš„åŠ¨ç”»ã€‚

ä¸è‡ªç”±è½ä½“è¿åŠ¨ç›¸åï¼Œå¼¹èµ·çš„åŠ¨ç”»æ˜¯ä¸€ä¸ªâ€œåŒ€å‡é€Ÿâ€è¿åŠ¨ï¼Œæœ€ç»ˆå°†åˆé€Ÿåº¦é™ä¸º0ã€‚

åœ¨è¿™ä¸€é˜¶æ®µï¼Œå°çƒçš„åˆé€Ÿåº¦ä¸åŠ é€Ÿåº¦åˆ†åˆ«æ˜¯:

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ab6bf89db3a149dcb9ae14aea2c7f227~tplv-k3u1fbpfcp-zoom-1.image)

é‚£ä¹ˆç»è¿‡tæ—¶é—´ï¼ˆt <= Tï¼‰ï¼Œå°çƒè¿åŠ¨çš„ä½ç§»ä¸ºï¼š

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ea9e9b987f84408e9b8cb7abfe2a8c1a~tplv-k3u1fbpfcp-zoom-1.image)

æ‰€ä»¥ï¼Œå¼¹è·³é˜¶æ®µçš„JSï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·å†™ï¼š

```js
animate(sphere, 1000, (target, p) => {
  // èµ·ç‚¹æ˜¯400ï¼Œåå‘è¿åŠ¨ï¼Œæ‰€ä»¥è¦ç”¨400å‡
  const top = 400 - 400 * p * (2 - p);
  target.style.top = `${top}px`;
});
```

ç„¶åï¼Œæˆ‘ä»¬æŠŠä¸¤ä¸ªåŠ¨ç”»è¿èµ·æ¥ï¼š

```js
(async function () {
  while(1) {
    await animate(sphere, 1000, (target, p) => {
      const top = 400 * p ** 2;
      target.style.top = `${top}px`;
    });
    await animate(sphere, 1000, (target, p) => {
      // èµ·ç‚¹æ˜¯400ï¼Œåå‘è¿åŠ¨ï¼Œæ‰€ä»¥è¦ç”¨400å‡
      const top = 400 - 400 * p * (2 - p);
      target.style.top = `${top}px`;
    });
  }
}());
```

æœ€ç»ˆå®ç°çš„æ•ˆæœå¦‚ä¸‹å›¾ï¼š

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/30f7fe94f7664c9787c0dfc78229834f~tplv-k3u1fbpfcp-zoom-1.image)

è¿™ä¸ªæ•ˆæœä¸æ˜¯æˆ‘ä»¬æœ€ç»ˆæƒ³è¦çš„ï¼Œå› ä¸ºå°çƒä¸åœåœ°å¼¹è·³è€Œä¸ä¼šåœæ­¢ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ç»™å°çƒå¢åŠ ä¸€ä¸ªèƒ½é‡æŸè€—ã€‚

å‡è®¾å°çƒæ¯æ¬¡ä¸åœ°é¢ç¢°æ’åï¼Œå®ƒçš„åŠ¨èƒ½æŸè€—30%ï¼Œé‚£ä¹ˆæ ¹æ®èƒ½é‡å®ˆæ’ï¼Œå®ƒå¼¹èµ·çš„é«˜åº¦å°†å˜ä¸ºä¹‹å‰çš„0.7ï¼Œè€Œå®ƒå¼¹èµ·çš„æ—¶é—´å°†å˜ä¸ºä¹‹å‰çš„æ ¹å·0.7ï¼š

æ‰€ä»¥æœ€åæˆ‘ä»¬å°†åŠ¨ç”»ä¿®æ”¹ä¸ºï¼š

```js
(async function () {
  let height = 400;
  let duration = 1000;

  while(1) {
    await animate(sphere, duration, (target, p) => {
      const top = (400 - height) + height * p ** 2;
      target.style.top = `${top}px`;
    });

    // èƒ½é‡æŸè€—åçš„åŠ¨ç”»æ‰§è¡Œé«˜åº¦å’Œæ—¶é—´
    height *= 0.7;
    duration *= Math.sqrt(0.7);

    await animate(sphere, duration, (target, p) => {
      // èµ·ç‚¹æ˜¯400ï¼Œåå‘è¿åŠ¨ï¼Œæ‰€ä»¥è¦ç”¨400å‡
      const top = 400 - height * p * (2 - p);
      target.style.top = `${top}px`;
    });
  }
}());
```

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a19a14b467fe45c4acb756e9d66f2400~tplv-k3u1fbpfcp-zoom-1.image)

æ‰€ä»¥æœ€ç»ˆå°±å®ç°äº†æˆ‘ä»¬æ‰€æœŸæœ›çš„æ•ˆæœã€‚[åœ¨çº¿æ¼”ç¤º](https://junyux.github.io/FE-Advance/day08/index2-v1.html)

ç°åœ¨æˆ‘ä»¬æ¥æ€»ç»“ä¸€ä¸‹è¿ç»­åŠ¨ç”»çš„æ€è·¯ï¼š

1. å°†è¿ç»­çš„åŠ¨ç”»åˆ†è§£ä¸ºè‹¥å¹²ä¸ªå›ºå®šè½¨è¿¹çš„åŠ¨ç”»
1. ä¸ºæ¯ä¸ªé˜¶æ®µçš„åŠ¨ç”»è®¾è®¡è½¨è¿¹æ–¹ç¨‹ï¼Œæ‰¾å‡ºåŠ¨ç”»å˜é‡å’Œæ—¶é—´çš„å…³ç³»
1. ç¡®å®šæ¯ä¸ªé˜¶æ®µçš„åŠ¨ç”»å‘¨æœŸï¼ˆdurationï¼‰å’Œä¸åŠ¨ç”»å˜é‡å¯¹åº”çš„CSSå±æ€§
1. åˆ©ç”¨å¼‚æ­¥çš„æ–¹å¼ï¼ˆPromiseï¼‰è¿æ¥æ¯ä¸ªé˜¶æ®µçš„åŠ¨ç”»ï¼Œå½¢æˆä¸€ä¸ªè¿ç»­çš„åŠ¨ç”»æ•ˆæœ

<!-- ç°åœ¨æˆ‘ä»¬æ¥æ€»ç»“ä¸€ä¸‹JSåŠ¨ç”»çš„è¦ç´ ï¼š

JSåŠ¨ç”»çš„å…³é”®å› ç´ æ˜¯åŠ¨ç”»çš„å‘¨æœŸdurationã€åŠ¨ç”»ä¾¿é‡ï¼ˆåœ¨è¿™é‡Œæ˜¯å°çƒçš„ä½ç§»ï¼‰ä¸æ—¶é—´çš„å…³ç³»ã€‚å®é™…ä¸ŠJSåŠ¨ç”»å°±æ˜¯æ ¹æ®æ—¶é—´å’Œå‘¨æœŸæ¥æ”¹å˜å…ƒç´ çš„æŸä¸ªCSSå±æ€§å€¼ã€‚æ— è®ºå¤šå¤æ‚çš„åŠ¨ç”»ï¼Œæœ¬è´¨ä¸Šéƒ½æ˜¯å±æ€§å…³äºæ—¶é—´çš„å‡½æ•°ã€‚å®é™…ä¸Šï¼Œä¸ä»…ä»…æ˜¯JSåŠ¨ç”»ï¼ŒCSSåŠ¨ç”»ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œç¼“åŠ¨ï¼ˆeasingï¼‰å‡½æ•°æœ¬èº«å°±æ˜¯å¯¹è¿åŠ¨çš„æŠ½è±¡ï¼Œä¾‹å¦‚è‡ªç”±è½ä½“è¿åŠ¨è¿‘ä¼¼ç­‰äº`ease-in`ï¼Œå¼¹èµ·çš„åŒ€å‡é€Ÿè¿åŠ¨è¿‘ä¼¼ç­‰äº`ease-out`ã€‚

ä»»ä½•å…ƒç´ æ ·å¼åŠ¨ç”»éƒ½èƒ½å¤Ÿç”¨ä¸Šè¿°åŸºæœ¬åŸç†æ¥å®ç°ï¼Œä¸è¿‡åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä¸€äº›ç‰¹æ®Šçš„æ•ˆæœè¿˜æ˜¯éœ€è¦ä¸€å®šçš„æŠ€å·§å’Œå€ŸåŠ©æŸäº›ç‰¹æ®ŠCSSè§„åˆ™æ¥å®ç°ã€‚ -->

## ç¬¬å››ä¸ªæ•…äº‹ï¼šå¸¸ç”¨åŠ¨ç”»å®ç°æŠ€å·§

é€šè¿‡å‰é¢çš„ä¸‰ä¸ªæ•…äº‹ï¼Œæˆ‘ä»¬å­¦ä¹ äº†ä¸¤ç§éå¸¸å¸¸è§çš„åŠ¨ç”»æ¨¡å¼ï¼šå›ºå®šè½¨è¿¹åŠ¨ç”»å’Œè¿ç»­åŠ¨ç”»ã€‚

è¿ç»­åŠ¨ç”»å®é™…ä¸Šæ˜¯ç”±å¤šæ®µå›ºå®šè½¨è¿¹åŠ¨ç”»ç»„åˆè€Œæˆçš„ã€‚åœ¨ç¬¬ä¸‰ä¸ªæ•…äº‹é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨Promiseæ¥å¤„ç†è¿ç»­åŠ¨ç”»ï¼Œè¿™æ˜¯ä¸€ç§æœ€æ–¹ä¾¿çš„å¼‚æ­¥å¤„ç†æ–¹å¼ï¼Œåœ¨ç¬¬å…«æ—¥çš„æ•…äº‹ä¸­ï¼Œæˆ‘ä»¬ä¼šæœ‰æ›´è¯¦ç»†çš„è®¨è®ºã€‚

è€Œå›ºå®šè½¨è¿¹åŠ¨ç”»å¯ä»¥æŠ½è±¡ä¸ºä¸€ä¸ªç”±**åŠ¨ç”»å‘¨æœŸ(T)**ã€**åŠ¨ç”»æ‰§è¡Œæ—¶é—´(t)**ï¼Œä»¥åŠ**æ—¶é—´ä¸å±æ€§å€¼çš„æ˜ å°„å‡½æ•°(progress)** å…±åŒå†³å®šçš„æ¨¡å‹ã€‚

### æ’å€¼

åœ¨å›ºå®šè½¨è¿¹åŠ¨ç”»æ¨¡å‹é‡Œï¼ŒçŸ¥é“Tã€tä»¥åŠprogressï¼Œæˆ‘ä»¬å°±èƒ½å”¯ä¸€ç¡®å®šåŠ¨ç”»å…ƒç´ targetåœ¨tæ—¶åˆ»çš„å±æ€§å€¼ã€‚å…¶ä¸­æ¯”è¾ƒå¤æ‚çš„æ˜¯progressï¼Œæˆ‘ä»¬å¯ä»¥å¯¹å®ƒè¿›è¡Œè§„èŒƒï¼š

- progresså¯ä»¥ç”±èµ·å§‹å€¼ï¼ˆstartï¼‰ã€ç»“æŸå€¼ï¼ˆendï¼‰ã€ä»¥åŠæ’å€¼å‡½æ•°ï¼ˆinterpolateï¼‰ç¡®å®šã€‚

æˆ‘ä»¬ç”¨è¿™ä¸ªè§„èŒƒï¼Œé‡æ„ä¸€ä¸‹ä¸Šä¸€ä¸ªæ•…äº‹ä¸­çš„`animate`å‡½æ•°ï¼š

```js
/*
  @target ç›®æ ‡å…ƒç´ 
  @prop CSSå±æ€§
  @duration åŠ¨ç”»å‘¨æœŸ
  @start åŠ¨ç”»å¼€å§‹æ—¶ï¼ŒCSSå±æ€§çš„å€¼
  @end åŠ¨ç”»ç»“æŸæ—¶ï¼ŒCSSå±æ€§å€¼
  @interpolate æ’å€¼å‡½æ•°
*/
function animate({target, prop, duration, start, end, interpolate} = {}) {
  const startTime = Date.now();

  return new Promise((resolve) => {
    function update() {
      const t = Date.now() - startTime;
      const p = Math.min(t / duration, 1);
      target.style[prop] = interpolate(start, end, p);
      if(p < 1) {
        requestAnimationFrame(update);
      } else {
        resolve(p);
      }
    }
    update();
  });
}
```

å¦‚ä¸Šä»£ç æ‰€ç¤ºï¼Œ`interpolate(start, end, p)`è¿™ä¸ªå‡½æ•°çš„è¿”å›å€¼å°±æ˜¯æ ¹æ®`p`å¯¹åº”çš„æ¯”ä¾‹è½åœ¨`start`åˆ°`end`ä¹‹é—´çš„å€¼ï¼Œä¹Ÿå«åš**æ’å€¼**ã€‚è€Œ`p`çš„å€¼æ˜¯åœ¨[t/duration, 1]ä¹‹é—´ ï¼ˆä¹Ÿå°±æ˜¯[0,1]ä¹‹é—´)ï¼Œæ‰€ä»¥è¿™é‡Œçš„æ’å€¼ç®€å•æ¥è¯´ï¼Œè¡¨ç¤ºæ ¹æ®åŠ¨ç”»çš„èµ·å§‹å€¼ï¼ˆstartï¼‰å’ŒåŠ¨ç”»çš„ç»“æŸå€¼ï¼ˆend)ï¼Œåœ¨å½“å‰æ—¶é—´ä¸‹è®¡ç®—å‡ºçš„ä½äºstartå’Œendä¹‹é—´çš„å€¼ã€‚

ä¸‹é¢ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹è¿™ä¸ªæ’å€¼æ˜¯å¦‚ä½•è¢«è®¡ç®—å‡ºæ¥çš„ï¼š
<!-- è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ç”¨ä¸‹é¢çš„ä»£ç æ¥å®ç°ä¸Šä¸€ä¸ªæ•…äº‹ä¸­å°çƒçš„è‡ªç”±è½ä½“åŠ¨ç”»äº†ã€‚ -->

```js
animate({
  target: sphere,
  prop: 'top',
  duration: 1000,
  start: 100,
  end: 400,
  interpolate(start, end, p) {
    p **= 2; //åŒ€åŠ é€Ÿ
    return `${start * (1 - p) + end * p}px`;
  }
});
```

ä¸Šé¢çš„ä»£ç å®ç°äº†ç¬¬ä¸‰ä¸ªæ•…äº‹ä¸­è‡ªç”±è½ä½“çš„åŠ¨ç”»ã€‚å…¶ä¸­ï¼Œ`start * (1 - p) + end * p`æ˜¯ä¸€ä¸ªæœ€ç®€å•çš„æ’å€¼å…¬å¼ï¼Œå®ƒçš„è¿”å›å€¼æ˜¯ä¸€ä¸ª**çº¿æ€§æ’å€¼**ã€‚å¦‚æœæˆ‘ä»¬ä¸åŠ `p **= 2`ï¼Œé‚£ä¹ˆè¿”å›çš„æ’å€¼æ˜¯çº¿æ€§çš„ï¼Œè¿™æ ·çš„è¯å°çƒå°±æ˜¯åŒ€é€Ÿè¿åŠ¨ã€‚
<!-- æˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹`interpolate`å‡½æ•°ã€‚å…¶ä¸­ï¼Œ`start * (1 - p) + end * p`å«åš**çº¿æ€§æ’å€¼**ï¼Œä¹Ÿæ˜¯æœ€ç®€å•çš„æ’å€¼ã€‚å®ƒè¡¨ç¤ºè®©è¿”å›çš„å€¼ï¼Œæ ¹æ®`p`å¯¹åº”çš„æ¯”ä¾‹è½åœ¨`start`åˆ°`end`ä¹‹é—´ï¼Œå¦‚æœæˆ‘ä»¬ä¸åŠ `p **= 2`é‚£ä¹ˆç”¨çš„å°±æ˜¯çº¿æ€§æ’å€¼ï¼Œè¿™æ ·çš„è¯å°çƒå°±æ˜¯åŒ€é€Ÿè¿åŠ¨ã€‚ -->

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9ca5f721599641e0872aad4d446ff33b~tplv-k3u1fbpfcp-zoom-1.image)

å¦‚æœéœ€è¦å°çƒåšåŒ€åŠ é€Ÿè¿åŠ¨ï¼Œæ ¹æ®å‰é¢çš„å…¬å¼ï¼š

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a0dfa27328ad4d0190a193f716bea086~tplv-k3u1fbpfcp-zoom-1.image)

è¿™é‡Œ`t/T`å°±æ˜¯`p`ï¼Œå½“`p`ç­‰äº`p ** 2`å³`p`çš„å¹³æ–¹ï¼ŒåŠ¨ç”»å°±å˜æˆåŒ€åŠ é€Ÿäº†ã€‚

åŒæ ·çš„ï¼Œå¦‚æœæˆ‘ä»¬è¦åšå¼¹èµ·çš„åŠ¨ç”»ï¼Œå¯ä»¥ï¼š

```js
animate({
  target: sphere,
  prop: 'top',
  duration: 1000,
  start: 400,
  end: 100,
  interpolate(start, end, p) {
    p *= (2 - p); //åŒ€å‡é€Ÿ
    return `${start * (1 - p) + end * p}px`;
  }
});
```

æ’å€¼ä¸ä»…å¯ä»¥æ”¹å˜åƒ`top`ã€`left`æˆ–è€…`width`ã€`height`è¿™æ ·çš„å±æ€§å€¼ï¼Œè¿˜å¯ä»¥å¤„ç†æ›´å¤æ‚çš„å±æ€§å€¼ï¼Œæ¯”å¦‚é¢œè‰²ï¼š

```js
function lerp(start, end, p) {
  return start * (1 - p) + end * p;
}

animate({
  target: sphere,
  prop: 'background',
  duration: 1000,
  start: [0, 170, 255],
  end: [255, 170, 0],
  interpolate(start, end, p) {
    const color = start.map((s, i) => {
      return lerp(s, end[i], p);
    });
    return `rgb(${color})`
  }
});
```

ä¸Šé¢çš„ä»£ç ç»™å°çƒå¢åŠ ä¸€ä¸ªæ”¹å˜é¢œè‰²çš„åŠ¨ç”»ï¼Œè¿™æ ·æˆ‘ä»¬ä¼šçœ‹åˆ°å°çƒåœ¨å¼¹èµ·çš„åŒæ—¶ï¼Œé¢œè‰²ä¹Ÿä¼šå‘ç”Ÿæ”¹å˜ã€‚

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6323756059a1454cb1d4512f8a6406ea~tplv-k3u1fbpfcp-zoom-1.image)

### ç¼“åŠ¨

æˆ‘ä»¬çœ‹åˆ°ï¼ŒåŒ€é€Ÿè¿åŠ¨ä½¿ç”¨çº¿æ€§æ’å€¼`lerp`å‡½æ•°ï¼ŒåŒ€åŠ é€Ÿè¿åŠ¨åœ¨çº¿æ€§æ’å€¼å‰å°†`p`æ”¹å˜ä¸º`p`å¹³æ–¹ï¼Œè€ŒåŒ€å‡é€Ÿè¿åŠ¨åœ¨çº¿æ€§æ’å€¼å‰å°†`p`æ”¹å˜ä¸º`p*(2-p)`ï¼Œå®é™…ä¸Šå…¶ä»–çš„è¿åŠ¨å½¢å¼ä¹Ÿå¯ä»¥ç”¨è¿™ä¸ªæ¨¡å‹å¤„ç†ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°†æ”¹å˜`p`çš„è¿‡ç¨‹æŠ½è±¡å‡ºæ¥ï¼Œå«åš**ç¼“åŠ¨å‡½æ•°(easing)**ã€‚

```js
function animate({target, prop, duration, start, end, easing, interpolate} = {}) {
  const startTime = Date.now();

  return new Promise((resolve) => {
    function update() {
      const t = Date.now() - startTime;
      const p = Math.min(t / duration, 1);

      target.style[prop] = interpolate(start, end, easing ? easing(p) : p);
      if(p < 1) {
        requestAnimationFrame(update);
      } else {
        resolve(p);
      }
    }
    update();
  });
}
```

è¿™æ ·ï¼ŒåŒ€å‡é€Ÿçš„å°çƒå¼¹èµ·å°±æ”¹å†™ä¸ºï¼š

```js
animate({
  target: sphere,
  prop: 'top',
  duration: 1000,
  start: 400,
  end: 100,
  easing(p) {
    return p * (2 - p);
  },
  interpolate(start, end, p) {
    return `${start * (1 - p) + end * p}px`;
  }
});
```

é™¤äº†åŒ€åŠ é€Ÿã€åŒ€å‡é€Ÿå¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥å®ç°å…¶ä»–çš„ç¼“åŠ¨å‡½æ•°ï¼Œæ¯”å¦‚å‘¨æœŸè¿åŠ¨ï¼š

```js
animate({
  target: sphere,
  prop: 'background',
  duration: 100000,
  start: [0, 170, 255],
  end: [255, 170, 0],
  easing(p) {
    return 100 * p % 1;
  },
  interpolate(start, end, p) {
    const color = start.map((s, i) => {
      return lerp(s, end[i], p);
    });
    return `rgb(${color})`
  }
});
```

å¦‚ä¸Šä»£ç æ‰€ç¤ºï¼Œè¿™æ˜¯ä¸ªæ‰§è¡Œ100ç§’çš„åŠ¨ç”»ï¼Œä½†æ˜¯åˆ†ä¸º100ä¸ªå‘¨æœŸï¼Œæ¯ä¸ªå‘¨æœŸèƒŒæ™¯è‰²éƒ½æ˜¯ä»`rgb(0, 170, 255)`çº¿æ€§æ¸å˜åˆ°`rgb(255, 170, 0)`ã€‚

```js
animate({
  target: sphere,
  prop: 'top',
  duration: 100000,
  start: 250,
  end: 100,
  easing(p) {
    return Math.sin(100 * Math.PI * p);
  },
  interpolate(start, end, p) {
    return `${start * (1 - p) + end * p}px`;
  }
});
```

ä¸Šé¢çš„ä»£ç æ˜¯æ‰§è¡Œ100ç§’çš„åŠ¨ç”»ï¼Œåˆ†ä¸º50ä¸ªå‘¨æœŸï¼Œè®©å°çƒä»¥250ç‚¹ä¸ºèµ·ç‚¹ï¼Œåšå¹…åº¦åŠå¾„ä¸º150çš„ç®€è°æŒ¯åŠ¨ã€‚

æˆ‘ä»¬å¯ä»¥å°†ä¸Šé¢ä¸¤ä¸ªåŠ¨ç”»åˆèµ·æ¥ï¼Œå®ƒçš„æ•ˆæœå¦‚ä¸‹æ‰€ç¤ºï¼š

[åœ¨çº¿æ¼”ç¤º](https://junyux.github.io/FE-Advance/day08/index2-ex.html)

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e9d1781c3dfe47439bbbde6c718029ef~tplv-k3u1fbpfcp-zoom-1.image)

å¦‚æœä½ ç†Ÿæ‚‰CSSåŠ¨ç”»ï¼Œä½ ä¸€å®šçŸ¥é“CSSåŠ¨ç”»ä¸­ä¹Ÿæ˜¯æœ‰ç¼“åŠ¨å‡½æ•°çš„æ¦‚å¿µçš„ï¼Œè€Œå¤§å¤šæ•°ç¼“åŠ¨æ•ˆæœå¯ä»¥ä½¿ç”¨ä¸‰é˜¶è´å¡å°”æ›²çº¿æè¿°ã€‚

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a9690aa520f84094a1776e66065821f1~tplv-k3u1fbpfcp-zoom-1.image)

ä¸‰é˜¶è´å¡å°”æ›²çº¿æ˜¯ç”±P0ã€P3ä¸¤ä¸ªå›ºå®šç‚¹å’ŒP2ã€P1ä¸¤ä¸ªåŠ¨ç‚¹è¡¨è¿°çš„è¿ç»­æ›²çº¿ï¼Œæ»¡è¶³å¦‚ä¸‹çº¿æ€§æ–¹ç¨‹ã€‚

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/db81c2e8249d4599a21c549b3b30df6b~tplv-k3u1fbpfcp-zoom-1.image)

åœ¨CSSåŠ¨ç”»ä¸­å†…ç½®äº†è´å¡å°”æ›²çº¿çš„ç¼“åŠ¨å‡½æ•°ï¼Œæ¯”å¦‚æˆ‘ä»¬å¯ä»¥å†™è¿™æ ·çš„åŠ¨ç”»ï¼š

```html
<div id="block"></div>
```

```css
#block {
  position: absolute;
  width: 50px;
  height: 50px;
  left: 100px;
  background: red;
  animation: move 3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
}

@keyframes move {
  from {left: 100px}
  to {left: 400px}
}
```

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/bbf37fa72fdd4491bdd9140bd80bcf00~tplv-k3u1fbpfcp-zoom-1.image)

æœ‰è®¸å¤šç¼“åŠ¨å‡½æ•°éƒ½å¯ä»¥é€šè¿‡ä¸‰é˜¶è´å¡å°”æ›²çº¿æ¥å®ç°ï¼š

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0dc981aad0fd4a9fb5732cb2d35a9f64~tplv-k3u1fbpfcp-zoom-1.image)

åœ¨JSä¸­ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æ„é€ ä¸‰é˜¶è´å¡å°”æ›²çº¿ç¼“åŠ¨å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨[bezier-easing](https://github.com/gre/bezier-easing)è¿™ä¸ªå¼€æºåº“ã€‚

```html
<script src="https://s5.ssl.qhres.com/!8cf7bfcd/bezier-easing.js"></script>
```

```js
animate({
  target: sphere,
  prop: 'top',
  duration: 2000,
  start: 400,
  end: 100,
  easing: BezierEasing(0.68, -0.55, 0.265, 1.55),
  interpolate(start, end, p) {
    return `${start * (1 - p) + end * p}px`;
  }
});
```

ä¸Šé¢çš„ä»£ç äº§ç”Ÿçš„å°çƒåŠ¨ç”»æ•ˆæœå¦‚ä¸‹ï¼š[åœ¨çº¿æ¼”ç¤º](https://junyux.github.io/FE-Advance/day08/index2-ex2.html)

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4d741320b39746e49647f2878567820d~tplv-k3u1fbpfcp-zoom-1.image)

å®é™…ä¸Šï¼Œåœ¨è¾ƒæ–°çš„æµè§ˆå™¨ç¯å¢ƒä¸­ï¼Œæä¾›äº†JavaScriptåŸç”Ÿçš„åŠ¨ç”»APIï¼Œå«åš[Web Animation API](https://developer.mozilla.org/en-US/docs/Web/API/Web_Animations_API)ã€‚è¿™æ˜¯ä¸€ä¸ªç›®å‰è¿˜å¤„åœ¨è‰æ¡ˆé˜¶æ®µçš„æ–°ç‰¹æ€§ï¼Œä»…è¢«éƒ¨åˆ†è¾ƒæ–°çš„æµè§ˆå™¨æ‰€æ”¯æŒã€‚

Web Animation API ä¸ºDOMå…ƒç´ æä¾›äº†åŸç”Ÿçš„animateæ–¹æ³•ï¼Œå®ƒæ¥å—keyframeså’Œoptionsä¸¤ä¸ªå‚æ•°ï¼Œèƒ½å¤Ÿç”¨JSå®ç°å’ŒCSSåŸºæœ¬ä¸Šä¸€è‡´çš„å…³é”®å¸§åŠ¨ç”»ï¼š

```js
sphere.animate([
  {top: '400px'},
  {top: '100px'},
], {
  duration: 2000,
  easing: 'cubic-bezier(0.68, -0.55, 0.265, 1.55)',
  fill: 'forwards',
});
```

ä¸Šé¢çš„ä»£ç å’Œå‰ä¸€ä¸ªä¾‹å­å®ç°çš„æ•ˆæœä¸€è‡´ï¼Œä½†æ˜¯ä¸éœ€è¦ä¾èµ–æˆ‘ä»¬è‡ªå·±å®ç°çš„åŠ¨ç”»æ–¹æ³•ï¼Œç›´æ¥ç”¨åŸç”Ÿçš„`.animate`æ–¹æ³•å³å¯ã€‚

ğŸ’¡å› ä¸ºç°åœ¨Web Animation APIä»ç„¶å¤„äºED(Editor Draft)é˜¶æ®µï¼Œæ‰€ä»¥æ”¯æŒçš„æµè§ˆå™¨æœ‰é™ï¼Œè€Œä¸”æœªæ¥APIå¯èƒ½è¿˜ä¼šæœ‰æ‰€å˜åŒ–ï¼Œæ‰€ä»¥ç°åœ¨ä¸å»ºè®®ç›´æ¥ä½¿ç”¨ã€‚

å¥½åœ¨ï¼Œé€šè¿‡å‰é¢çš„ä¾‹å­æˆ‘ä»¬ä¹Ÿçœ‹åˆ°ï¼Œè‡ªå·±å®ç°ä¸€ä¸ªç®€å•çš„JSåŠ¨ç”»å‡½æ•°ï¼Œä¹Ÿä¸æ˜¯ä»€ä¹ˆå›°éš¾çš„äº‹æƒ…ï¼Œæœ‰äº†é€šç”¨çµæ´»çš„åŠ¨ç”»æœºåˆ¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥å®ç°å„ç§æœ‰è¶£çš„åŠ¨ç”»æ•ˆæœã€‚ä¸è¿‡ï¼Œæœ‰äº›ç‰¹æ®Šçš„åŠ¨ç”»æ•ˆæœï¼Œé™¤äº†ä½¿ç”¨åŠ¨ç”»å‡½æ•°å¤–ï¼Œå¯èƒ½è¿˜éœ€è¦è¿ç”¨ä¸€äº›ç‰¹æ®Šçš„CSSå±æ€§ã€‚

## ç¬¬äº”ä¸ªæ•…äº‹ï¼šç‰¹æ®Šçš„åŠ¨ç”»æ•ˆæœ

å‰é¢è¯´äº†åŠ¨ç”»çš„åŸºæœ¬æ€è·¯ï¼ŒåŸºæœ¬ä¸Šæ‰€æœ‰çš„åŠ¨ç”»éƒ½å¯ä»¥ç”¨å‰é¢æ€è·¯æ¥å®ç°ã€‚è¿™ä¸ªæ•…äº‹ï¼Œæˆ‘å°†å¸¦ä½ çœ‹ä¸€äº›ç”¨ç‰¹æ®Šçš„å…ƒç´ å±æ€§ï¼Œå®ç°æ¯”è¾ƒç¥å¥‡çš„åŠ¨ç”»æ•ˆæœã€‚

### å…ƒç´ æ¸æ˜¾

æœ€ç®€å•çš„æ¸æ˜¾å…ƒç´ çš„æ–¹å¼æ˜¯æ”¹å˜å…ƒç´ çš„é€æ˜åº¦ï¼Œé€šè¿‡æ“ä½œCSSçš„opacityå±æ€§å°±èƒ½å®ç°ã€‚

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/78cf1459b6bf4e539b4993e560343789~tplv-k3u1fbpfcp-zoom-1.image)

```html
<div id="content">æ–‡å­—å†…å®¹</div>
```

```css
#content {
  display: inline-block;
  padding: 5px;
  border: solid 1px;
  font-size: 1.5rem;
  opacity: 0;
  animation: fade-in 5s infinite;
}

@keyframes fade-in {
  to {opacity: 1};
}
```

é‚£ä¹ˆï¼Œå¦‚æœæˆ‘ä»¬è¦è®©å…ƒç´ ä»ä¸Šå¾€ä¸‹ï¼Œæˆ–è€…ä»å·¦å¾€å³æ¸æ˜¾å‡ºæ¥ï¼Œè¦å¦‚ä½•å®ç°å‘¢ï¼š

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ede00655f51242e7ae1176a66161b723~tplv-k3u1fbpfcp-zoom-1.image)

æˆ‘ä»¬å¯ä»¥ç”¨ä¼ªå…ƒç´ é®ç›–ä½å…ƒç´ å†…å®¹ï¼Œç„¶åç”¨åŠ¨ç”»æ”¹å˜ä¼ªå…ƒç´ çš„å®½æˆ–é«˜ï¼š

[åœ¨çº¿æ¼”ç¤º](https://junyux.github.io/FE-Advance/day08/index3-v2.html)

```css
#content {
  position: relative;
  display: inline-block;
  padding: 5px;
  border: solid 1px;
  font-size: 1.5rem;
}

#content::after {
  position: absolute;
  top: -1px;
  right: -1px;
  width: calc(100% + 2px);
  height: calc(100% + 2px);
  content: ' ';
  background: white;
  animation: slide 2s ease-in forwards;
}

@keyframes slide {
  to {width: 0};
}
```

ä¸Šé¢çš„ä»£ç éœ€è¦æ³¨æ„çš„ç»†èŠ‚æ˜¯ï¼š

- å¦‚æœå…ƒç´ æœ‰borderï¼Œä¼ªå…ƒç´ çš„å®½é«˜è¦è®¾ä¸º100%åŠ ä¸Šborderï¼Œå¯¹åº”çš„`top`å’Œ`right`è¦è®¾ç½®ä¸ºè´Ÿçš„borderå®½åº¦ã€‚
- å› ä¸ºåŠ¨ç”»ä¸­ï¼Œæ–‡å­—å…ƒç´ æ˜¯ä»å·¦å¾€å³æ˜¾ç°ï¼Œæ‰€ä»¥ä¼ªå…ƒç´ çš„å®½åº¦éœ€è¦ä»å·¦å¾€å³ç¼©å°ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å°†ä¼ªå…ƒç´ çš„å›ºå®šç‚¹è®¾ç½®åœ¨å³ä¸Šè§’æˆ–è€…å³ä¸‹è§’ï¼Œå³ï¼šè®¾ç½®`top`/`bottom`å’Œ`right`å±æ€§ï¼›å¦‚æœåŠ¨ç”»è¦ä»å³å¾€å·¦æ˜¾ç°ï¼Œåˆ™éœ€è¦è®¾ç½®`top`/`bottom`å’Œ`left`å±æ€§ï¼›åŒæ ·ï¼Œå¦‚æœä»ä¸Šå¾€ä¸‹æ˜¾ç°ï¼Œé‚£ä¹ˆå°±è®¾ç½®`left`/`right`å’Œ`bottom`å±æ€§ã€‚

#### clip-pathå±æ€§

ä¸Šé¢è¿™ä¸ªæ–¹æ³•æœ‰ç‚¹ä¸å¤Ÿå®Œç¾ï¼Œä¸»è¦æ˜¯æˆ‘ä»¬ç»™`after`ä¼ªå…ƒç´ è®¾ç½®äº†ä¸€ä¸ªç™½è‰²çš„èƒŒæ™¯ï¼Œå¦‚æœçˆ¶å…ƒç´ çš„èƒŒæ™¯ä¸æ˜¯ç™½è‰²ï¼Œæˆ–è€…æ”¹å˜äº†ï¼Œæˆ‘ä»¬å°±éœ€è¦ä¿®æ”¹å¯¹åº”çš„å±æ€§å€¼ã€‚å®é™…ä¸Šï¼Œè¿™ä¸ªé—®é¢˜æœ‰ä¸ªæ›´ç®€å•çš„è§£å†³æ–¹æ¡ˆï¼Œä½¿ç”¨CSSçš„`clip-path`å±æ€§ï¼š

[åœ¨çº¿æ¼”ç¤º](https://junyux.github.io/FE-Advance/day08/index3-v3.html)

```css
#content {
  position: relative;
  display: inline-block;
  padding: 5px;
  border: solid 1px;
  font-size: 1.5rem;
  clip-path: polygon(0% 0%, 0% 0%, 0% 100%, 0% 100%);
  animation: slide 2s forwards;
}

@keyframes slide {
  to {clip-path: polygon(0% 0%, 100% 0%, 100% 100%, 0% 100%)};
}
```

`clip-path` å±æ€§å¯ä»¥åˆ›å»ºä¸€ä¸ªåªæœ‰å…ƒç´ çš„éƒ¨åˆ†åŒºåŸŸå¯ä»¥æ˜¾ç¤ºçš„å‰ªåˆ‡åŒºåŸŸã€‚åŒºåŸŸå†…çš„éƒ¨åˆ†æ˜¾ç¤ºï¼ŒåŒºåŸŸå¤–çš„éšè—ã€‚å‰ªåˆ‡åŒºåŸŸæ˜¯è¢«å¼•ç”¨å†…åµŒçš„URLå®šä¹‰çš„è·¯å¾„æˆ–è€…å¤–éƒ¨svgçš„è·¯å¾„ï¼Œæˆ–è€…ä½œä¸ºä¸€ä¸ªå½¢çŠ¶ä¾‹å¦‚`polygon()`ã€‚è€Œä¸”ï¼Œé‡è¦çš„æ˜¯ï¼Œ`clip-path`æ”¯æŒCSSåŠ¨ç”»ã€‚

ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬é‡‡ç”¨`polygon`æ–¹æ³•å‰ªåˆ‡å¯è§†åŒºåŸŸã€‚è¿™ä¸ªæ–¹æ³•æ¥å—8ä¸ªå‚æ•°ï¼Œæ¯ä¸¤ä¸ªåˆ†åˆ«è¡¨ç¤ºä¸€ä¸ªç‚¹çš„åæ ‡ã€‚æ‰€ä»¥ï¼Œ`polygon(0% 0%, 0% 0%, 0% 100%, 0% 100%)`åˆ†åˆ«è¡¨ç¤ºå‰2ä¸ªç‚¹åœ¨å…ƒç´ çš„å·¦ä¸Šè§’ï¼Œåä¸¤ä¸ªç‚¹åœ¨å…ƒç´ çš„å·¦ä¸‹è§’ã€‚`polygon(0% 0%, 100% 0%, 100% 100%, 0% 100%)}`è¿™ä¸ªæ˜¯åŠ¨ç”»ç»“æŸçš„çŠ¶æ€ï¼Œ4ä¸ªç‚¹åˆ†åˆ«ä½äºå…ƒç´ çš„å·¦ä¸Šè§’ã€å³ä¸Šè§’ã€å³ä¸‹è§’å’Œå·¦ä¸‹è§’ã€‚æ‰€ä»¥ï¼Œè¿™æ®µCSSè§„åˆ™è¡¨ç¤ºçš„æ˜¯ä»å·¦åˆ°å³çš„æ¸æ˜¾åŠ¨ç”»ã€‚

ç¨å¾®ä¿®æ”¹ä¸€ä¸‹`clip-path`çš„åˆå§‹å€¼ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥åšæ–œå‘æˆ–è€…å…¶ä»–å½¢å¼çš„æ¸æ˜¾åŠ¨ç”»ï¼š

[åœ¨çº¿æ¼”ç¤º](https://junyux.github.io/FE-Advance/day08/index3-v4.html)

```css
#content {
  position: relative;
  display: inline-block;
  padding: 5px;
  border: solid 1px;
  font-size: 1.5rem;
  clip-path: polygon(0% 0%, 0% 0%, 0% 0%, 0% 100%);
  animation: slide 2s forwards;
}

@keyframes slide {
  to {clip-path: polygon(0% 0%, 100% 0%, 100% 100%, 0% 100%)};
}
```

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c5611a1e96b6424e9ead8e270edc1179~tplv-k3u1fbpfcp-zoom-1.image)

æˆ–è€…ï¼š

[åœ¨çº¿æ¼”ç¤º](https://junyux.github.io/FE-Advance/day08/index3-v5.html)

```css
#content {
  position: relative;
  display: inline-block;
  padding: 5px;
  border: solid 1px;
  font-size: 1.5rem;
  clip-path: polygon(50% 50%, 50% 50%, 50% 50%, 50% 50%);
  animation: slide 2s forwards;
}

@keyframes slide {
  to {clip-path: polygon(0% 0%, 100% 0%, 100% 100%, 0% 100%)};
}
```

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/39eb4dc4e86a431a91397c848102ae0a~tplv-k3u1fbpfcp-zoom-1.image)


#### maskå±æ€§

æ›´å¤æ‚çš„æ¸æ˜¾åŠ¨ç”»å¯ä»¥ä½¿ç”¨CSSé®ç½©ï¼š`mask`å±æ€§ï¼Œä¸è¿‡è¿™æ˜¯ä¸€ä¸ªéæ ‡å‡†å±æ€§ï¼Œç›®å‰éœ€è¦åŠ -webkitå‰ç¼€ï¼Œåªæœ‰Chormeå’ŒSafariç­‰å°‘æ•°æµè§ˆå™¨çš„æ–°ç‰ˆæœ¬æ”¯æŒã€‚

`mask`å±æ€§å¯ä»¥æŒ‡å®šå›¾ç‰‡ä½œä¸ºå…ƒç´ çš„é®ç½©ï¼Œé®ç½©å¤–çš„å†…å®¹éšè—ï¼Œè€Œä¸”æˆ‘ä»¬å¯ä»¥æŠŠé®ç½©è®¾ç½®ä¸ºæ¸å˜ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨æ¸å˜é®ç½©æ¥å®ç°æ›´å¤æ‚çš„æ¸æ˜¾æ•ˆæœã€‚

```css
#logo {
  display: inline-block;
  width: 150px;
  height: 164px;
  background-image: url(https://p1.ssl.qhimg.com/t01d64366d00102132a.png);
  background-size: 100%;
  -webkit-mask: linear-gradient(to right, #000 0%, transparent 0) 0/20px;
}
```

å¦‚ä¸Šä»£ç æ‰€ç¤ºï¼Œ`-webkit-mask`å¯ä»¥è®¾ç½®ä¸€å¼ å›¾ç‰‡ä½œä¸ºé®ç½©å›¾ç‰‡ï¼Œè¿™ä¸ªå›¾ç‰‡å¯ä»¥æ˜¯SVGå›¾ç‰‡ã€PNGå›¾ç‰‡ã€çº¿æ€§æ¸å˜æˆ–è€…å…¶ä»–æ¸å˜ï¼Œæˆ‘ä»¬è¿™é‡Œä½¿ç”¨çº¿æ€§æ¸å˜ã€‚é™¤äº†è®¾ç½®é®ç½©å›¾ç‰‡ï¼Œè¿˜å¯ä»¥è®¾ç½®é®ç½©ä½ç½®/å®½é«˜ï¼Œ`0/20px`è¡¨ç¤ºé®ç½©ä½ç½®ä¸º`0,0`ï¼Œé®ç½©å®½ä¸º20pxï¼ˆè¿™é‡Œçœç•¥äº†yè½´çš„100%ï¼‰ã€‚

ä¸è¿‡å› ä¸º`linear-gradient`ä¸æ”¯æŒCSSåŠ¨ç”»ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜éœ€è¦ä½¿ç”¨JSï¼š

```js
function animate({target, prop, duration, start, end, easing, interpolate} = {}) {
  const startTime = Date.now();

  return new Promise((resolve) => {
    function update() {
      const t = Date.now() - startTime;
      const p = Math.min(t / duration, 1);

      target.style[prop] = interpolate(start, end, easing ? easing(p) : p);
      if(p < 1) {
        requestAnimationFrame(update);
      } else {
        resolve(p);
      }
    }
    update();
  });
}

animate({
  target: logo,
  prop: 'webkitMask',
  duration: 1000,
  start: 0,
  end: 100,
  interpolate(start, end, p) {
    const v = start * (1 - p) + end * p;
    return `linear-gradient(to right, #000 ${v}%, transparent 0) 0/20px`;
  }
});
```

æœ€ç»ˆå®ç°çš„æ•ˆæœå¦‚ä¸‹ï¼š[åœ¨çº¿æ¼”ç¤º](https://junyux.github.io/FE-Advance/day08/index3-v6.html)

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6c4b34052a484926a21f706d654ff776~tplv-k3u1fbpfcp-zoom-1.image)

### æè¾¹åŠ¨ç”»

æè¾¹åŠ¨ç”»æ˜¯æŒ‡æ¼”ç¤ºæç»˜æŸä¸ªå›¾å½¢çš„åŠ¨ç”»ï¼Œæ¯”å¦‚å®ç°ä¸‹é¢çš„æç»˜äº”è§’æ˜ŸåŠ¨ç”»ã€‚

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/90efde1974af45d1959789a6997de91a~tplv-k3u1fbpfcp-zoom-1.image)

è¿™æ ·çš„æè¾¹åŠ¨ç”»å¯ä»¥é€šè¿‡æ”¹å˜SVGå…ƒç´ çš„`stroke-dasharray`å’Œ`stroke-dashoffset`ä¸¤ä¸ªå±æ€§æ¥å®ç°ã€‚

[åœ¨çº¿æ¼”ç¤º](https://junyux.github.io/FE-Advance/day08/index4.html)

```html
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="500" height="500">
  <g fill="none">
    <polygon points="100,10 40,180 190,60 10,60 160,180">
  </g>
</svg>
```

```css
svg polygon {
  stroke: red;
  stroke-dasharray: 1000;
  stroke-dashoffset: 1000;
  stroke-width: 5;
  animation: stroke-path 5s linear infinite;
}

@keyframes stroke-path {
  to {
    stroke-dashoffset: 0;
  }
}
```

`stroke-dasharray`è¡¨ç¤ºå°†å›¾å½¢ä»¥è™šçº¿æç»˜ï¼Œ`stroke-dasharray:1000`è¡¨ç¤ºè™šçº¿å®çº¿æ¯ä¸€ä¸ªçº¿æ®µé•¿åº¦éƒ½æ˜¯`1000px`ï¼Œä¸€å¼€å§‹ç¬¬ä¸€æ¡çº¿æ®µæ˜¯å®çº¿ï¼Œç¬¬äºŒæ¡çº¿æ®µæ˜¯è™šçº¿ï¼Œç¬¬ä¸‰æ¡çº¿æ®µæ˜¯å®çº¿...è¿™æ ·ä¾æ¬¡äº¤æ›¿ã€‚

`stroke-dashoffset`è¡¨ç¤ºè™šçº¿çš„åç§»ï¼Œå°†å®ƒä¹Ÿè®¾ç½®ä¸º`1000`ï¼Œé‚£ä¹ˆç¬¬ä¸€æ¡çº¿å°±è¢«ç§»å‡ºäº†å¯è§åŒºåŸŸï¼Œä»è™šçº¿ï¼ˆå³ç¬¬äºŒæ¡çº¿ï¼‰å¼€å§‹å±•ç¤ºï¼Œæ‰€ä»¥æ­¤æ—¶çš„äº”è§’æ˜Ÿå¹¶æ²¡æœ‰æ˜¾ç¤ºå‡ºæ¥ï¼Œç„¶åæˆ‘ä»¬ä»¥åŠ¨ç”»çš„æ–¹å¼æ”¹å°è™šçº¿çš„åç§»é‡ï¼Œè¿™æ ·çš„è¯ï¼Œç¬¬ä¸€æ¡çº¿ï¼ˆå®çº¿ï¼‰å°±è¢«æ…¢æ…¢ç§»å›å¯è§†åŒºåŸŸï¼Œäºæ˜¯å›¾å½¢çš„çº¿æ¡å°±é€æ­¥å±•ç¤ºå‡ºæ¥äº†ã€‚

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f5ff3ccabcbd42a1adb5b2abfa450654~tplv-k3u1fbpfcp-zoom-1.image)

SVGå…ƒç´ é™¤äº†ä½¿ç”¨CSSã€JSåŠ¨ç”»ï¼Œè¿˜å¯ä»¥ä½¿ç”¨SVGæ”¯æŒçš„SMILåŠ¨ç”»ï¼ŒSMILæ˜¯Synchronized Multimedia Integration Languageçš„ç®€ç§°ã€‚å…³äºSVGçš„SMILåŠ¨ç”»ï¼Œè¶…è¿‡äº†æœ¬è¯¾ç¨‹è®¨è®ºçš„èŒƒç•´ï¼Œåœ¨è¿™é‡Œä¸åšè¿›ä¸€æ­¥è®¨è®ºï¼Œåœ¨åç»­ä¸“é—¨è®¨è®ºSVGçš„è¯¾ç¨‹ä¸­ï¼Œä¼šæœ‰æ·±å…¥çš„è®¨è®ºã€‚