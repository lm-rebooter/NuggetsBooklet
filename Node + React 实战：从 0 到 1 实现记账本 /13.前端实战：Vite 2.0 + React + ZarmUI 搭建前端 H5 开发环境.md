## å‰è¨€

`React` æŠ€æœ¯æ ˆçš„ `UI` ç»„ä»¶åº“ç›¸æ¯” `Vue`ï¼Œä¼šå°‘ä¸€äº›ã€‚æˆ‘ä»¬è€³ç†Ÿèƒ½è¯¦çš„ä¾¿æ˜¯ `Antd`ï¼Œä½†æ˜¯å®ƒé’ˆå¯¹çš„æ˜¯ `PC` ç«¯çš„ï¼Œæˆ‘ä»¬çš„é¡¹ç›®ç›®å‰æ˜¯ä¸€ä¸ª `H5` çš„ç½‘é¡µï¼ˆä¸æ’é™¤åæœŸåšä¸€ä¸ª PC ç«¯ï¼‰ã€‚æ‰€ä»¥æˆ‘é€‰æ‹©äº† [Zarm](https:https://zarm.gitee.io/#/)ã€‚

è¿™é‡Œå†æ¬¡å¼ºè°ƒï¼Œä¸æ˜¯ `Zarm` å°±æ¯”åˆ«çš„ç§»åŠ¨ç«¯ç»„ä»¶åº“å¥½ï¼Œåªæ˜¯ç›®å‰æˆ‘å¼€å‘çš„è¿™æ¬¾è®°è´¦æœ¬é¡¹ç›®ï¼Œ`Zarm` æ¯”è¾ƒé€‚åˆã€‚

#### çŸ¥è¯†ç‚¹

- æ„æ¶å·¥å…· `Vite`ã€‚

- å‰ç«¯æ¡†æ¶ `React` å’Œè·¯ç”± `react-router-dom`ã€‚

- `CSS` é¢„åŠ è½½å™¨ `Less`ã€‚

- `HTTP` è¯·æ±‚åº“ `axios`ã€‚

- ç§»åŠ¨ç«¯åˆ†è¾¨ç‡é€‚é… `flexible`ã€‚

- è·¨åŸŸä»£ç†ã€‚

## åˆå§‹åŒ– Vite + React é¡¹ç›®

`Vite` å®˜æ–¹æä¾›ä¸¤ç§åˆå§‹åŒ–é¡¹ç›®çš„æ–¹å¼ï¼Œä¸€ç§æ˜¯å¦‚ä¸‹æ‰€ç¤ºï¼Œå¯ä»¥è‡ªç”±é€‰æ‹©éœ€è¦çš„å‰ç«¯æ¡†æ¶ã€‚

```bash
npm init @vitejs/app
```

å¦ä¸€ç§åˆ™æ˜¯ç›´æ¥ç”¨å®˜æ–¹æä¾›çš„æ¨¡æ¿ï¼Œä¸€é”®ç”Ÿæˆé¡¹ç›®ï¼š

```bash
# npm 6.x
npm init @vitejs/app react-vite-h5 --template react

# npm 7+, éœ€è¦é¢å¤–çš„åŒæ¨ªçº¿ï¼š
npm init @vitejs/app react-vite-h5 -- --template react
```

æˆ‘ä»¬ä½¿ç”¨ç¬¬äºŒç§æ–¹å¼åˆå§‹åŒ–é¡¹ç›®ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/32661c92fce54016949d56b5a57399ba~tplv-k3u1fbpfcp-zoom-1.image)

å®‰è£…å®Œ `node_modules` ä¹‹åï¼Œé€šè¿‡ `npm run dev` å¯åŠ¨é¡¹ç›®ï¼Œå¦‚ä¸‹æ‰€ç¤ºä»£è¡¨æˆåŠŸäº†ï¼š

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/874d34fcf2394af585b2c42a11cef607~tplv-k3u1fbpfcp-zoom-1.image)

## å¼•å…¥è·¯ç”±æ’ä»¶ react-router-dom

æ²¡æœ‰è·¯ç”±çš„é¡¹ç›®ï¼Œé‚£å°±ä¸æ˜¯ä¸€ä¸ªå®Œæ•´é¡¹ç›®ï¼Œè€Œæ˜¯ä¸€ä¸ªé¡µé¢è€Œå·²ã€‚çœŸå®é¡¹ç›®éƒ½æ˜¯å­˜åœ¨å„ç§æ¨¡å—ä¹‹é—´çš„åˆ‡æ¢ï¼Œå„ä¸ªæ¨¡å—çš„åŠŸèƒ½ç»„åˆåœ¨ä¸€èµ·æ‰èƒ½å«åšä¸€ä¸ªé¡¹ç›®ã€‚

é¦–é€‰å®‰è£… `react-router-dom`ï¼ŒæŒ‡ä»¤å¦‚ä¸‹ï¼š

```bash
npm i react-router-dom -S
```

åœ¨é¡¹ç›® `src` ç›®å½•ä¸‹æ–°å¢ `container` ç›®å½•ç”¨äºæ”¾ç½®é¡µé¢ç»„ä»¶ï¼Œå†åœ¨ `container` ä¸‹æ–°å¢ä¸¤ä¸ªç›®å½•åˆ†åˆ«æ˜¯ `Index` å’Œ `About` ï¼Œæ·»åŠ å¦‚ä¸‹å†…å®¹ï¼š

```js
// Index/index.jsx
import React from 'react'

export default function Index() {
  return <div>
    Index
  </div>
}

// About/index.jsx
import React from 'react'

export default function About() {
  return <div>
    About
  </div>
}
```

å†æ¥æ–°å»º `src/router/index.js` é…ç½®è·¯ç”±æ•°ç»„ï¼Œæ·»åŠ å¦‚ä¸‹å†…å®¹ï¼š

```js
// router/index.js
import Index from '../container/Index'
import About from '../container/About'

const routes = [
  {
    path: "/",
    component: Index
  },
  {
    path: "/about",
    component: About
  }
];

export default routes
```

åœ¨ `App.jsx` å¼•å…¥è·¯ç”±é…ç½®ï¼Œå®ç°åˆ‡æ¢æµè§ˆå™¨è·¯å¾„ï¼Œæ˜¾ç¤ºç›¸åº”çš„ç»„ä»¶ï¼š

```js
// App.jsx
import React, { useState } from 'react'
import {
  BrowserRouter as Router,
  Routes,
  Route
} from "react-router-dom"
import routes from '../src/router'
function App() {
  return <>
     <Routes>
      {routes.map(route => <Route exact key={route.path} path={route.path} element={<route.component />} />)}
     </Routes>
   </>
}

export default App
```

å¯åŠ¨é¡¹ç›® `npm run dev`ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d67090d0f61641539e3fcd9061d27474~tplv-k3u1fbpfcp-zoom-1.image)

## å¼•å…¥ Zarm UI ç»„ä»¶åº“

é¦–å…ˆé€šè¿‡å¦‚ä¸‹æŒ‡ä»¤å®‰è£…å®ƒï¼š

```bash
npm install zarm -S
```

ä¿®æ”¹ `App.jsx` çš„ä»£ç ï¼Œå…¨å±€å¼•å…¥æ ·å¼å’Œä¸­æ–‡åŒ…ï¼š

```js
import React, { useState } from 'react'
import {
  BrowserRouter as Router,
  Routes,
  Route
} from "react-router-dom"

import { ConfigProvider } from 'zarm'
import zhCN from 'zarm/lib/config-provider/locale/zh_CN'
import 'zarm/dist/zarm.css'

import routes from '../src/router'
function App() {
  return <Router>
    <ConfigProvider primaryColor={'#007fff'} locale={zhCN}>
      <>
       <Routes>
        {routes.map(route => <Route exact key={route.path} path={route.path} element={<route.component />} />)}
       </Routes>
      </>
    </ConfigProvider>
  </Router>
}

export default App
```

æ­¤æ—¶ `zarm` çš„æ ·å¼ï¼Œå·²ç»å…¨å±€å¼•å…¥äº†ï¼Œæˆ‘ä»¬å…ˆæŸ¥çœ‹åœ¨ `/container/Index/index.jsx` æ·»åŠ ä¸€ä¸ªæŒ‰é’®æ˜¯å¦ç”Ÿæ•ˆï¼š

```js
// Index/index.jsx
import React from 'react'
import { Button } from 'zarm'

export default function Index() {
  return <div>
    Index
    <Button theme='primary'>æŒ‰é’®</Button>
  </div>
}
```

é‡å¯é¡¹ç›®ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5196fda769074ec387a085af87b6bb92~tplv-k3u1fbpfcp-zoom-1.image)

æ­¤æ—¶æ­å–œä½ ğŸ‰ï¼Œä½ å·²ç»æˆåŠŸå°†ç»„ä»¶å¼•å…¥é¡¹ç›®ä¸­ã€‚

#### å°ä¼˜åŒ–

ç»„ä»¶è™½ç„¶å¼•å…¥æˆåŠŸäº†ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œæˆ‘ä¸å¸Œæœ›æ‰€æœ‰çš„ç»„ä»¶æ ·å¼éƒ½è¢«ä¸€æ¬¡æ€§çš„å¼•å…¥ï¼Œå› ä¸ºè¿™æ ·ä»£ç ä¼šæ¯”è¾ƒå†—ä½™ï¼Œæˆ‘åªéœ€è¦å¼•å…¥æˆ‘ä½¿ç”¨åˆ°çš„ç»„ä»¶æ ·å¼ï¼Œå®ç°ã€ŒæŒ‰éœ€å¼•å…¥ã€ã€‚

æˆ‘ä»¬å…ˆçœ‹çœ‹ï¼Œå°±ç›®å‰ç°åœ¨è¿™ä¸ªæƒ…å†µï¼Œæ‰“å®ŒåŒ…ä¹‹åï¼Œé™æ€èµ„æºæœ‰å¤šå¤§ã€‚è¿è¡ŒæŒ‡ä»¤ `npm run build` ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ba361939748e48499cab35833093c012~tplv-k3u1fbpfcp-zoom-1.image)

è…šçœ¼ä¸€çœ‹ï¼Œå…¨å±€å¼•å…¥æ ·å¼çš„å½¢å¼ï¼Œç›´æ¥æ‰“å®ŒåŒ…ï¼Œ `css` é™æ€èµ„æºå°± `168.22kb` äº†ï¼Œæˆ‘ä»¬å°è¯•é…ç½®ã€ŒæŒ‰éœ€å¼•å…¥ã€ã€‚

é¦–å…ˆæˆ‘ä»¬å®‰è£…ä¸€ä¸ªæ’ä»¶ï¼š

```bash
npm i vite-plugin-style-import -D
```

ç„¶ååœ¨ `vite.config.js` é…ç½®æ–‡ä»¶å†…æ·»åŠ å¦‚ä¸‹å†…å®¹ï¼š

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/cd0314c0446e4654bfcc73e3dee44291~tplv-k3u1fbpfcp-zoom-1.image)

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7bcf00b0cb0c4293a2daf92bef93f451~tplv-k3u1fbpfcp-zoom-1.image)

æ‰“å®ŒåŒ…ä¹‹åï¼Œè‚‰çœ¼å¯è§ï¼Œ`css` æåŠä» `168.22kb` -> `35.22kb`ã€‚è¿™ç§æ–¹å¼ä¹Ÿæ˜¯å‰ç«¯æ€§èƒ½ä¼˜åŒ–çš„å…¶ä¸­ä¸€ç§ã€‚

## é…ç½® CSS é¢„å¤„ç†å™¨ Less

é¡¹ç›®ä¸­é‡‡ç”¨çš„ `Less` ä½œä¸º `CSS` é¢„å¤„ç†å™¨ï¼Œå®ƒèƒ½è®¾ç½®å˜é‡ä»¥åŠä¸€äº›åµŒå¥—é€»è¾‘ï¼Œä¾¿äºé¡¹ç›®çš„æ ·å¼ç¼–å†™ã€‚

å®‰è£… `less` æ’ä»¶åŒ…ï¼Œ`npm i less -D`ï¼Œå› ä¸ºä¸Šè¿°é…ç½®æˆ‘ä»¬ä½¿ç”¨çš„æ˜¯ `less`ï¼Œå¹¶ä¸”æˆ‘ä»¬éœ€è¦é…ç½® `javascriptEnabled ä¸º true`ï¼Œæ”¯æŒ `less` å†…è” `JS`ã€‚

ä¿®æ”¹ `vite.config.js`ï¼Œå¦‚ä¸‹ï¼š

```js
{
  plugins: [...]
  css: {
    modules: {
      localsConvention: 'dashesOnly'
    },
    preprocessorOptions: {
      less: {
        // æ”¯æŒå†…è” JavaScript
        javascriptEnabled: true,
      }
    }
  },
}
```

å¹¶ä¸”æ·»åŠ äº† `css modules` é…ç½®ï¼Œè¿™æ ·æˆ‘ä»¬å°±ä¸ç”¨æ‹…å¿ƒåœ¨é¡¹ç›®ä¸­ï¼Œè‡ªå®šä¹‰çš„æ ·å¼é‡åçš„é£é™©ï¼Œæˆ‘ä»¬å°è¯•åœ¨ `/container/Index` ç›®å½•ä¸‹æ·»åŠ æ ·å¼æ–‡ä»¶ `style.module.less`ï¼Œå¹¶ä¸”åœ¨ `/container/Index/index.jsx` ä¸­å¼•å…¥å®ƒï¼Œå¦‚ä¸‹ï¼š

```css
.index {
  span {
    color: red;
  }
}
```

```js
// Index/index.jsx
import React from 'react'
import { Button } from 'zarm'

import s from './style.module.less'

export default function Index() {
  return <div className={s.index}>
    <span>æ ·å¼</span>
    <Button theme='primary'>æŒ‰é’®</Button>
  </div>
}
```

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8866be0be4824492b94297eea2eb4ca3~tplv-k3u1fbpfcp-zoom-1.image)

æ­¤æ—¶æˆ‘åªèƒ½å†æ¬¡æ­å–œä½ ï¼Œ`Less` æˆåŠŸè¢«å¼•å…¥ã€‚

## ç§»åŠ¨ç«¯é¡¹ç›®é€‚é… rem

ç§»åŠ¨ç«¯é¡¹ç›®ï¼Œè‚¯å®šæ˜¯éœ€è¦é€‚é…å„ç§åˆ†è¾¨ç‡å±å¹•çš„ï¼Œå°±æ¯”å¦‚ä½  10px çš„å®½åº¦ï¼Œåœ¨æ¯ä¸ªå±å¹•ä¸Šçš„å æ¯”éƒ½æ˜¯ä¸ä¸€æ ·çš„ï¼Œæˆ‘ä»¬è¿™é‡Œä¸å¯¹åˆ†è¾¨ç‡åšæ·±å…¥çš„æ¢è®¨ï¼Œæˆ‘ä»¬ç›®å‰çš„é¦–è¦ç›®çš„æ˜¯å®Œæˆé¡¹ç›®ç§»åŠ¨ç«¯çš„åˆ†è¾¨ç‡é€‚é…ã€‚

é¦–å…ˆæˆ‘ä»¬éœ€è¦å®‰è£… `lib-flexible`ï¼š

```bash
npm i lib-flexible -S
```

å¹¶åœ¨ `main.jsx` ä¸­å¼•å…¥å®ƒï¼š

```js
import React from 'react'
import ReactDOM from 'react-dom'
import 'lib-flexible/flexible'
import './index.css'
import App from './App'

ReactDOM.render(
  <React.StrictMode>
    <App />
  </React.StrictMode>,
  document.getElementById('root')
)
```

ç„¶åå†å®‰è£…ä¸€ä¸ª `postcss-pxtorem`ï¼Œå®ƒçš„ä½œç”¨æ˜¯åœ¨ä½ ç¼–å†™å®Œ `css` åï¼Œå°†ä½ çš„å•ä½è‡ªåŠ¨è½¬åŒ–ä¸º `rem` å•ä½ã€‚

```bash
npm i postcss-pxtorem
```

åœ¨é¡¹ç›®æ ¹ç›®å½•æ–°å»º `postcss.config.js`ï¼š

```js
// postcss.config.js
// ç”¨ vite åˆ›å»ºé¡¹ç›®ï¼Œé…ç½® postcss éœ€è¦ä½¿ç”¨ post.config.jsï¼Œä¹‹å‰ä½¿ç”¨çš„ .postcssrc.js å·²ç»è¢«æŠ›å¼ƒ
// å…·ä½“é…ç½®å¯ä»¥å» postcss-pxtorem ä»“åº“çœ‹çœ‹æ–‡æ¡£
module.exports = {
  "plugins": [
    require("postcss-pxtorem")({
      rootValue: 37.5,
      propList: ['*'],
      selectorBlackList: ['.norem'] // è¿‡æ»¤æ‰.norem-å¼€å¤´çš„classï¼Œä¸è¿›è¡Œremè½¬æ¢
    })
  ]
}
```

ä¿®æ”¹ `Index/style.module.less`ï¼š

```css
.index {
  width: 200px;
  height: 200px;
  background: green;
  span {
    color: red;
  }
}
```

é‡å¯é¡¹ç›® `npm run dev`ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/28c6f12ba2c446ef9f374f878636c1f0~tplv-k3u1fbpfcp-zoom-1.image)

å¯ä»¥çœ‹åˆ°ï¼Œ`200px` å·²ç»è¢«è½¬åŒ–ä¸º `5.3333rem`ï¼Œæˆ‘ä»¬è®¾ç½®çš„ `rootValue` æ˜¯ `37.5`ï¼Œä½ å¯ä»¥æ¢ç®—ä¸€ä¸‹ `5.33333 * 37.5 = 200`ã€‚

æˆ‘ä»¬ç›®å‰æŠŠæµè§ˆå™¨è°ƒæ•´æˆçš„æ˜¯ `iphone 6`ï¼Œ`html` çš„ `font-size` ä¸º `37.5px`ï¼Œå½“æˆ‘ä»¬æ‰‹æœºå˜æˆå…¶ä»–å°ºå¯¸çš„æ—¶å€™ï¼Œè¿™ä¸ª `font-size` çš„å€¼ä¹Ÿä¼šå˜åŒ–ï¼Œè¿™æ˜¯ `flexible` èµ·åˆ°çš„ä½œç”¨ï¼ŒåŠ¨æ€çš„å˜åŒ– `html` çš„ `font-size` çš„å€¼ï¼Œä»è€Œè®© `1rem` æ‰€å¯¹åº”çš„  `px` å€¼ä¸€ç›´éƒ½æ˜¯åŠ¨æ€é€‚åº”å˜åŒ–çš„ã€‚

å½“æˆ‘åˆ‡æ¢æˆ `iphone 6 plus` æ—¶ï¼š

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b787a8e1e96d4db58622c23d89592954~tplv-k3u1fbpfcp-zoom-1.image)

å˜æˆäº† `41.4px`ï¼Œè€Œç›¸åº”çš„ï¼Œæˆ‘ä»¬ `div` è¿˜æ˜¯ `5.33333rem`ï¼Œæ‰€ä»¥æ­¤æ—¶ `div` å®½åº¦å°±å˜å¤§äº†ï¼Œä½†æ˜¯æ‰‹æœºçš„å±å¹•å®½åº¦ä¹Ÿå˜å¤§äº†ï¼Œè¿™å°±ä¸ä¼šå½±å“è§†è§‰ä¸Šçš„æ¯”ä¾‹è¯¯å·®å¤ªå¤§ã€‚

## äºŒæ¬¡å°è£… axios

è¯´åˆ°è¿™é‡Œï¼Œé‚£å°±è¦æ¶‰åŠåˆ°é¡¹ç›®çš„æœåŠ¡ç«¯ `API` æ¥å£ï¼Œæˆ‘ä»¬åœ¨å‰é¢çš„ç« èŠ‚é‡Œï¼Œå·²ç»å®Œæˆäº†æœåŠ¡ç«¯çš„ä»£ç ç¼–å†™ï¼Œä½†æ˜¯æ­¤æ—¶æˆ‘ä»¬çš„æœåŠ¡ç«¯é¡¹ç›®æ˜¯è·‘åœ¨ `http://127.0.0.1/7001` ç«¯å£ä¸Šçš„ã€‚

æ­¤æ—¶ä½ æ˜¯å¯ä»¥åœ¨åç»­çš„è¯·æ±‚ä¸­ï¼Œä½¿ç”¨ `http://127.0.0.1/7001` ä½œä¸ºé¡¹ç›®çš„ `baseURL`ã€‚ä½†æ˜¯ç…§é¡¾åˆ°æœ‰äº›åŒå­¦æ²¡æœ‰å¯åŠ¨æœåŠ¡ç«¯é¡¹ç›®ï¼Œç›´å¥”å‰ç«¯é¡¹ç›®æ¥çš„ã€‚è¿™é‡Œæˆ‘å·²ç»å°†æ¥å£æå‰éƒ¨ç½²åˆ°äº†çº¿ä¸Šç¯å¢ƒï¼Œä¾›å¤§å®¶ä½¿ç”¨ã€‚æ¥å£åœ°å€æ˜¯ `http://api.chennick.wang`ã€‚

æ‰€ä»¥åœ¨åç»­çš„å°è£…è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä¼šæé†’å¤§å®¶ä¸¤ç§ä½¿ç”¨ã€‚

é¦–å…ˆæˆ‘ä»¬å®‰è£… `npm i axios -S`ï¼Œåœ¨ `src` ç›®å½•ä¸‹æ–°å»º `utils` ç›®å½•ï¼Œå¹¶æ–°å»º `axios.js` è„šæœ¬ï¼š

```js
// src/utils/axios.js
import axios from 'axios'
import { Toast } from 'zarm'

const MODE = import.meta.env.MODE // ç¯å¢ƒå˜é‡

axios.defaults.baseURL = MODE == 'development' ? '/api' : 'http://api.chennick.wang'
axios.defaults.withCredentials = true
axios.defaults.headers['X-Requested-With'] = 'XMLHttpRequest'
axios.defaults.headers['Authorization'] = `${localStorage.getItem('token') || null}`
axios.defaults.headers.post['Content-Type'] = 'application/json'

axios.interceptors.response.use(res => {
  if (typeof res.data !== 'object') {
    Toast.show('æœåŠ¡ç«¯å¼‚å¸¸ï¼')
    return Promise.reject(res)
  }
  if (res.data.code != 200) {
    if (res.data.msg) Toast.show(res.data.msg)
    if (res.data.code == 401) {
      window.location.href = '/login'
    }
    return Promise.reject(res.data)
  }

  return res.data
})

export default axios
```

æˆ‘é€è¡Œä¸ºå¤§å®¶åˆ†æä¸Šè¿°ä»£ç çš„æƒ…å†µæƒ…å†µã€‚

```js
const MODE = import.meta.env.MODE
```

`MODE` æ˜¯ä¸€ä¸ªç¯å¢ƒå˜é‡ï¼Œé€šè¿‡ `Vite` æ„å»ºçš„é¡¹ç›®ä¸­ï¼Œç¯å¢ƒå˜é‡åœ¨é¡¹ç›®ä¸­ï¼Œå¯ä»¥é€šè¿‡ `import.meta.env.MODE` è·å–ï¼Œç¯å¢ƒå˜é‡çš„ä½œç”¨å°±æ˜¯åˆ¤æ–­å½“å‰ä»£ç è¿è¡Œåœ¨å¼€å‘ç¯å¢ƒè¿˜æ˜¯ç”Ÿäº§ç¯å¢ƒã€‚

```js
axios.defaults.baseURL = 'development' ? '/api' : 'http://api.chennick.wang'
```

`baseURL` æ˜¯ `axios` çš„é…ç½®é¡¹ï¼Œå®ƒçš„ä½œç”¨å°±æ˜¯è®¾ç½®è¯·æ±‚çš„åŸºç¡€è·¯å¾„ï¼Œåç»­æˆ‘ä»¬ä¼šåœ¨é¡¹ç›®å®æˆ˜ä¸­æœ‰æ‰€ä½“ç°ã€‚é…ç½®åŸºç¡€è·¯å¾„çš„å¥½å¤„å°±æ˜¯ï¼Œå½“è¯·æ±‚åœ°å€ä¿®æ”¹çš„æ—¶å€™ï¼Œå¯ä»¥åœ¨æ­¤ç»Ÿä¸€é…ç½®ã€‚

```js
axios.defaults.headers['X-Requested-With'] = 'XMLHttpRequest'
axios.defaults.headers['Authorization'] = `${localStorage.getItem('token') || null}`
axios.defaults.headers.post['Content-Type'] = 'application/json'
```

ä¸Šè¿°ä¸‰ä¸ªé…ç½®æ˜¯ç”¨äºè¯·æ±‚å¤´çš„è®¾ç½®ï¼Œ`Authorization` æ˜¯æˆ‘ä»¬åœ¨æœåŠ¡ç«¯é‰´æƒçš„æ—¶å€™ç”¨åˆ°çš„ï¼Œæˆ‘ä»¬åœ¨å‰ç«¯è®¾ç½®å¥½ `token`ï¼ŒæœåŠ¡ç«¯é€šè¿‡è·å–è¯·æ±‚å¤´ä¸­çš„  `token` å»éªŒè¯æ¯ä¸€æ¬¡è¯·æ±‚æ˜¯å¦åˆæ³•ã€‚

æœ€åä¸€è¡Œæ˜¯é…ç½® `post` è¯·æ±‚æ˜¯ï¼Œä½¿ç”¨çš„è¯·æ±‚ä½“ï¼Œè¿™é‡Œé»˜è®¤è®¾ç½®æˆ `application/json` çš„å½¢å¼ã€‚

```js
axios.interceptors.response.use(res => {
  if (typeof res.data !== 'object') {
    Toast.show('æœåŠ¡ç«¯å¼‚å¸¸ï¼')
    return Promise.reject(res)
  }
  if (res.data.code != 200) {
    if (res.data.msg) Toast.show(res.data.msg)
    if (res.data.code == 401) {
      window.location.href = '/login'
    }
    return Promise.reject(res.data)
  }

  return res.data
})
```

`interceptors` ä¸ºæ‹¦æˆªå™¨ï¼Œæ‹¦æˆªå™¨çš„ä½œç”¨æ˜¯å¸®ä½ æ‹¦æˆªæ¯ä¸€æ¬¡è¯·æ±‚ï¼Œä½ å¯ä»¥åœ¨å›è°ƒå‡½æ•°ä¸­åšä¸€äº›â€œæ‰‹è„šâ€ï¼Œå†å°†æ•°æ® `return` å›å»ã€‚ä¸Šè¿°ä»£ç å°±æ˜¯æ‹¦æˆªäº†å“åº”å†…å®¹ï¼Œç»Ÿä¸€åˆ¤æ–­è¯·æ±‚å†…å®¹ï¼Œå¦‚æœé 200ï¼Œåˆ™æç¤ºé”™è¯¯ä¿¡æ¯ï¼Œ`401` çš„è¯ï¼Œå°±æ˜¯æ²¡æœ‰ç™»å½•çš„ç”¨æˆ·ï¼Œé»˜è®¤è·³åˆ° `/login` é¡µé¢ã€‚å¦‚æœæ˜¯æ­£å¸¸çš„å“åº”ï¼Œåˆ™ `retrun res.data`ã€‚

æœ€åæˆ‘ä»¬å°†è¿™ä¸ª `axios` æŠ›å‡ºï¼Œä¾›é¡µé¢ç»„ä»¶è¯·æ±‚ä½¿ç”¨ã€‚

åœ¨ `utils` ä¸‹æ–°å»ºä¸€ä¸ª `index.js`ï¼Œå†…å®¹å¦‚ä¸‹ï¼š

```js
import axios from './axios'

export const get = axios.get

export const post = axios.post
```

è¿™æ ·è·å–çš„æ—¶å€™ï¼Œèƒ½å°‘å†™å‡ è¡Œä»£ç ï¼Œèƒ½å°‘å†™ç‚¹å°±å°‘å†™ç‚¹ã€‚

## ä»£ç†é…ç½®

`baseURL` ä¸ºä»€ä¹ˆåœ¨ `development` ç¯å¢ƒä¸‹ï¼Œç”¨ `/api` è¿™æ ·çš„è¯·æ±‚åœ°å€ã€‚å…¶å®å®ƒå°±æ˜¯ä¸ºäº†ä»£ç†è¯·æ±‚è€Œé…ç½®çš„ã€‚

è¿™æ ·é…ç½®å®Œåï¼Œåœ¨è¯·æ±‚æ¥å£çš„æ—¶å€™ï¼Œè¯·æ±‚åœ°å€å¤§æ¦‚é•¿è¿™æ ·ï¼š

```js
/api/userInfo
```

äºæ˜¯æˆ‘ä»¬éœ€è¦å»é…ç½®ä»£ç†ï¼Œæ‰“å¼€ `vite.config.js`ï¼Œæ·»åŠ å¦‚ä¸‹ä»£ç ï¼š

```js
server: {
  proxy: {
    '/api': {
      // å½“é‡åˆ° /api è·¯å¾„æ—¶ï¼Œå°†å…¶è½¬æ¢æˆ target çš„å€¼
      target: 'http://api.chennick.wang/api/',
      changeOrigin: true,
      rewrite: path => path.replace(/^\/api/, '') // å°† /api é‡å†™ä¸ºç©º
    }
  }
}
```

è¿™æ ·é…ç½®å®Œä¹‹åï¼Œå¼€å‘ç¯å¢ƒä¸‹ï¼Œ`/api/userInfo` -> `http://api.chennick.wang/api/userInfo`ã€‚è¿™æ ·å°±è§£å†³äº†å¤§å®¶è€å¤§éš¾çš„è·¨åŸŸé—®é¢˜ã€‚

ä½†æ˜¯å…¶å®æœåŠ¡ç«¯åªè¦è®¾ç½®å¥½ç™½åå•ï¼Œå°±ä¸ä¼šæœ‰è¿™æ ·é‚£æ ·çš„è·¨åŸŸé—®é¢˜ã€‚

## resolve.alias åˆ«åè®¾ç½®

è¿™é‡Œæˆ‘ä»¬å¿…é¡»å¾—è®¾ç½®å¥½åˆ«åï¼Œå¦åˆ™åœ¨é¡µé¢ä¸­ï¼Œä½ ä¼šå†™å‡ºå¾ˆé•¿ä¸€ä¸²ç±»ä¼¼è¿™æ ·çš„ä»£ç  `../../../`ã€‚

æ‰“å¼€ `vite.config.js`ï¼Œæ·»åŠ é…ç½®å¦‚ä¸‹ï¼š

```js
...
import path from 'path'

export default defineConfig({
  ...
  resolve: {
    alias: {
      '@': path.resolve(__dirname, 'src'), // src è·¯å¾„
      'utils': path.resolve(__dirname, 'src/utils') // src è·¯å¾„
    }
  },
})
```

æ­¤æ—¶æˆ‘ä»¬ä¾¿å¯ä»¥ä¿®æ”¹ä¹‹å‰çš„ä»£ç å¦‚ä¸‹ï¼š

**router/index.js**

```js
import Index from '@/container/Index'
import About from '@/container/About'
```

**App.jsx**

```js
import routes from '@/router'
```

## æ€»ç»“

è¡Œæ–‡è‡³æ­¤ï¼Œæˆ‘ä»¬çš„åŸºç¡€å¼€å‘ç¯å¢ƒå·²ç»æ­å»ºå®Œæ¯•ï¼Œæ¶‰åŠæ„å»ºå·¥å…·ã€å‰ç«¯æ¡†æ¶ã€`UI` ç»„ä»¶åº“ã€`HTTP` è¯·æ±‚åº“ã€`CSS` é¢„åŠ è½½å™¨ã€è·¨åŸŸä»£ç†ã€ç§»åŠ¨ç«¯åˆ†è¾¨ç‡é€‚é…ï¼Œè¿™äº›çŸ¥è¯†éƒ½æ˜¯ä¸€ä¸ªåˆæ ¼çš„å‰ç«¯å·¥ç¨‹å¸ˆåº”è¯¥å…·å¤‡çš„ï¼Œæ‰€ä»¥è¯·å¤§å®¶åŠ æ²¹ï¼Œå°†ä»–ä»¬éƒ½é€šé€šæ‹¿ä¸‹ã€‚
