## å‰è¨€

ä¸Šä¸€ç« èŠ‚ï¼Œæˆ‘ä»¬å®Œæˆäº†æ•°æ®çš„å½•å…¥ä¸å±•ç¤ºï¼Œæ¥ä¸‹æ¥åˆ°äº†å¹³å°åº”ç”¨ç”Ÿæ­»å…³é”®æ—¶åˆ»ï¼š**å¦‚ä½•å°†æˆ‘ä»¬ç½‘é¡µä¸­å†™å¥½çš„ç®€å†æ¨¡ç‰ˆå¯¼å‡ºæˆ PDF**ï¼Œæ¯•ç«Ÿä¸èƒ½ä¸ºæˆ‘ä»¬æ‰€ç”¨ï¼Œé‚£ä¹ˆè¿™ä¸ªå¹³å°å°†æ²¡æœ‰ä»»ä½•çš„ä½¿ç”¨ä»·å€¼ã€‚

> å¦‚æœå¯¹è¿™å—ç†Ÿæ‚‰çš„åŒå­¦ï¼Œæœ¬ç« å¯ä»¥å¿«é€Ÿé˜…è¯»æˆ–è·³è¿‡ï¼Œå¦‚æœå¯¹å¯¼å‡º PDF æ„Ÿå…´è¶£ä¸”ä¸ç†Ÿæ‚‰çš„åŒå­¦ï¼Œå¸Œæœ›æœ¬ç« èŠ‚å¯ä»¥ç»™ä½ ä¸€äº›å¯å‘ã€‚

## å¯¼å‡º PDF

åœ¨å‰ç«¯å°† HTML ç½‘é¡µè½¬æˆ PDF æœ‰å¤šç§æ–¹å¼ï¼Œä¾‹å¦‚ï¼š

1. ç”Ÿæˆå›¾ç‰‡å†è½¬ PDFï¼šhtml2canvas + jsPdf
2. ä½¿ç”¨ pdfmake å®ç° PDF çš„å¯¼å‡º

å½“ç„¶è¿˜æœ‰è®¸å¤šæ–¹æ³•å¯ä»¥å®ç° html è½¬ pdfï¼Œåœ¨æ­¤é¡¹ç›®ä¸­ï¼Œä¸»è¦è®¨è®ºè¿™ä¸¤ç§æ–¹æ³•çš„ä¼˜ç¼ºç‚¹

### html2canvas + jspdf

[jsPdf](https://github.com/MrRio/jsPDF) æ˜¯ä¸€ä¸ªå°† html è½¬ pdf çš„æ’ä»¶ï¼Œç›®å‰åœ¨ github ä¸Šæ‹¥æœ‰ 22.1k çš„ starï¼Œä»æ•°æ®ä¸Šæ¥çœ‹ï¼Œè¿˜æ˜¯æ¯”è¾ƒå—æ¬¢è¿çš„ï¼Œä½†è¯¥åº“ä½œè€…æ˜¯ä¸ªå¤–å›½äººï¼Œå¹¶æœªæ”¯æŒå›½é™…åŒ–ï¼Œæ‰€ä»¥å¦‚æœå†…å®¹æ–¹é¢æ˜¯ä¸­æ–‡è¯­è¨€ï¼Œå¯¼å‡ºå°±æœ‰é—®é¢˜ã€‚

æ²¡åŠæ³•ï¼Œæˆ‘ä»¬åªèƒ½æ›²çº¿æ•‘å›½ï¼Œæ¢ç§æ–¹å¼å®ç°ï¼Œç”±äº jsPdf æä¾›ä¸€ä¸ª APIï¼Œå«åš `addImage`ï¼Œæˆ‘ä»¬ä¸ç¦æ€è€ƒï¼Œèƒ½å¦ å°† html é¡µé¢ï¼Œå˜æˆä¸€å¼ å›¾ç‰‡ï¼Ÿæ¢ç§è¯´æ³•ï¼Œæˆ‘ä»¬èƒ½å¦å°† html è½¬æˆ canvasï¼Ÿå†é€šè¿‡ canvas æä¾›çš„ toDataURL API å¾—åˆ°ä¸€å¼  base64 ç¼–ç çš„ dataURL å‘¢ï¼Ÿ

è¦å®ç° html è½¬ canvasï¼Œç›®å‰ç›¸å¯¹çƒ­é—¨çš„æ˜¯ [html2canvas](https://github.com/niklasvh/html2canvas) ï¼Œè¯¥åº“ç›®å‰è¿˜åœ¨ç»´æŠ¤ï¼Œå¹¶ä¸” github ä¸Šä¹Ÿæ‹¥æœ‰ 23.5k çš„ starã€‚é€šè¿‡ html2canvas ç»“åˆ jspdfï¼Œå°±èƒ½è½»æ¾å®ç°æˆ‘ä»¬çš„åŠŸèƒ½ã€‚

- ä¼˜ç‚¹ï¼šå¯¹æˆ‘è€Œè¨€ï¼Œç®€å•ä¸Šæ‰‹ï¼Œå¹¶ä¸”ç½‘ä¸Šå¤§éƒ¨åˆ†éƒ½é‡‡ç”¨æ­¤æ–¹å¼å®ç°ï¼Œé‡åˆ°é—®é¢˜ä¹Ÿèƒ½å¿«é€Ÿå“åº”
- ç¼ºç‚¹ï¼šjsPdf å¯¹ä¸­æ–‡æ”¯æŒä¸å¤Ÿå‹å¥½ï¼Œhtml2canvas è½¬å›¾ç‰‡åå¯èƒ½å‡ºç°æ¨¡ç³Šï¼Œéœ€è¦å®šä½è§£å†³ã€‚å¯¼å‡ºçš„ PDF ä¸­æ–‡å­—æ— æ³•å¤åˆ¶ã€ä¿®æ”¹ç­‰ï¼Œå› ä¸ºå®ƒæœ¬è´¨å°±æ˜¯ä¸€å¼ å›¾ç‰‡

### pdfmake

ç›®å‰åœ¨ GitHub ä¸Šæ‹¥æœ‰ 9.2k çš„ starï¼Œä»æ•°æ®ä¸Šçœ‹ï¼Œä¹Ÿç®—å¾ˆå¤šäººä½¿ç”¨äº†ã€‚è¯¥åº“çš„äº®ç‚¹åœ¨äºæ”¯æŒä¸­æ–‡å†…å®¹ï¼Œæ—¢ç„¶èƒ½æ”¯æŒä¸­æ–‡å†…å®¹ï¼Œæˆ‘ä»¬å°±ä¸éœ€è¦å°† html è½¬æˆ canvas äº†ã€‚

- ä¼˜ç‚¹ï¼šæ”¯æŒä¸­æ–‡å†…å®¹ï¼Œæ”¯æŒä¸åç«¯äº¤äº’ï¼Œå®˜æ–¹è¡¨ç¤ºä¸Šæ‰‹ç®€å•
- ç¼ºç‚¹ï¼šå¹¶æœªä½¿ç”¨è¿‡ï¼Œå¯èƒ½å­˜åœ¨æœªçŸ¥å‘

### äºŒé€‰ä¸€

ä¸¤ç§æ–¹æ¡ˆå„æœ‰ä¼˜ç‚¹ï¼Œåªæ˜¯åœ¨é€‰æ‹©ä¸Šï¼Œæˆ‘ä»¬éœ€è¦è€ƒè™‘å…¶ä»–çš„æˆæœ¬ï¼Œå¦‚ä½¿ç”¨æˆæœ¬ã€ä¸šåŠ¡åœºæ™¯ç­‰ã€‚

å¯¹äº pdfmake æˆ‘å¬è¿‡ï¼Œä½†æœªå®é™…ä½¿ç”¨è¿‡ï¼Œå¯é¢„çŸ¥çš„æ˜¯æˆ‘å¹¶ä¸çŸ¥é“ä¼šå­˜åœ¨ä»€ä¹ˆå‘éœ€è¦æˆ‘å»å¡«ï¼Œæ‰€ä»¥åœ¨æ—¶é—´æˆæœ¬è€ƒè™‘ä¸Šï¼Œæˆ‘ä¼šä¼˜å…ˆé€‰æ‹©ç¬¬ä¸€ç§ï¼›å¯¹äºä¸šåŠ¡åœºæ™¯æ¥è®²ï¼Œå¯¼å‡º pdf ä¹‹åï¼Œå¦‚æœå‘ç°æœ‰é”™åˆ«å­—ï¼Œå†…å®¹è¾“å…¥æœ‰è¯¯ç­‰ï¼Œåªéœ€è¦å°†å†…å®¹æ›´æ­£ï¼Œå†ç‚¹å‡»ä¸€ä¸ªâ€œå¯¼å‡ºâ€æŒ‰é’®å³å¯ï¼Œç›¸æ¯”ç›´æ¥åœ¨ pdf ä¸­æ›´æ­£å†…å®¹ï¼Œè²Œä¼¼å°±å¤šäº†ä¸ªç‚¹å‡»æŒ‰é’®æ“ä½œã€‚æˆ‘æƒ³è¿™ä¹Ÿåˆä¹æƒ…ç†ï¼Œä¸ºäº†çœç•¥ä¸€æ­¥éª¤å»æŠ˜è…¾ pdfmakeï¼Œæ˜¯å¦çœŸçš„æœ‰å¿…è¦ï¼Ÿ

æœ€ç»ˆé‡‡ç”¨æ–¹æ¡ˆä¸€ï¼šhtml2canvas + jsPdf å®ç°ï¼Œ**å½“ç„¶ä¸å–œè¯¥æ–¹æ¡ˆçš„å°ä¼™ä¼´å¯ä»¥ç§ä¸‹è‡ªè¡Œé‡‡ç”¨å…¶ä»–æ–¹æ¡ˆå“ˆ**

### ä»£ç å®ç°

æˆ‘ä»¬è¿›å…¥ /common/utils æ–‡ä»¶å¤¹ä¸‹ï¼Œæ–°å¢ htmlToPdf.ts æ–‡ä»¶ï¼Œç¼–å†™æˆ‘ä»¬çš„å¯¼å‡ºé€»è¾‘

```ts
// app/renderer/common/utils/htmlToPdf.ts
import JsPdf from 'jspdf';
import html2canvas from 'html2canvas';
const A4Width = 592.28;
const A4Height = 841.89;

/**
 * @description å¯¼å‡ºPDFæ–‡ä»¶ï¼Œæš‚æ—¶æ”¯æŒå•é¡µ
 * @param {string} resumeName å¯¼å‡ºæ–‡ä»¶å
 */
export function toPrintPdf(resumeName?: string) {
  let name = resumeName || 'æœªå‘½åæ–‡ä»¶';
  // ğŸ‘‡ è®°ä½æ¯ä¸ªæ¨¡ç‰ˆéƒ½éœ€è¦åœ¨æ ¹å®¹å™¨ç»„ä»¶æ·»åŠ  id
  const dom: HTMLElement | any = document.querySelector('#visPdf');
  if (dom) {
    html2canvas(dom, {
      allowTaint: true,
    }).then((canvas) => {
      let contentWidth = canvas.width;
      let contentHeight = canvas.height;
      // ä¸€é¡µpdfæ˜¾ç¤ºhtmlé¡µé¢ç”Ÿæˆçš„canvasé«˜åº¦ï¼Œç­‰æ¯”ç¼©æ”¾
      let pageHeight = (contentWidth / A4Width) * A4Height;
      let leftHeight = contentHeight;
      // é¡µé¢åç§»
      let position = 0;
      let imgWidth = A4Width;
      let imgHeight = (A4Width / contentWidth) * contentHeight;
      let pageData = canvas.toDataURL('image/jpeg', 1.0);
      // è¿™é‡Œçš„ç¬¬ä¸€ä¸ªå‚æ•°è¡¨ç¤ºæ–¹å‘ï¼Œè¿™é‡Œä¸€å®šè¦é€‰æ‹© portrait
      // å…·ä½“å¯çœ‹æ–‡æ¡£ https://artskydj.github.io/jsPDF/docs/jsPDF.html
      let PDF = new JsPdf('portrait', 'pt', 'a4');
      if (leftHeight < pageHeight) {
        PDF.addImage(pageData, 'JPEG', 0, 0, imgWidth, imgHeight);
      } else {
        while (leftHeight > 0) {
          PDF.addImage(pageData, 'JPEG', 0, position, imgWidth, imgHeight);
          leftHeight -= pageHeight;
          position -= A4Height;
          if (leftHeight > 0) {
            PDF.addPage();
          }
        }
      }
      PDF.save(name + '.pdf');
    });
  }
}
```

åœ¨ä¸šåŠ¡ä½¿ç”¨æ—¶ï¼Œå°±åªéœ€è¦è°ƒç”¨æ­¤æ–¹æ³•å³å¯

```ts
import { toPrintPdf } from '@common/utils/htmlToPdf';

function ResumeAction() {
  const base: TSResume.Base = useSelector((state: any) => state.resumeModel.base);
  const work: TSResume.Work = useSelector((state: any) => state.resumeModel.work);

  // å¯¼å‡ºPDFï¼Œæ ¼å¼ä¸ºï¼šå§“å+å­¦æ ¡+å²—ä½
  const onExport = () => {
    toPrintPdf(`${base?.username}+${base?.school}+${work?.job}`);
  };

  return (
    <div styleName="actions">
      <MyButton size="middle" className="export-btn" onClick={onExport}>
        å¯¼å‡ºPDF
      </MyButton>
    </div>
  );
}
```

### æ•ˆæœ

![image.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/67ff89845e5f40f09cf955f4992ce09d~tplv-k3u1fbpfcp-watermark.image)

å¯¼å‡ºä¹‹åï¼Œå›¾ç‰‡æ¸…æ™°åº¦ä¹Ÿèƒ½æ¥å—

![image.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/53032aceb593487ebfd3ab9484a35706~tplv-k3u1fbpfcp-watermark.image)

## æ€»ç»“

æœ¬ç« èŠ‚ä¸»è¦ä»¥å¯¼å‡º PDF åŠŸèƒ½ä¸ºä¸»ï¼Œåˆ†æä¸¤ç§è§£å†³æ–¹æ¡ˆï¼Œåœ¨æ—¶é—´æˆæœ¬ä¸ä¸šåŠ¡åœºæ™¯çš„è€ƒè™‘ä¹‹ä¸‹ï¼Œæœ€ç»ˆé‡‡ç”¨ html2canvas ä¸ jsPdf æ–¹å¼å®ç°è¯¥åŠŸèƒ½ã€‚å¦‚æœä½ æœ‰æ›´å¥½çš„æ–¹æ¡ˆï¼Œæ¬¢è¿è¯„è®ºåŒºæŒ‡å‡ºã€‚

å¯¼å‡ºç›¸å…³ä»£ç ï¼š[ğŸ‘‰ htmlToPdf](https://github.com/PDKSophia/visResumeMook/blob/chapter-11/app/renderer/common/utils/htmlToPdf.ts)

**å¦‚æœæ‚¨åœ¨è¾¹é˜…è¯»è¾¹å®è·µæ—¶ï¼Œå‘ç°ä»£ç æŠ¥é”™æˆ–è€… TS æŠ¥é”™ï¼Œé‚£ä¹ˆå°ä¼™ä¼´ä»¬å¯ä»¥æ ¹æ®æŠ¥é”™ä¿¡æ¯ï¼Œå»çº¿ä¸Šçœ‹çœ‹ç›¸åº”çš„ä»£ç ã€‚**

å¦‚æœå¯¹æœ¬ç« èŠ‚å­˜åœ¨ç–‘é—®ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºç•™è¨€ã€‚
