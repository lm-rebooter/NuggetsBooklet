åœ¨ç”Ÿäº§ç¯å¢ƒä¸‹ï¼Œä¸ºäº†æé«˜é¡µé¢åŠ è½½æ€§èƒ½ï¼Œæ„å»ºå·¥å…·ä¸€èˆ¬å°†é¡¹ç›®çš„ä»£ç æ‰“åŒ…(bundle)åˆ°ä¸€èµ·ï¼Œè¿™æ ·ä¸Šçº¿ä¹‹ååªéœ€è¦è¯·æ±‚å°‘é‡çš„ JS æ–‡ä»¶ï¼Œå¤§å¤§å‡å°‘ HTTP è¯·æ±‚ã€‚å½“ç„¶ï¼ŒVite ä¹Ÿä¸ä¾‹å¤–ï¼Œé»˜è®¤æƒ…å†µä¸‹ Vite åˆ©ç”¨åº•å±‚æ‰“åŒ…å¼•æ“ Rollup æ¥å®Œæˆé¡¹ç›®çš„æ¨¡å—æ‰“åŒ…ã€‚

æŸç§æ„ä¹‰ä¸Šæ¥è¯´ï¼Œå¯¹çº¿ä¸Šç¯å¢ƒè¿›è¡Œé¡¹ç›®æ‰“åŒ…æ˜¯ä¸€ä¸ªå¿…é¡»çš„æ“ä½œã€‚ä½†éšç€å‰ç«¯å·¥ç¨‹çš„æ—¥æ¸å¤æ‚ï¼Œå•ä»½çš„æ‰“åŒ…äº§ç‰©ä½“ç§¯è¶Šæ¥è¶Šåºå¤§ï¼Œä¼šå‡ºç°ä¸€ç³»åˆ—åº”ç”¨åŠ è½½æ€§èƒ½é—®é¢˜ï¼Œè€Œä»£ç åˆ†å‰²å¯ä»¥å¾ˆå¥½åœ°è§£å†³å®ƒä»¬ã€‚

åœ¨æœ¬å°èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†å›´ç»•`ä»£ç åˆ†å‰²`å±•å¼€å­¦ä¹ ã€‚é¦–å…ˆæˆ‘ä»¬å°†ä¸€èµ·åˆ†æ`Code Splitting`è§£å†³äº†å•äº§ç‰©æ‰“åŒ…æ¨¡å¼ä¸‹çš„å“ªäº›é—®é¢˜ï¼Œç„¶åç”¨å…·ä½“çš„é¡¹ç›®ç¤ºä¾‹ä½“éªŒä¸€ä¸‹ Vite é»˜è®¤è‡ªå¸¦çš„ `Code Splitting` æ•ˆæœã€‚ä»ä¸­ï¼Œä½ å°†äº†è§£åˆ° Vite çš„é»˜è®¤åˆ†åŒ…ç­–ç•¥ï¼Œä»¥åŠåº•å±‚æ‰€ä½¿ç”¨çš„ Rollup æ‹†åŒ… APIâ€”â€”`manualChunks`ã€‚

å½“ç„¶ï¼Œåœ¨å®é™…çš„é¡¹ç›®åœºæ™¯ä¸­ï¼Œåªç”¨ Vite é»˜è®¤çš„ç­–ç•¥æ˜¯ä¸å¤Ÿçš„ï¼Œæˆ‘ä»¬ä¼šæ›´æ·±å…¥ä¸€æ­¥ï¼Œå­¦ä¹  Rollup åº•å±‚æ‹†åŒ…çš„å„ç§é«˜çº§å§¿åŠ¿ï¼Œå®ç°**è‡ªå®šä¹‰æ‹†åŒ…**ï¼ŒåŒæ—¶æˆ‘ä¹Ÿä¼šå¸¦å¤§å®¶é€šè¿‡å®é™…æ¡ˆä¾‹å¤ç° Rollup è‡ªå®šä¹‰æ‹†åŒ…ç»å¸¸é‡åˆ°çš„å‘â€”â€”`å¾ªç¯å¼•ç”¨`é—®é¢˜ï¼Œä¸€èµ·åˆ†æé—®é¢˜å‡ºç°çš„åŸå› ï¼Œä¹Ÿåˆ†äº«ä¸€äº›è‡ªå·±çš„è§£å†³æ€è·¯å’Œæ–¹æ¡ˆï¼Œè®©å¤§å®¶å¯¹ Vite åŠ Rollup çš„ä»£ç åˆ†å‰²æœ‰æ›´åŠ æ·±å…¥çš„æŒæ¡ã€‚

éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ–‡ä¸­ä¼šå¤šæ¬¡æåˆ°`bundle`ã€`chunk`ã€`vendor`è¿™äº›æ„å»ºé¢†åŸŸçš„ä¸“ä¸šæ¦‚å¿µï¼Œè¿™é‡Œç»™å¤§å®¶æå‰è§£é‡Šä¸€ä¸‹:
- `bundle` æŒ‡çš„æ˜¯æ•´ä½“çš„æ‰“åŒ…äº§ç‰©ï¼ŒåŒ…å« JS å’Œå„ç§é™æ€èµ„æºã€‚
- `chunk`æŒ‡çš„æ˜¯æ‰“åŒ…åçš„ JS æ–‡ä»¶ï¼Œæ˜¯ `bundle` çš„å­é›†ã€‚
- `vendor`æ˜¯æŒ‡ç¬¬ä¸‰æ–¹åŒ…çš„æ‰“åŒ…äº§ç‰©ï¼Œæ˜¯ä¸€ç§ç‰¹æ®Šçš„ chunkã€‚

## Code Splitting è§£å†³çš„é—®é¢˜
åœ¨ä¼ ç»Ÿçš„å• chunk æ‰“åŒ…æ¨¡å¼ä¸‹ï¼Œå½“é¡¹ç›®ä»£ç è¶Šæ¥è¶Šåºå¤§ï¼Œæœ€åä¼šå¯¼è‡´æµè§ˆå™¨ä¸‹è½½ä¸€ä¸ªå·¨å¤§çš„æ–‡ä»¶ï¼Œä»é¡µé¢åŠ è½½æ€§èƒ½çš„è§’åº¦æ¥è¯´ï¼Œä¸»è¦ä¼šå¯¼è‡´ä¸¤ä¸ªé—®é¢˜:

- 1. æ— æ³•åšåˆ°**æŒ‰éœ€åŠ è½½**ï¼Œå³ä½¿æ˜¯å½“å‰é¡µé¢ä¸éœ€è¦çš„ä»£ç ä¹Ÿä¼šè¿›è¡ŒåŠ è½½ã€‚
- 2. çº¿ä¸Š**ç¼“å­˜å¤ç”¨ç‡**æä½ï¼Œæ”¹åŠ¨ä¸€è¡Œä»£ç å³å¯å¯¼è‡´æ•´ä¸ª bundle äº§ç‰©ç¼“å­˜å¤±æ•ˆã€‚

é¦–å…ˆè¯´ç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œä¸€èˆ¬è€Œè¨€ï¼Œä¸€ä¸ªå‰ç«¯é¡µé¢ä¸­çš„ JS ä»£ç å¯ä»¥åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†: `Initital Chunk`å’Œ`Async Chunk`ï¼Œå‰è€…æŒ‡é¡µé¢é¦–å±æ‰€éœ€è¦çš„ JS ä»£ç ï¼Œè€Œåè€…å½“å‰é¡µé¢å¹¶ä¸ä¸€å®šéœ€è¦ï¼Œä¸€ä¸ªå…¸å‹çš„ä¾‹å­å°±æ˜¯ `è·¯ç”±ç»„ä»¶`ï¼Œä¸å½“å‰è·¯ç”±æ— å…³çš„ç»„ä»¶å¹¶ä¸ç”¨åŠ è½½ã€‚è€Œé¡¹ç›®è¢«æ‰“åŒ…æˆå• bundle ä¹‹åï¼Œæ— è®ºæ˜¯`Initial Chunk`è¿˜æ˜¯`Async Chunk`ï¼Œéƒ½ä¼šæ‰“åŒ…è¿›åŒä¸€ä¸ªäº§ç‰©ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæµè§ˆå™¨åŠ è½½äº§ç‰©ä»£ç çš„æ—¶å€™ï¼Œä¼šå°†ä¸¤è€…ä¸€èµ·åŠ è½½ï¼Œå¯¼è‡´è®¸å¤šå†—ä½™çš„åŠ è½½è¿‡ç¨‹ï¼Œä»è€Œå½±å“é¡µé¢æ€§èƒ½ã€‚è€Œé€šè¿‡`Code Splitting`æˆ‘ä»¬å¯ä»¥å°†æŒ‰éœ€åŠ è½½çš„ä»£ç æ‹†åˆ†å‡ºå•ç‹¬çš„ chunkï¼Œè¿™æ ·åº”ç”¨åœ¨é¦–å±åŠ è½½æ—¶åªéœ€è¦åŠ è½½`Initial Chunk` å³å¯ï¼Œé¿å…äº†å†—ä½™çš„åŠ è½½è¿‡ç¨‹ï¼Œä½¿é¡µé¢æ€§èƒ½å¾—åˆ°æå‡ã€‚

å…¶æ¬¡ï¼Œçº¿ä¸Šçš„`ç¼“å­˜å‘½ä¸­ç‡`æ˜¯ä¸€ä¸ªé‡è¦çš„æ€§èƒ½è¡¡é‡æ ‡å‡†ã€‚å¯¹äºçº¿ä¸Šç«™ç‚¹è€Œè¨€ï¼ŒæœåŠ¡ç«¯ä¸€èˆ¬åœ¨å“åº”èµ„æºæ—¶åŠ ä¸Šä¸€äº› HTTP å“åº”å¤´ï¼Œæœ€å¸¸è§çš„å“åº”å¤´ä¹‹ä¸€å°±æ˜¯`cache-control`ï¼Œå®ƒå¯ä»¥æŒ‡å®šæµè§ˆå™¨çš„**å¼ºç¼“å­˜**ï¼Œæ¯”å¦‚è®¾ç½®ä¸ºä¸‹é¢è¿™æ ·:
```bash
cache-control: max-age=31536000
```
è¡¨ç¤ºèµ„æºè¿‡æœŸæ—¶é—´ä¸ºä¸€å¹´ï¼Œåœ¨è¿‡æœŸä¹‹å‰ï¼Œè®¿é—®**ç›¸åŒçš„èµ„æº url**ï¼Œæµè§ˆå™¨ç›´æ¥åˆ©ç”¨æœ¬åœ°çš„ç¼“å­˜ï¼Œå¹¶ä¸ç”¨ç»™æœåŠ¡ç«¯å‘è¯·æ±‚ï¼Œè¿™å°±å¤§å¤§é™ä½äº†é¡µé¢åŠ è½½çš„ç½‘ç»œå¼€é”€ã€‚ä¸è¿‡ï¼Œåœ¨å• chunk æ‰“åŒ…æ¨¡å¼ä¸‹é¢ï¼Œä¸€æ—¦æœ‰ä¸€è¡Œä»£ç å˜åŠ¨ï¼Œæ•´ä¸ª chunk çš„ url åœ°å€éƒ½ä¼šå˜åŒ–ï¼Œæ¯”å¦‚ä¸‹å›¾æ‰€ç¤ºçš„åœºæ™¯:


![image.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f359363de91f479894b40b35e610649b~tplv-k3u1fbpfcp-watermark.image?)

ç”±äºæ„å»ºå·¥å…·ä¸€èˆ¬ä¼šæ ¹æ®äº§ç‰©çš„å†…å®¹ç”Ÿæˆå“ˆå¸Œå€¼ï¼Œä¸€æ—¦å†…å®¹å˜åŒ–å°±ä¼šå¯¼è‡´æ•´ä¸ª chunk äº§ç‰©çš„å¼ºç¼“å­˜å¤±æ•ˆï¼Œæ‰€ä»¥å• chunk æ‰“åŒ…æ¨¡å¼ä¸‹çš„ç¼“å­˜å‘½ä¸­ç‡æä½ï¼ŒåŸºæœ¬ä¸ºé›¶ã€‚

è€Œè¿›è¡Œ`Code Splitting`ä¹‹åï¼Œä»£ç çš„æ”¹åŠ¨åªä¼šå½±å“éƒ¨åˆ†çš„ chunk å“ˆå¸Œæ”¹åŠ¨ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º:

![image.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5bdd076bb07b471a96feb0e05b0bdec5~tplv-k3u1fbpfcp-watermark.image?)

å…¥å£æ–‡ä»¶å¼•ç”¨äº†`A`ã€`B`ã€`C`ã€`D`å››ä¸ªç»„ä»¶ï¼Œå½“æˆ‘ä»¬ä¿®æ”¹ A çš„ä»£ç åï¼Œå˜åŠ¨çš„ Chunk å°±åªæœ‰ `A` ä»¥åŠ`ä¾èµ– A çš„ Chunk` ä¸­ï¼ŒA å¯¹åº”çš„ chunk ä¼šå˜åŠ¨ï¼Œè¿™å¾ˆå¥½ç†è§£ï¼Œåè€…ä¹Ÿä¼šå˜åŠ¨æ˜¯å› ä¸ºç›¸åº”çš„å¼•å…¥è¯­å¥ä¼šå˜åŒ–ï¼Œå¦‚è¿™é‡Œçš„å…¥å£æ–‡ä»¶ä¼šå‘ç”Ÿå¦‚ä¸‹å†…å®¹å˜åŠ¨:
```ts
import CompA from './A.d3e2f17a.js'
// æ›´æ–° import è¯­å¥
import CompA from './A.a5d2f82b.js'
```


ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨æ”¹åŠ¨ `A` çš„ä»£ç åï¼Œ`B`ã€`C`ã€`D`çš„ chunk äº§ç‰© url å¹¶æ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œä»è€Œå¯ä»¥è®©æµè§ˆå™¨å¤ç”¨æœ¬åœ°çš„å¼ºç¼“å­˜ï¼Œå¤§å¤§æå‡çº¿ä¸Šåº”ç”¨çš„åŠ è½½æ€§èƒ½ã€‚

## Vite é»˜è®¤æ‹†åŒ…ç­–ç•¥
åˆšåˆšæˆ‘ä»¬è¯´åˆ°äº†ä¸ºä»€ä¹ˆè¦è¿›è¡Œæ‹†åŒ…ï¼Œå®é™…ä¸Š Vite ä¸­å·²ç»å†…ç½®äº†ä¸€ä»½æ‹†åŒ…çš„ç­–ç•¥ï¼Œæ¥ä¸‹æ¥è®©æˆ‘ä»¬æ¥çœ‹çœ‹ Vite é»˜è®¤çš„æ‹†åŒ…æ¨¡å¼æ˜¯æ€æ ·çš„ã€‚

åœ¨ç”Ÿäº§ç¯å¢ƒä¸‹ Vite å®Œå…¨åˆ©ç”¨ Rollup è¿›è¡Œæ„å»ºï¼Œå› æ­¤æ‹†åŒ…ä¹Ÿæ˜¯åŸºäº Rollup æ¥å®Œæˆçš„ï¼Œä½† Rollup æœ¬èº«æ˜¯ä¸€ä¸ªä¸“æ³¨ JS åº“æ‰“åŒ…çš„å·¥å…·ï¼Œå¯¹åº”ç”¨æ„å»ºçš„èƒ½åŠ›è¿˜å°šä¸ºæ¬ ç¼ºï¼ŒVite æ­£å¥½æ˜¯è¡¥è¶³äº† Rollup åº”ç”¨æ„å»ºçš„èƒ½åŠ›ï¼Œåœ¨æ‹†åŒ…èƒ½åŠ›è¿™ä¸€å—çš„æ‰©å±•å°±æ˜¯å¾ˆå¥½çš„ä½“ç°ã€‚

æˆ‘ä»¬å…ˆé€šè¿‡å…·ä½“çš„é¡¹ç›®æ¥ä½“éªŒä¸€ä¸‹ Vite æ‹†åŒ…ï¼Œç¤ºä¾‹é¡¹ç›®æˆ‘å·²ç»æ”¾åˆ°äº†å°å†Œçš„ Gihub ä»“åº“ä¸­ï¼Œä½ å¯ä»¥å¯¹ç…§ç€æ¥å­¦ä¹ ã€‚

åœ¨é¡¹ç›®ä¸­æ‰§è¡Œ`npm run build`ï¼Œæ¥ç€ç»ˆç«¯ä¼šå‡ºç°å¦‚ä¸‹çš„æ„å»ºä¿¡æ¯:

![image.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c1718c5efe704497813fe0dbb9284641~tplv-k3u1fbpfcp-watermark.image?)

> é¡¹ç›®ç¤ºä¾‹ä½¿ç”¨çš„æ˜¯ Vite 2.9 ä¹‹å‰çš„ç‰ˆæœ¬ï¼Œ[ç‚¹å‡»è¿›å…¥é¡¹ç›®](https://github.com/sanyuan0704/juejin-book-vite/tree/main/code-splitting/app)ã€‚Vite 2.9 åŠä»¥åçš„ç‰ˆæœ¬æ‹†åŒ…ç­–ç•¥ä¼šæœ‰æ‰€ä¸åŒï¼Œåæ–‡ä¼šä»‹ç»ã€‚

è¿™é‡Œæˆ‘æ¥è§£é‡Šä¸€ä¸‹äº§ç‰©çš„ç»“æ„:
```bash
.
â”œâ”€â”€ assets
â”‚   â”œâ”€â”€ Dynamic.3df51f7a.js    // Async Chunk
â”‚   â”œâ”€â”€ Dynamic.f2cbf023.css   // Async Chunk (CSS)
â”‚   â”œâ”€â”€ favicon.17e50649.svg   // é™æ€èµ„æº
â”‚   â”œâ”€â”€ index.1e236845.css     // Initial Chunk (CSS)
â”‚   â”œâ”€â”€ index.6773c114.js      // Initial Chunk
â”‚   â””â”€â”€ vendor.ab4b9e1f.js     // ç¬¬ä¸‰æ–¹åŒ…äº§ç‰© Chunk
â””â”€â”€ index.html                 // å…¥å£ HTML
```
å¯¹äº Vite çš„æ‹†åŒ…èƒ½åŠ›ï¼Œä»äº§ç‰©ç»“æ„ä¸­å°±å¯è§ä¸€æ–‘ã€‚

ä¸€æ–¹é¢ Vite å®ç°äº†è‡ªåŠ¨ **CSS ä»£ç åˆ†å‰²**çš„èƒ½åŠ›ï¼Œå³å®ç°ä¸€ä¸ª chunk å¯¹åº”ä¸€ä¸ª css æ–‡ä»¶ï¼Œæ¯”å¦‚ä¸Šé¢äº§ç‰©ä¸­`index.js`å¯¹åº”ä¸€ä»½`index.css`ï¼Œè€ŒæŒ‰éœ€åŠ è½½çš„ chunk `Danamic.js`ä¹Ÿå¯¹åº”å•ç‹¬çš„ä¸€ä»½`Danamic.css`æ–‡ä»¶ï¼Œä¸ JS æ–‡ä»¶çš„ä»£ç åˆ†å‰²åŒç†ï¼Œè¿™æ ·åšä¹Ÿèƒ½æå‡ CSS æ–‡ä»¶çš„ç¼“å­˜å¤ç”¨ç‡ã€‚

è€Œå¦ä¸€æ–¹é¢ï¼Œ Vite åŸºäº Rollup çš„`manualChunks`API å®ç°äº†`åº”ç”¨æ‹†åŒ…`çš„ç­–ç•¥: 

- å¯¹äº `Initital Chunk` è€Œè¨€ï¼Œä¸šåŠ¡ä»£ç å’Œç¬¬ä¸‰æ–¹åŒ…ä»£ç åˆ†åˆ«æ‰“åŒ…ä¸ºå•ç‹¬çš„ chunkï¼Œåœ¨ä¸Šè¿°çš„ä¾‹å­ä¸­åˆ†åˆ«å¯¹åº”`index.js`å’Œ`vendor.js`ã€‚éœ€è¦è¯´æ˜çš„æ˜¯ï¼Œè¿™æ˜¯ Vite 2.9 ç‰ˆæœ¬ä¹‹å‰çš„åšæ³•ï¼Œè€Œåœ¨ Vite 2.9 åŠä»¥åçš„ç‰ˆæœ¬ï¼Œé»˜è®¤æ‰“åŒ…ç­–ç•¥æ›´åŠ ç®€å•ç²—æš´ï¼Œå°†æ‰€æœ‰çš„ js ä»£ç å…¨éƒ¨æ‰“åŒ…åˆ° `index.js` ä¸­ã€‚

- å¯¹äº `Async Chunk` è€Œè¨€ ï¼ŒåŠ¨æ€ import çš„ä»£ç ä¼šè¢«æ‹†åˆ†æˆå•ç‹¬çš„ chunkï¼Œå¦‚ä¸Šè¿°çš„`Dynacmic`ç»„ä»¶ã€‚

å°ç»“ä¸€ä¸‹ï¼ŒVite é»˜è®¤æ‹†åŒ…çš„ä¼˜åŠ¿åœ¨äºå®ç°äº† CSS ä»£ç åˆ†å‰²ä¸ä¸šåŠ¡ä»£ç ã€ç¬¬ä¸‰æ–¹åº“ä»£ç ã€åŠ¨æ€ import æ¨¡å—ä»£ç ä¸‰è€…çš„åˆ†ç¦»ï¼Œä½†ç¼ºç‚¹ä¹Ÿæ¯”è¾ƒç›´è§‚ï¼Œç¬¬ä¸‰æ–¹åº“çš„æ‰“åŒ…äº§ç‰©å®¹æ˜“å˜å¾—æ¯”è¾ƒè‡ƒè‚¿ï¼Œä¸Šè¿°ä¾‹å­ä¸­çš„`vendor.js`çš„å¤§å°å·²ç»è¾¾åˆ° 500 KB ä»¥ä¸Šï¼Œæ˜¾ç„¶æ˜¯æœ‰è¿›ä¸€æ­¥æ‹†åŒ…çš„ä¼˜åŒ–ç©ºé—´çš„ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±éœ€è¦ç”¨åˆ° Rollup ä¸­çš„æ‹†åŒ… API â€”â€”`manualChunks`  äº†ã€‚

> 

## è‡ªå®šä¹‰æ‹†åŒ…ç­–ç•¥

é’ˆå¯¹æ›´ç»†ç²’åº¦çš„æ‹†åŒ…ï¼ŒVite çš„åº•å±‚æ‰“åŒ…å¼•æ“ Rollup æä¾›äº†`manualChunks`ï¼Œè®©æˆ‘ä»¬èƒ½è‡ªå®šä¹‰æ‹†åŒ…ç­–ç•¥ï¼Œå®ƒå±äº Vite é…ç½®çš„ä¸€éƒ¨åˆ†ï¼Œç¤ºä¾‹å¦‚ä¸‹: 
```ts
// vite.config.ts
export default {
  build: {
    rollupOptions: {
      output: {
        // manualChunks é…ç½®
        manualChunks: {},
      },
    }
  },
}
```
`manualChunks` ä¸»è¦æœ‰ä¸¤ç§é…ç½®çš„å½¢å¼ï¼Œå¯ä»¥é…ç½®ä¸ºä¸€ä¸ªå¯¹è±¡æˆ–è€…ä¸€ä¸ªå‡½æ•°ã€‚æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹å¯¹è±¡çš„é…ç½®ï¼Œä¹Ÿæ˜¯æœ€ç®€å•çš„é…ç½®æ–¹å¼ï¼Œä½ å¯ä»¥åœ¨ä¸Šè¿°çš„ç¤ºä¾‹é¡¹ç›®ä¸­æ·»åŠ å¦‚ä¸‹çš„`manualChunks`é…ç½®ä»£ç :
```ts
// vite.config.ts
{
  build: {
    rollupOptions: {
      output: {
        // manualChunks é…ç½®
        manualChunks: {
          // å°† React ç›¸å…³åº“æ‰“åŒ…æˆå•ç‹¬çš„ chunk ä¸­
          'react-vendor': ['react', 'react-dom'],
          // å°† Lodash åº“çš„ä»£ç å•ç‹¬æ‰“åŒ…
          'lodash': ['lodash-es'],
          // å°†ç»„ä»¶åº“çš„ä»£ç æ‰“åŒ…
          'library': ['antd', '@arco-design/web-react'],
        },
      },
    }
  },
}
```
åœ¨å¯¹è±¡æ ¼å¼çš„é…ç½®ä¸­ï¼Œ`key`ä»£è¡¨ chunk çš„åç§°ï¼Œ`value`ä¸ºä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„ï¼Œæ¯ä¸€é¡¹ä¸ºç¬¬ä¸‰æ–¹åŒ…çš„åŒ…åã€‚åœ¨è¿›è¡Œäº†å¦‚ä¸Šçš„é…ç½®ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥æ‰§è¡Œ`npm run build`å°è¯•ä¸€ä¸‹æ‰“åŒ…:


![image.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6edc54e00ba4475dac67dd77f00966b4~tplv-k3u1fbpfcp-watermark.image?)
ä½ å¯ä»¥çœ‹åˆ°åŸæ¥çš„ vendor å¤§æ–‡ä»¶è¢«æ‹†åˆ†æˆäº†æˆ‘ä»¬æ‰‹åŠ¨æŒ‡å®šçš„å‡ ä¸ªå° chunkï¼Œæ¯ä¸ª chunk å¤§æ¦‚ 200 KB å·¦å³ï¼Œæ˜¯ä¸€ä¸ªæ¯”è¾ƒç†æƒ³çš„ chunk ä½“ç§¯ã€‚è¿™æ ·ï¼Œå½“ç¬¬ä¸‰æ–¹åŒ…æ›´æ–°çš„æ—¶å€™ï¼Œä¹Ÿåªä¼šæ›´æ–°å…¶ä¸­ä¸€ä¸ª chunk çš„ urlï¼Œè€Œä¸ä¼šå…¨é‡æ›´æ–°ï¼Œä»è€Œæé«˜äº†ç¬¬ä¸‰æ–¹åŒ…äº§ç‰©çš„ç¼“å­˜å‘½ä¸­ç‡ã€‚

é™¤äº†å¯¹è±¡çš„é…ç½®æ–¹å¼ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡å‡½æ•°è¿›è¡Œæ›´åŠ çµæ´»çš„é…ç½®ï¼Œè€Œ Vite ä¸­çš„é»˜è®¤æ‹†åŒ…ç­–ç•¥ä¹Ÿæ˜¯é€šè¿‡å‡½æ•°çš„æ–¹å¼æ¥è¿›è¡Œé…ç½®çš„ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ Vite çš„å®ç°ä¸­ç§ä¸€ç§:
```ts
// Vite éƒ¨åˆ†æºç 
function createMoveToVendorChunkFn(config: ResolvedConfig): GetManualChunk {
  const cache = new Map<string, boolean>()
  // è¿”å›å€¼ä¸º manualChunks çš„é…ç½®
  return (id, { getModuleInfo }) => {
    // Vite é»˜è®¤çš„é…ç½®é€»è¾‘å…¶å®å¾ˆç®€å•
    // ä¸»è¦æ˜¯ä¸ºäº†æŠŠ Initial Chunk ä¸­çš„ç¬¬ä¸‰æ–¹åŒ…ä»£ç å•ç‹¬æ‰“åŒ…æˆ`vendor.[hash].js`
    if (
      id.includes('node_modules') &&
      !isCSSRequest(id) &&
      // åˆ¤æ–­æ˜¯å¦ä¸º Initial Chunk
      staticImportedByEntry(id, getModuleInfo, cache)
    ) {
      return 'vendor'
    }
  }
}
```
Rollup ä¼šå¯¹æ¯ä¸€ä¸ªæ¨¡å—è°ƒç”¨ manualChunks å‡½æ•°ï¼Œåœ¨ manualChunks çš„å‡½æ•°å…¥å‚ä¸­ä½ å¯ä»¥æ‹¿åˆ°`æ¨¡å— id` åŠ`æ¨¡å—è¯¦æƒ…ä¿¡æ¯`ï¼Œç»è¿‡ä¸€å®šçš„å¤„ç†åè¿”å› `chunk æ–‡ä»¶çš„åç§°`ï¼Œè¿™æ ·å½“å‰ id ä»£è¡¨çš„æ¨¡å—ä¾¿ä¼šæ‰“åŒ…åˆ°ä½ æ‰€æŒ‡å®šçš„ chunk æ–‡ä»¶ä¸­ã€‚

æˆ‘ä»¬ç°åœ¨æ¥è¯•ç€æŠŠåˆšæ‰çš„æ‹†åŒ…é€»è¾‘ç”¨å‡½æ•°æ¥å®ç°ä¸€é:
```ts
manualChunks(id) {
  if (id.includes('antd') || id.includes('@arco-design/web-react')) {
    return 'library';
  }
  if (id.includes('lodash')) {
    return 'lodash';
  }
  if (id.includes('react')) {
    return 'react';
  }
}
```
æ‰“åŒ…åç»“æœå¦‚ä¸‹:


![image.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3495634bb0284597bfcdc071fbf27d45~tplv-k3u1fbpfcp-watermark.image?)

çœ‹ä¸Šå»å¥½åƒå„ä¸ªç¬¬ä¸‰æ–¹åŒ…çš„ chunk (å¦‚`lodash`ã€`react`ç­‰ç­‰)éƒ½èƒ½æ‹†åˆ†å‡ºæ¥ï¼Œä½†å®é™…ä¸Šä½ å¯ä»¥è¿è¡Œ `npx vite preview` é¢„è§ˆäº§ç‰©ï¼Œä¼šå‘ç°äº§ç‰©æ ¹æœ¬æ²¡æœ‰åŠæ³•è¿è¡Œèµ·æ¥ï¼Œé¡µé¢å‡ºç°ç™½å±ï¼ŒåŒæ—¶æ§åˆ¶å°å‡ºç°å¦‚ä¸‹çš„æŠ¥é”™:


![image.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f4250e42ed9445b985cb8c539f69694e~tplv-k3u1fbpfcp-watermark.image?)

è¿™ä¹Ÿå°±æ˜¯å‡½æ•°é…ç½®çš„å‘ç‚¹æ‰€åœ¨äº†ï¼Œè™½ç„¶çµæ´»è€Œæ–¹ä¾¿ï¼Œä½†ç¨ä¸æ³¨æ„å°±é™·å…¥æ­¤ç±»çš„äº§ç‰©é”™è¯¯é—®é¢˜å½“ä¸­ã€‚é‚£ä¸Šé¢çš„è¿™ä¸ªæŠ¥é”™ç©¶ç«Ÿæ˜¯ä»€ä¹ˆåŸå› å¯¼è‡´çš„å‘¢ï¼Ÿ

## è§£å†³å¾ªç¯å¼•ç”¨é—®é¢˜

ä»æŠ¥é”™ä¿¡æ¯è¿½æº¯åˆ°äº§ç‰©ä¸­ï¼Œå¯ä»¥å‘ç°`react-vendor.js`ä¸`index.js`å‘ç”Ÿäº†å¾ªç¯å¼•ç”¨:
```ts
// react-vendor.e2c4883f.js
import { q as objectAssign } from "./index.37a7b2eb.js";

// index.37a7b2eb.js
import { R as React } from "./react-vendor.e2c4883f.js";
```
è¿™æ˜¯å¾ˆå…¸å‹çš„ ES æ¨¡å—å¾ªç¯å¼•ç”¨çš„åœºæ™¯ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªæœ€åŸºæœ¬çš„ä¾‹å­æ¥å¤åŸè¿™ä¸ªåœºæ™¯:
```ts
// a.js
import { funcB } from './b.js';

funcB();

export var funcA = () => {
  console.log('a');
} 
// b.js
import { funcA } from './a.js';

funcA();

export var funcB = () => {
  console.log('b')
}
```
æ¥ç€æˆ‘ä»¬å¯ä»¥æ‰§è¡Œä¸€ä¸‹`a.js`æ–‡ä»¶:
```html
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Document</title>
</head>
<body>
  <script type="module" src="/a.js"></script>
</body>
</html>
```
åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ä¼šå‡ºç°ç±»ä¼¼çš„æŠ¥é”™:

![image.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f71a39e22848419aac513906df7d39bb~tplv-k3u1fbpfcp-watermark.image?)

ä»£ç çš„æ‰§è¡ŒåŸç†å¦‚ä¸‹:
- 1. JS å¼•æ“æ‰§è¡Œ `a.js` æ—¶ï¼Œå‘ç°å¼•å…¥äº† `b.js`ï¼Œäºæ˜¯å»æ‰§è¡Œ `b.js`
- 2. å¼•æ“æ‰§è¡Œ`b.js`ï¼Œå‘ç°é‡Œé¢å¼•å…¥äº†`a.js`(å‡ºç°å¾ªç¯å¼•ç”¨)ï¼Œè®¤ä¸º`a.js`å·²ç»åŠ è½½å®Œæˆï¼Œç»§ç»­å¾€ä¸‹æ‰§è¡Œ
- 3. æ‰§è¡Œåˆ°`funcA()`è¯­å¥æ—¶å‘ç° funcA å¹¶æ²¡æœ‰å®šä¹‰ï¼Œäºæ˜¯æŠ¥é”™ã€‚


![image.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ee8c028b04564b95a093720ac9c3f60b~tplv-k3u1fbpfcp-watermark.image?)

è€Œå¯¹äºå¦‚ä¸Šæ‰“åŒ…äº§ç‰©çš„æ‰§è¡Œè¿‡ç¨‹ä¹Ÿæ˜¯åŒç†:

![image.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3f640e0e85e64bd7b20bb2f1ca47f2a2~tplv-k3u1fbpfcp-watermark.image?)

å¯èƒ½ä½ ä¼šæœ‰ç–‘é—®: `react-vendor`ä¸ºä»€ä¹ˆéœ€è¦å¼•ç”¨`index.js`çš„ä»£ç å‘¢ï¼Ÿå…¶å®ä¹Ÿå¾ˆå¥½ç†è§£ï¼Œæˆ‘ä»¬ä¹‹å‰åœ¨`manualChunks`ä¸­ä»…ä»…å°†è·¯å¾„åŒ…å« `react` çš„æ¨¡å—æ‰“åŒ…åˆ°`react-vendor`ä¸­ï¼Œæ®Šä¸çŸ¥ï¼Œåƒ`object-assign`è¿™ç§ react æœ¬èº«çš„ä¾èµ–å¹¶æ²¡æœ‰æ‰“åŒ…è¿›`react-vendor`ä¸­ï¼Œè€Œæ˜¯æ‰“åŒ…åˆ°å¦å¤–çš„ chunk å½“ä¸­ï¼Œä»è€Œå¯¼è‡´å¦‚ä¸‹çš„å¾ªç¯ä¾èµ–å…³ç³»:

![image.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ec3419b5b2f8410cbefd332e1e7224b2~tplv-k3u1fbpfcp-watermark.image?)

é‚£æˆ‘ä»¬èƒ½ä¸èƒ½é¿å…è¿™ç§é—®é¢˜å‘¢ï¼Ÿå½“ç„¶æ˜¯å¯ä»¥çš„ï¼Œä¹‹å‰çš„ `manualChunks`é€»è¾‘è¿‡äºç®€å•ç²—æš´ï¼Œä»…ä»…é€šè¿‡è·¯å¾„ id æ¥å†³å®šæ‰“åŒ…åˆ°å“ªä¸ª chunk ä¸­ï¼Œè€Œæ¼æ‰äº†é—´æ¥ä¾èµ–çš„æƒ…å†µã€‚å¦‚æœé’ˆå¯¹åƒ`object-assign`è¿™ç§é—´æ¥ä¾èµ–ï¼Œæˆ‘ä»¬ä¹Ÿèƒ½è¯†åˆ«å‡ºå®ƒå±äº react çš„ä¾èµ–ï¼Œå°†å…¶è‡ªåŠ¨æ‰“åŒ…åˆ°`react-vendor`ä¸­ï¼Œè¿™æ ·å°±å¯ä»¥é¿å…å¾ªç¯å¼•ç”¨çš„é—®é¢˜ã€‚

æˆ‘ä»¬æ¥æ¢³ç†ä¸€ä¸‹è§£å†³çš„æ€è·¯:
- 1. ç¡®å®š react ç›¸å…³åŒ…çš„å…¥å£è·¯å¾„ã€‚
- 2. åœ¨ manualChunks ä¸­æ‹¿åˆ°æ¨¡å—çš„è¯¦ç»†ä¿¡æ¯ï¼Œå‘ä¸Šè¿½æº¯å®ƒçš„å¼•ç”¨è€…ï¼Œå¦‚æœå‘½ä¸­ react çš„è·¯å¾„ï¼Œåˆ™å°†æ¨¡å—æ”¾åˆ° `react-vendor`ä¸­ã€‚

æ¥ä¸‹æ¥è®©æˆ‘ä»¬è¿›è¡Œå®é™…ä»£ç çš„å®ç°:
```ts
// ç¡®å®š react ç›¸å…³åŒ…çš„å…¥å£è·¯å¾„
const chunkGroups = {
  'react-vendor': [
    require.resolve('react'),
    require.resolve('react-dom')
  ],
}

// Vite ä¸­çš„ manualChunks é…ç½®
function manualChunks(id, { getModuleInfo }) { 
  for (const group of Object.keys(chunkGroups)) {
    const deps = chunkGroups[group];
    if (
      id.includes('node_modules') && 
      // é€’å½’å‘ä¸ŠæŸ¥æ‰¾å¼•ç”¨è€…ï¼Œæ£€æŸ¥æ˜¯å¦å‘½ä¸­ chunkGroups å£°æ˜çš„åŒ… 
      isDepInclude(id, deps, [], getModuleInfo)
     ) { 
      return group;
    }
  }
}
```
å®é™…ä¸Šæ ¸å¿ƒé€»è¾‘åŒ…å«åœ¨`isDepInclude`å‡½æ•°ï¼Œç”¨æ¥é€’å½’å‘ä¸ŠæŸ¥æ‰¾å¼•ç”¨è€…æ¨¡å—:
```ts
// ç¼“å­˜å¯¹è±¡
const cache = new Map();

function isDepInclude (id: string, depPaths: string[], importChain: string[], getModuleInfo): boolean | undefined  {
  const key = `${id}-${depPaths.join('|')}`;
  // å‡ºç°å¾ªç¯ä¾èµ–ï¼Œä¸è€ƒè™‘
  if (importChain.includes(id)) {
    cache.set(key, false);
    return false;
  }
  // éªŒè¯ç¼“å­˜
  if (cache.has(key)) {
    return cache.get(key);
  }
  // å‘½ä¸­ä¾èµ–åˆ—è¡¨
  if (depPaths.includes(id)) {
    // å¼•ç”¨é“¾ä¸­çš„æ–‡ä»¶éƒ½è®°å½•åˆ°ç¼“å­˜ä¸­
    importChain.forEach(item => cache.set(`${item}-${depPaths.join('|')}`, true));
    return true;
  }
  const moduleInfo = getModuleInfo(id);
  if (!moduleInfo || !moduleInfo.importers) {
    cache.set(key, false);
    return false;
  }
  // æ ¸å¿ƒé€»è¾‘ï¼Œé€’å½’æŸ¥æ‰¾ä¸Šå±‚å¼•ç”¨è€…
  const isInclude = moduleInfo.importers.some(
    importer => isDepInclude(importer, depPaths, importChain.concat(id), getModuleInfo)
  );
  // è®¾ç½®ç¼“å­˜
  cache.set(key, isInclude);
  return isInclude;
};
```
å¯¹äºè¿™ä¸ªå‡½æ•°çš„å®ç°ï¼Œæœ‰ä¸¤ä¸ªåœ°æ–¹éœ€è¦å¤§å®¶æ³¨æ„:
- 1. æˆ‘ä»¬å¯ä»¥é€šè¿‡ manualChunks æä¾›çš„å…¥å‚`getModuleInfo`æ¥è·å–æ¨¡å—çš„è¯¦æƒ…`moduleInfo`ï¼Œç„¶åé€šè¿‡`moduleInfo.importers`æ‹¿åˆ°æ¨¡å—çš„å¼•ç”¨è€…ï¼Œé’ˆå¯¹æ¯ä¸ªå¼•ç”¨è€…åˆå¯ä»¥é€’å½’åœ°æ‰§è¡Œè¿™ä¸€è¿‡ç¨‹ï¼Œä»è€Œè·å–å¼•ç”¨é“¾çš„ä¿¡æ¯ã€‚
- 2. å°½é‡ä½¿ç”¨ç¼“å­˜ã€‚ç”±äºç¬¬ä¸‰æ–¹åŒ…æ¨¡å—æ•°é‡ä¸€èˆ¬æ¯”è¾ƒå¤šï¼Œå¯¹æ¯ä¸ªæ¨¡å—éƒ½å‘ä¸ŠæŸ¥æ‰¾ä¸€éå¼•ç”¨é“¾ä¼šå¯¼è‡´å¼€é”€éå¸¸å¤§ï¼Œå¹¶ä¸”ä¼šäº§ç”Ÿå¾ˆå¤šé‡å¤çš„é€»è¾‘ï¼Œä½¿ç”¨ç¼“å­˜ä¼šæå¤§åŠ é€Ÿè¿™ä¸€è¿‡ç¨‹ã€‚

å®Œæˆä¸Šè¿°`manualChunks`çš„å®Œæ•´é€»è¾‘åï¼Œç°åœ¨æˆ‘ä»¬æ¥æ‰§è¡Œ`npm run build`æ¥è¿›è¡Œæ‰“åŒ…:

![image.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d4f6b899bd274e92bdda466d4d9165fb~tplv-k3u1fbpfcp-watermark.image?)

å¯ä»¥å‘ç°`react-vendor`å¯ä»¥æ­£å¸¸æ‹†åˆ†å‡ºæ¥ï¼ŒæŸ¥çœ‹å®ƒçš„å†…å®¹:


![image.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8484e9fb9ef040c98bb161c7e225d02a~tplv-k3u1fbpfcp-watermark.image?)

ä»ä¸­ä½ å¯ä»¥çœ‹å‡º`react`çš„ä¸€äº›é—´æ¥ä¾èµ–å·²ç»æˆåŠŸæ‰“åŒ…åˆ°äº†`react-vendor`å½“ä¸­ï¼Œæ‰§è¡Œ`npx view preview`é¢„è§ˆäº§ç‰©é¡µé¢ä¹Ÿèƒ½æ­£å¸¸æ¸²æŸ“äº†:


![image.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/00dc56a744614310ab86f8260a0511d3~tplv-k3u1fbpfcp-watermark.image?)

è¯´æ˜å¾ªç¯ä¾èµ–çš„é—®é¢˜å·²ç»è¢«æˆ‘ä»¬è§£å†³æ‰äº†ã€‚

## ç»ˆæè§£å†³æ–¹æ¡ˆ
å°½ç®¡ä¸Šè¿°çš„è§£å†³æ–¹æ¡ˆå·²ç»èƒ½å¸®æˆ‘ä»¬æ­£å¸¸è¿›è¡Œäº§ç‰©æ‹†åŒ…ï¼Œä½†ä»å®ç°ä¸Šæ¥çœ‹ï¼Œè¿˜æ˜¯æ˜¾å¾—ç•¥å¾®ç¹çï¼Œé‚£ä¹ˆæœ‰æ²¡æœ‰å¼€ç®±å³ç”¨çš„æ‹†åŒ…æ–¹æ¡ˆï¼Œèƒ½è®©æˆ‘ä»¬ç›´æ¥ç”¨åˆ°é¡¹ç›®ä¸­å‘¢ï¼Ÿ

ç­”æ¡ˆæ˜¯è‚¯å®šçš„ï¼Œæ¥ä¸‹æ¥æˆ‘å°±ç»™å¤§å®¶ä»‹ç» Vite è‡ªå®šä¹‰æ‹†åŒ…çš„ç»ˆæè§£å†³æ–¹æ¡ˆâ€”â€”`vite-plugin-chunk-split`ã€‚

é¦–å…ˆå®‰è£…ä¸€ä¸‹è¿™ä¸ªæ’ä»¶:
```ts
pnpm i vite-plugin-chunk-split -D
```

ç„¶åä½ å¯ä»¥åœ¨é¡¹ç›®ä¸­å¼•å…¥å¹¶ä½¿ç”¨:
```ts
// vite.config.ts
import { chunkSplitPlugin } from 'vite-plugin-chunk-split';

export default {
  chunkSplitPlugin({
    // æŒ‡å®šæ‹†åŒ…ç­–ç•¥
    customSplitting: {
      // 1. æ”¯æŒå¡«åŒ…åã€‚`react` å’Œ `react-dom` ä¼šè¢«æ‰“åŒ…åˆ°ä¸€ä¸ªåä¸º`render-vendor`çš„ chunk é‡Œé¢(åŒ…æ‹¬å®ƒä»¬çš„ä¾èµ–ï¼Œå¦‚ object-assign)
      'react-vendor': ['react', 'react-dom'],
      // 2. æ”¯æŒå¡«æ­£åˆ™è¡¨è¾¾å¼ã€‚src ä¸­ components å’Œ utils ä¸‹çš„æ‰€æœ‰æ–‡ä»¶è¢«ä¼šè¢«æ‰“åŒ…ä¸º`component-util`çš„ chunk ä¸­
      'components-util': [/src\/components/, /src\/utils/]
    }
  })
}
```
ç›¸æ¯”äºæ‰‹åŠ¨æ“ä½œä¾èµ–å…³ç³»ï¼Œä½¿ç”¨æ’ä»¶åªéœ€å‡ è¡Œé…ç½®å°±èƒ½å®Œæˆï¼Œéå¸¸æ–¹ä¾¿ã€‚å½“ç„¶ï¼Œè¿™ä¸ªæ’ä»¶è¿˜å¯ä»¥æ”¯æŒå¤šç§æ‰“åŒ…ç­–ç•¥ï¼ŒåŒ…æ‹¬ unbundle æ¨¡å¼æ‰“åŒ…ï¼Œä½ å¯ä»¥å» [ä½¿ç”¨æ–‡æ¡£](https://github.com/sanyuan0704/vite-plugin-chunk-split/blob/master/README-CN.md) æ¢ç´¢æ›´å¤šä½¿ç”¨å§¿åŠ¿ã€‚

## å°ç»“
æ­å–œä½ ï¼Œå­¦ä¹ å®Œäº†æœ¬å°èŠ‚çš„å†…å®¹ï¼Œæˆ‘ä»¬æœ€åæ¥å°ç»“å’Œå›é¡¾ä¸€ä¸‹ã€‚åœ¨æœ¬å°èŠ‚ï¼Œä½ éœ€è¦é‡ç‚¹æŒæ¡**æ‹†åŒ…çš„æ„ä¹‰**ã€**Vite ä¸­çš„é»˜è®¤æ‹†åŒ…ç­–ç•¥**å’Œ**è‡ªå®šä¹‰æ‹†åŒ…æ–¹æ³•**ã€‚

é¦–å…ˆæˆ‘ç»™ä½ åˆ†æäº†æ‹†åŒ…æŠ€æœ¯æ‰€è§£å†³çš„é—®é¢˜ï¼Œä¸»è¦åŒ…æ‹¬**æ— æ³•æŒ‰éœ€åŠ è½½**ä»¥åŠ**çº¿ä¸Šç¼“å­˜å‘½ä¸­ç‡ä½**ä¸¤ä¸ªé—®é¢˜ï¼Œç„¶åæˆ‘ä»¬ä¸€èµ·é€šè¿‡å…·ä½“çš„é¡¹ç›®ç¤ºä¾‹å°è¯•äº† Vite é»˜è®¤çš„æ‹†åŒ…ç­–ç•¥ï¼Œä½†é»˜è®¤çš„ç­–ç•¥ä¹Ÿæ˜¯æœ‰ç¼ºé™·çš„ï¼Œæ¯”å¦‚å¯¹ç¬¬ä¸‰æ–¹åŒ…æ¨¡å—æ— æ³•åšè¿›ä¸€æ­¥çš„æ‹†åŒ…ï¼Œè¿™å°±éœ€è¦æˆ‘ä»¬è‡ªå®šä¹‰æ‹†åŒ…ç­–ç•¥äº†ã€‚

ç”±äº Vite ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ Rollup è¿›è¡Œæ‰“åŒ…ï¼Œåœ¨åç»­çš„å†…å®¹æˆ‘ä»¬æ·±å…¥å­¦ä¹ äº† Rollup åº•å±‚çš„æ‹†åŒ… APIâ€”â€”`manualChunks`ï¼Œç”¨`å¯¹è±¡é…ç½®`å’Œ`å‡½æ•°é…ç½®`ä¸¤ç§æ–¹å¼æ¥è‡ªå®šä¹‰æ‹†åŒ…ç­–ç•¥ï¼Œå¯¹è±¡é…ç½®ä½¿ç”¨ä¸Šæ¯”è¾ƒç®€å•ï¼Œä½†å‡½æ•°é…ç½®æ›´åŠ çµæ´»ã€‚éšåæˆ‘å’Œä½ åˆ†æäº†å‡½æ•°é…ç½®ä¸­å®¹æ˜“é‡åˆ°çš„å‘â€”â€”chunk å¾ªç¯ä¾èµ–é—®é¢˜ï¼Œå¹¶åˆ†äº«äº†æˆ‘çš„è§£å†³æ€è·¯å’Œæ–¹æ¡ˆã€‚ä¸è¿‡ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå¤§å®¶å°†`manualChunks`é…ç½®ä¸ºä¸€ä¸ªå¯¹è±¡å³å¯ï¼Œå¦‚æœéœ€è¦è¿›è¡Œæ·±åº¦çš„æ‹†åŒ…ä¼˜åŒ–å¯ä»¥é‡‡ç”¨å‡½æ•°çš„æ–¹å¼ï¼Œç›¸ä¿¡ç»è¿‡ä»Šå¤©çš„å­¦ä¹ ä½ ä¹Ÿèƒ½å¾ˆå¥½åœ°é©¾é©­å‡½æ•°æ‹†åŒ…é…ç½®ã€‚

æœ€åï¼Œæ¬¢è¿ä½ åœ¨è¯„è®ºåŒºè®°å½•ä½ çš„å­¦ä¹ å¿ƒå¾—å’Œæ”¶è·ï¼Œä¹Ÿæ¬¢è¿å’Œæˆ‘ä¸€èµ·è®¨è®ºã€‚æˆ‘ä»¬ä¸‹ä¸€èŠ‚å†è§ğŸ‘‹ğŸ»ã€‚


> æ‰©å±•é˜…è¯»: [é˜®ä¸€å³° ECMAScript 6 å…¥é—¨â€”â€”æ¨¡å—å¾ªç¯ä¾èµ–åŠ è½½](http://es6.ruanyifeng.com/#docs/module-loader#%E5%BE%AA%E7%8E%AF%E5%8A%A0%E8%BD%BD)