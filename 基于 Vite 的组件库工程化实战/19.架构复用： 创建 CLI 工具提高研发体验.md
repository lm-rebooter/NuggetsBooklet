å‰é¢çš„ç« èŠ‚ä¸€ç›´éƒ½æ˜¯åœ¨æ•™å¤§å®¶æ­å»ºå·¥ç¨‹ã€‚å¤§å®¶ä¸€å®šè§‰å¾—éå¸¸è¾›è‹¦ï¼Œä¸€ç›´åœ¨è·³å‘ã€‚å³ä½¿ç„¶å”çš„æè¿°å†ç²¾ç¡®ï¼Œç”±äºç‰ˆæœ¬å’Œå„ç§ä¸å¯é¢„çŸ¥çš„åŸå› ï¼Œéƒ½ä¼šé€ æˆå„ç§å„æ ·çš„é—®é¢˜ã€‚ä¸€ä¸ªé¡¹ç›®ä¸­æ­å»ºæ¡†æ¶çš„äººå°±å¥½æ¯”é¡¹ç›®çš„å¼€è·¯å…ˆé”‹ï¼Œä»–è·³å‘æ˜¯ä¸ºäº†ä¸è®©åˆ«äººç»§ç»­è·³å‘ã€‚

é‚£ä¹ˆæ€æ ·è®©æ­å»ºçš„å·¥ç¨‹æ¡†æ¶å¤ç”¨èµ·æ¥ï¼Œè®©å¤§éƒ¨é˜Ÿäº«å—å¼€è·¯å…ˆé”‹åˆ›é€ çš„å·¥ç¨‹æˆæœå‘¢ï¼Ÿ ç­”æ¡ˆå°±æ˜¯è„šæ‰‹æ¶å·¥å…·ã€‚æ¯”å¦‚ Vue æœ‰ vue-cliï¼ŒReact æœ‰ create-react-app ç­‰ã€‚è¿™èŠ‚è¯¾æˆ‘ä»¬å°±å­¦ä¹ å¦‚ä½•åˆ›å»ºè„šæ‰‹æ¶ç¨‹åºã€‚

å¯¹äºä¸€ä¸ªç»„ä»¶åº“æ¥è®²ï¼Œè„šæ‰‹æ¶ä¸€èˆ¬åˆ†ä¸ºä¸¤ç§ï¼š

- Create-smarty-ui-app  :  åˆ›å»ºä½¿ç”¨ Smarty-UI ç»„ä»¶åº“çš„ç¨‹åºçš„è„šæ‰‹æ¶ï¼›

- Create-xxx-ui ï¼š åˆ›å»ºå’Œ Smarty-UI ç±»ä¼¼çš„ç»„ä»¶åº“çš„è„šæ‰‹æ¶ï¼Œä¹Ÿå°±æ˜¯å¤ç”¨æˆ‘ä»¬ä¸Šé¢çš„æ¶æ„ã€‚

å®é™…ä¸Šè¿™ä¸¤ç§è„šæ‰‹æ¶åŸç†å’ŒåŠŸèƒ½éƒ½éå¸¸ç›¸ä¼¼ã€‚æˆ‘ä»¬å°±ä»¥ç¬¬ä¸€ç§ä¸ºä¾‹å­ç»™å¤§å®¶ä»‹ç»å¦‚ä½•ç¼–å†™è„šæ‰‹æ¶ç¨‹åºã€‚

## ç”¨æˆ·æ•…äº‹(UserStory)

ç¼–å†™ä¸€ä¸ª Create-smarty-ui-app è„šæ‰‹æ¶ç¨‹åºï¼Œ è®©ç”¨æˆ·å¯ä»¥è½»æ¾æ­å»ºä½¿ç”¨ Smarty-UI çš„åº”ç”¨ç¨‹åºã€‚

## ä»»åŠ¡åˆ†è§£(Task)

- åˆ›å»ºæ¨¡ç‰ˆé¡¹ç›®ï¼›

- åˆå§‹åŒ– CLI é¡¹ç›®ï¼›

- åˆ›å»ºå‘½ä»¤è¡Œç•Œé¢ï¼›

- å…‹éš†é¡¹ç›®æ¨¡ç‰ˆï¼›

- æ¨¡ç‰ˆç”Ÿæˆä»£ç ï¼›

- ä¸Šä¼  Npm ä»“åº“ã€‚

### CLI ä¸ è„šæ‰‹æ¶çš„æ¦‚å¿µ

ç”¨æƒ¯äº† vue-cli æˆ–è€… create-react-app çš„å‰ç«¯äººå¯èƒ½éƒ½ä¼šè®¤ä¸ºï¼Œcli ä¸è„šæ‰‹æ¶æ˜¯ä¸€ä¸ªæ¦‚å¿µã€‚å…¶å®å®ƒä»¬å‡ ä¹æ˜¯é›·é”‹å’Œé›·å³°å¡”çš„å…³ç³»ã€‚

![img](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/17740a49f98b4aac953beb61711ccb67~tplv-k3u1fbpfcp-zoom-1.image)

å…ˆè®²è®²è„šæ‰‹æ¶ï¼Œè„šæ‰‹æ¶çš„æ¦‚å¿µæ¥è‡ªäºå·¥ç¨‹ã€‚è„šæ‰‹æ¶å°±æ˜¯ä¸ºäº†å·¥ç¨‹é¡ºåˆ©è¿›è¡Œè€Œæ­å»ºçš„å·¥ç¨‹å¹³å°ã€‚ç”¨åœ¨è½¯ä»¶å¼€å‘ä¸­ï¼Œå°±æ˜¯å¸®åŠ©å¼€å‘è¿‡ç¨‹çš„å·¥å…·å’Œç¯å¢ƒé…ç½®çš„é›†åˆã€‚ç®€å•æ¥è¯´ï¼Œç›®å‰ç»„ä»¶åº“çš„çŠ¶æ€å°±æ˜¯ä¸€ä¸ªè„šæ‰‹æ¶ã€‚è™½ç„¶åªæœ‰ä¸€ä¸ªç»„ä»¶ï¼Œä½†æ˜¯ä¸ºç»„ä»¶åº“çš„ç¯å¢ƒé…ç½®å’Œå·¥å…·å·²ç»æ•´åˆå®Œæˆäº†ã€‚è¿™å°±å¥½åƒä¸€ä¸ªé«˜æ¥¼æ­å»ºå‰æ­å»ºçš„è„šæ‰‹æ¶å·²ç»å®Œæˆä¸€æ ·ï¼Œå¦å¤–åªæœ‰ä¸€ä¸ªæ ·æ¿é—´ã€‚

![img](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3b0005d8e0f7488fa0d9ae86ce9e376a~tplv-k3u1fbpfcp-zoom-1.image)

å…¶æ¬¡è¯´ä¸€ä¸‹ CLI å·¥å…·æ˜¯ä»€ä¹ˆã€‚ CLI æ˜¯è‹±æ–‡ command-line interface çš„ç®€å†™ï¼Œç¿»è¯‘ä¸ºå‘½ä»¤è¡Œç•Œé¢ã€‚ä¹Ÿå°±æ˜¯åªåœ¨ç”¨æˆ·æç¤ºç¬¦ä¸‹é”®å…¥å¯æ‰§è¡Œå‘½ä»¤çš„ç•Œé¢ã€‚é€šå¸¸è„šæ‰‹æ¶ç¨‹åºä¼šé€šè¿‡ CLI çš„å½¢å¼å°è£…ï¼Œè¿™æ ·åšæ›´åŠ ç¬¦åˆç¨‹åºå‘˜çš„ä¹ æƒ¯ï¼Œç›¸æ¯”å¼€å‘å®Œæ•´çš„ UI å¼€å‘æ•ˆç‡æ›´é«˜ã€‚æ‰€ä»¥ç›®å‰çœ‹åˆ°çš„å¤§å¤šæ•°è„šæ‰‹æ¶éƒ½æ˜¯ä»¥ CLI å·¥å…·çš„å½¢å¼å°è£…çš„ã€‚ä¹…è€Œä¹…ä¹‹ï¼Œå¤§å®¶ä¹Ÿå°±æ¯”è¾ƒä¹ æƒ¯å°† CLI ä¸è„šæ‰‹æ¶æ··ä¸ºåœ¨ä¸€èµ·äº†ã€‚

æ˜ç™½äº†æ¦‚å¿µåæˆ‘ä»¬æ­£å¼å¼€å§‹ã€‚

è¿™æ¬¡æˆ‘ä»¬è¦å¼€å‘çš„è„šæ‰‹æ¶ create-smarty-app ï¼ŒåŠŸèƒ½æ˜¯å¯ä»¥å¿«é€Ÿåˆ›å»ºä¸€ä¸ªä½¿ç”¨ Smarty-UI å¼€å‘çš„é¡¹ç›®æ¨¡ç‰ˆã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå‡è®¾ä½ æƒ³ä½¿ç”¨ smarty-ui å¼€å‘é¡¹ç›®ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨è„šæ‰‹æ¶åˆ›å»ºä¸€ä¸ªç©ºçš„é¡¹ç›®ï¼Œé‡Œé¢åŒ…å«çš„ vite + vue3 + smarty-ui ç»„ä»¶ã€‚ç›´æ¥å¼€å‘é€»è¾‘å°±å¥½äº†ã€‚

å½“ç„¶è¿™ä¸ªåŠŸèƒ½è¿˜æ¯”è¾ƒåˆçº§ï¼Œåç»­è¿˜å¯ä»¥ä¸æ–­è¿­ä»£ã€‚ä½†æ˜¯éº»é›€è™½å°äº”è„ä¿±å…¨ï¼ŒåŸºæœ¬ä¸Šè¿™é‡Œé¢ä¼šå°†è„šæ‰‹æ¶å·¥å…·æ‰€ä½¿ç”¨çš„å·¥å…·éƒ½ä¼šæ¼”ç¤ºä¸€éã€‚

ä¸€èˆ¬ä¸€ä¸ªè„šæ‰‹æ¶é¡¹ç›®ä¼šæœ‰ä¸¤éƒ¨åˆ†ç»„æˆï¼š

- Template é¡¹ç›®ï¼š é¡¹ç›®çš„æ¨¡ç‰ˆï¼›

- CLI å·¥å…·é¡¹ç›®ï¼š æä¾›å‘½ä»¤è¡Œç•Œé¢ç”¨äºå…‹éš†é¡¹ç›®ï¼Œç”Ÿæˆä»£ç ã€è‡ªåŠ¨é…ç½®ã€è¿è¡Œè°ƒè¯•ã€å‘å¸ƒç­‰åŠŸèƒ½ã€‚

å…¶å®æœ‰å…´è¶£çš„åŒå­¦å¯ä»¥çœ‹ä¸€ä¸‹ vue-cli ï¼Œå®ƒå°±æ˜¯è¿™æ ·å·¥ä½œçš„ã€‚ç”šè‡³ä½ å¯ä»¥åˆ†æä¸€ä¸‹æºç ï¼Œæ‰¾æ‰¾ vue-cli çš„æ¨¡ç‰ˆé¡¹ç›®æ”¾åœ¨ Github çš„ä»€ä¹ˆä½ç½®ã€‚

### åˆ›å»ºæ¨¡ç‰ˆé¡¹ç›®

è¿™ä¸€æ­¥ï¼Œä¸»è¦å°±æ˜¯åˆ›å»ºä¸€ä¸ªç¨‹åºçš„æ¨¡ç‰ˆã€‚å…¶å®å°±æ˜¯ä»é›¶æ­å»ºä¸€ä¸ªVue3 + Vite ç¯å¢ƒå¹¶ä¸”å¼•å…¥ Smarty-UIã€‚

é¦–å…ˆï¼Œé€‰æ‹©ä½¿ç”¨ vite-cli å·¥å…·ç›´æ¥æ­å»ºé¡¹ç›®ã€‚

- Vite  å¯åŠ¨ï¼›

- ä½¿ç”¨ Javascript è¯­è¨€ï¼›

- å…¨å±€å¼•å…¥ Samrty-UIã€‚

è¿™ä¸ªè¿‡ç¨‹å…¶å®å°±æ˜¯ä½¿ç”¨ Vite è„šæ‰‹æ¶å·¥å…·æ­å»ºä¸€ä¸ª vue3 é¡¹ç›®ï¼Œç„¶åå¼•å…¥ smarty-ui ç»„ä»¶ã€‚

è¯¦ç»†è¿‡ç¨‹ä¸å†èµ˜è¿°ï¼Œå¯ä»¥å‚è€ƒä»£ç ã€‚

https://github.com/smarty-team/smarty-ui-app-js-template

è¿™ä¸ªæ¨¡ç‰ˆå·¥ç¨‹æ­å»ºä¹Ÿå¯ä»¥æ ¹æ®å–œå¥½åŠ å…¥ä¸€ä¸‹ä¸ªæ€§åŒ–çš„ä»£ç ã€‚

### åˆå§‹åŒ– CLI é¡¹ç›®

æœ‰äº†æ¨¡ç‰ˆé¡¹ç›®ï¼Œæ¥ä¸‹æ¥éœ€è¦åˆ›å»ºè„šæ‰‹æ¶ã€‚

è„šæ‰‹æ¶ä¸»è¦çš„è¿è¡Œè¿‡ç¨‹å¦‚ä¸‹ã€‚

- æä¾›å‘½ä»¤è¡Œç•Œé¢ï¼š
  - é€‰æ‹©ä»£ç æ¨¡ç‰ˆ ï¼›
  - å¡«å†™é¡¹ç›®åç§°ã€‚

- å…‹éš†æ¨¡ç‰ˆé¡¹ç›®ï¼›

- æ ¹æ®é¡¹ç›®åç§°åŠå…¶ä»–é…ç½®ç”Ÿæˆä»£ç ã€‚

è¿™ä¸€æ­¥çš„ç›®çš„ä¸»è¦æ˜¯æ­å»ºä¸€ä¸ªåŸºç¡€çš„ CLI ç¯å¢ƒã€‚ä¹Ÿå°±æ˜¯å¯ä»¥ç”¨ä¸€ä¸ªå…¨å±€å‘½ä»¤è°ƒç”¨åˆ° CLI å·¥å…·çš„ JS ç¨‹åºã€‚ CLI å·¥å…·æ˜¯å¯ä»¥åœ¨å…¨å±€æ‰§è¡Œçš„ç¨‹åºã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå°† npm è½¯ä»¶åŒ…ä¸­çš„ä¸€ä¸ª JS æ–‡ä»¶æ³¨å†Œåˆ°å…¨å±€ã€‚

ä¸‹é¢è®²ä¸€ä¸‹åŸºæœ¬åŸç†ï¼Œæ¯”å¦‚ï¼š å…¨å±€å®‰è£… vue-cliã€‚

```Bash
sudo npm i @vue/cli -g
```

ä»¥ Mac ä¸ºä¾‹ã€‚npm é¦–å…ˆä¼šæŠŠè½¯ä»¶åŒ…ä¸‹è½½åˆ° /lib/node_modules/@vue/cli ç›®å½•ä¸‹ã€‚ç„¶å npm ä¼šæ ¹æ® @vue/cli è½¯ä»¶åŒ…ä¸­ package.json çš„ bin å­—æ®µä¸­çš„é…ç½®ï¼Œå°† bin/vue.js æ–‡ä»¶è½¯è¿æ¥åˆ° /usr/local/bin ä¸­å»ã€‚

![img](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a76d520f05b24769849f6b2fec3de525~tplv-k3u1fbpfcp-zoom-1.image)

ä½ å¯ä»¥ä½¿ç”¨ ls -l æŸ¥çœ‹ä¸€ä¸‹ï¼š

```Bash
ls -l /usr/local/bin
```

![img](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6d6b156dc9c0498dbd515740ccfc0d9d~tplv-k3u1fbpfcp-zoom-1.image)

è¿™ä¸ªæ—¶å€™ä½ å°±å¯ä»¥å…¨å±€æ‰§è¡Œ vue è¿™ä¸ªå‘½ä»¤äº†ã€‚

![img](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/380195e38d394cc5863b5255e2685175~tplv-k3u1fbpfcp-zoom-1.image)

å…¶ä»–æ“ä½œç³»ç»ŸåŸç†ç±»ä¼¼ï¼Œå¤§å®¶å¯ä»¥è‡ªè¡Œæ¢ç´¢ã€‚è¿™ä¸ªè¿‡ç¨‹å®é™…ä¸Šæ˜¯ npm åŒ…ç®¡ç†å·¥å…·å¸®ä½ å®ç°çš„ï¼Œå¤§å®¶ä¸ç”¨è¿‡å¤šå…³å¿ƒã€‚

å¼„æ¸…æ¥šäº†åŸºæœ¬åŸç†ï¼Œä¸‹é¢è¿˜æœ‰ä¸€ä¸ªé—®é¢˜éœ€è¦è§£å†³ã€‚è¿™ä¸ªé—®é¢˜å°±æ˜¯éœ€è¦æä¾›ä¸€ç§è°ƒè¯•CLIå·¥å…·çš„æ–¹æ³•ã€‚æ˜¾ç„¶åœ¨è°ƒè¯•ä»£ç æ—¶ï¼Œå°†ä»£ç ä¸æ–­ä¸Šä¼ åˆ° npm ä»“åº“ç„¶åå†å…¨å±€å®‰è£…å¤ªç¹çäº†ã€‚è§£å†³çš„åŠæ³•å°±æ˜¯ä½¿ç”¨ npm link æ¥æ¨¡æ‹Ÿè¿™ä¸ªè½¯è¿æ¥è¿‡ç¨‹ã€‚ä¹Ÿå°±æ˜¯è¯´ npm link å°±æ˜¯åœ¨æ¨¡æ‹Ÿå…¨å±€å®‰è£…ã€‚

ä¸‹é¢å¼€å§‹å®é™…æ“ä½œã€‚

é¦–å…ˆåˆ›å»ºé¡¹ç›®ã€‚åœ¨ packages ç›®å½•ä¸‹åˆ›å»º cli é¡¹ç›®ã€‚

```Bash
mkdir create-smarty-app-cli
cd create-smarty-app-cli
pnpm init
```

åœ¨ packages/create-smarty-app-cli/bin ä¸­æ·»åŠ ä¸€ä¸ª index.js ä½œä¸ºæ–‡ä»¶çš„å…¥å£ã€‚

```Bash
#!/usr/bin/env node
console.log('create-smarty ....')
```

è¿™é‡Œé¢ç¬¬ä¸€è¡Œ #!/usr/bin/env node ï¼Œè¿™ä¸ªè¦è®²ä¸€ä¸‹å®ƒçš„åŠŸèƒ½ã€‚é¦–å…ˆè¿™ä¸ª index.js ç¨‹åºä¸æ˜¯å¸¸è§„çš„ä½¿ç”¨ node xxx å‘½ä»¤æ‰§è¡Œã€‚è€Œæ˜¯éœ€è¦é€šè¿‡ source xxx æˆ–  ./xxx æ¥æ‰§è¡Œã€‚ä¹Ÿå°±æ˜¯åƒä¸€ä¸ª shell è„šæœ¬ä¸€æ ·æ‰§è¡Œã€‚è¿™æ—¶å€™å°±å‡ºç°äº†ä¸€ä¸ªé—®é¢˜ï¼Œä¸€ä¸ª JS ä»£ç æ˜¯ä¸èƒ½å¤Ÿç›´æ¥ä»¥è¿™ç§å½¢å¼æ‰§è¡Œçš„ã€‚é‚£ä¹ˆè¿™ä¸ªæ—¶å€™å°±éœ€è¦ä¸Šè¿°è¯­å¥æ¥å£°æ˜è§£é‡Šå™¨ç±»å‹ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ‰§è¡Œè¯¥ä»£ç éœ€è¦ä½¿ç”¨ node å½“åšè§£é‡Šå™¨è¾…åŠ©ã€‚

åœ¨ package.json ä¸­æ·»åŠ ä¸€ä¸ª bin å±æ€§ï¼Œå£°æ˜æ³¨å†Œä¸€ä¸ªå« create-smarty çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚

```JSON
{
  "name": "create-smarty-app",
  "version": "0.1.0",
  "description": "",
  "main": "index.js",
  "type": "module",
  "bin": {
    "create-smarty": "./bin/index.js"
  },
}
```

å¹¶ä¸”å°† type è®¾ç½®ä¸º module ã€‚è¿™ä¹ˆåšçš„ç›®çš„æ˜¯åœ¨ Node ç¯å¢ƒä¸­ä½¿ç”¨ esm æ¨¡å—è§„èŒƒã€‚è¿™æ ·å°±å¯ä»¥ä½¿ç”¨ import å’Œ export å¯¼å…¥å¯¼å‡ºæ¨¡å—äº†ã€‚

è„šæœ¬ç¼–å†™è™½ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨ Typescript ã€‚ä¸ºäº†æ–¹ä¾¿ï¼Œè¿™æ¬¡æˆ‘ä»¬ä½¿ç”¨ JS ç¼–å†™ã€‚

ç¼–å†™å®Œæˆåè¿è¡Œ npm link æ¨¡æ‹Ÿå…¨å±€å®‰è£…çš„æ•ˆæœã€‚

```Bash
# åœ¨ packages/create-smarty-app-cli ç›®å½•ä¸‹
sudo npm link
```

è¿™ä¸ªæ—¶å€™å¯ä»¥åœ¨ä»»ä½•ä¸€ä¸ªç›®å½•ä¸‹æ‰§è¡Œå‘½ä»¤ã€‚

```Bash
create-smarty
```

![img](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5c29d180efb6400fae5657227ccef7a2~tplv-k3u1fbpfcp-zoom-1.image)

æ—¥å¿—æ­£ç¡®è¾“å‡ºï¼Œæ ‡å¿—ç€ CLI å·¥å…·æ¡†æ¶åˆå§‹åŒ–å®Œæ¯•ã€‚ 

### åˆ›å»ºå‘½ä»¤è¡Œç•Œé¢

ä¸‹ä¸€æ­¥ï¼Œå°±æ˜¯æ‰“é€ ä¸€ä¸ªå‘½ä»¤è¡Œç•Œé¢ã€‚å‘½ä»¤è¡Œç•Œé¢çš„æ„ä¹‰åœ¨äºå¯ä»¥è®©ç”¨æˆ·å®šåˆ¶è‡ªå·±éœ€è¦çš„ç¨‹åºã€‚

æ¯”å¦‚ï¼š vue-cli å¯ä»¥é€‰æ‹©éœ€è¦çš„ ts/js è¯­è¨€ã€æ˜¯å¦éœ€è¦ router ä¸ vuex ã€æ˜¯å¦éœ€è¦ eslint ç­‰ã€‚

å…·ä½“åˆ°è¿™ä¸ª CLI çš„éœ€æ±‚ï¼Œéœ€è¦å®ç°é€‰æ‹©å¤šç§æ¨¡ç‰ˆåŠŸèƒ½ã€‚

Vue-cli è¿™æ ·çš„é€šç”¨è„šæ‰‹æ¶æä¾›å¤šç§å¯é€‰é¡¹ã€‚ä½†æ˜¯å®ƒä»˜å‡ºçš„ä»£ä»·ï¼Œå°±æ˜¯å®ç°é€»è¾‘å¤æ‚ä¸”å®¹æ˜“å‡ºé”™ã€‚è€Œåœ¨ä¼ä¸šå†…éƒ¨çš„è„šæ‰‹æ¶ï¼Œæ›´å¤šçš„æ˜¯éœ€è¦æ›´ä¸ºç®€å•é«˜æ•ˆçš„åŠŸèƒ½ï¼Œå¹¶ä¸éœ€è¦èŠ±é‡Œèƒ¡å“¨ã€‚æ¯”å¦‚æˆ‘å¾ˆå°‘å¬è¯´ä¸€ä¸ªå›¢é˜Ÿä¼šåœ¨ TSã€JS è¯­è¨€ä¸­é€‰æ‹©ã€‚åˆæˆ–è€…æœ‰äº›é¡¹ç›®ä½¿ç”¨ eslintï¼Œè€Œæœ‰äº›ä¸ä½¿ç”¨ã€‚å½“ç„¶å­¦ä¼šäº†åŸºæœ¬æ“ä½œï¼Œä½ æƒ³å®ç°æ›´å¤æ‚çš„åŠŸèƒ½ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚

![img](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/95fc9d7e888849058393e6c3a395aa80~tplv-k3u1fbpfcp-zoom-1.image)

é¦–å…ˆæ‰“å°ä¸€ä¸ªæ¬¢è¿ç•Œé¢ï¼Œè¿™ä¸ªåŠŸèƒ½æ˜¯ä½¿ç”¨ clearã€chalk-animation  ä¸ figlet åˆä½œå®Œæˆã€‚

- Clear æ¸…é™¤å±å¹•ï¼›

- Figlet æä¾›ç‚«é…·çš„æ–‡å­—æ•ˆæœï¼›

- Chalk-animation æä¾›å‘½ä»¤è¡ŒåŠ¨ç”»ä¸æ¸å˜é¢œè‰²ã€‚

```Bash
pnpm i figlet@"1.5.2" clear@"0.1.0" chalk-animation@"2.0.2" 
import figlet from "figlet";
import clear from "clear";
import chalkAnimation from "chalk-animation";

// æ‰“å°æ¬¢è¿ç”»é¢
clear();
const logo = figlet.textSync("Smarty UI!", {
  // font: "Ghost",
  horizontalLayout: "default",
  verticalLayout: "default",
  width: 80,
  whitespaceBreak: true,
});

const rainbow = chalkAnimation.rainbow(logo);
setTimeout(() => {
  rainbow.stop(); // Animation stops
}, 500);
```

ç„¶åæ˜¯å‘½ä»¤è¡Œé€‰é¡¹ï¼Œè¿™ä¸ªä½¿ç”¨ inquirer è¿™ä¸ªåº“å®Œæˆã€‚å®ƒä¼šæ ¹æ®é…ç½®æ˜¾ç¤ºç•Œé¢å¹¶æŠŠç»“æœè¿”å›ä¸º jsonã€‚

åé¢é€šè¿‡è¿”å›ç»“æœåŠ¨æ€ import å¯¼å…¥éœ€è¦çš„æ¨¡å—ï¼Œè¿™æ ·å°±å®ç°äº†æ ¹æ®é€‰é¡¹è¿è¡Œä¸åŒçš„åˆå§‹åŒ–æ¨¡å—ã€‚

```Bash
pnpm i chalk@"5.0.1" inquirer@"9.1.0"
#!/usr/bin/env node

import { promisify } from "util";
import figlet from "figlet";
import clear from "clear";
import chalk from "chalk";
import inquirer from "inquirer";
import chalkAnimation from "chalk-animation";

const log = (content) => console.log(chalk.green(content));
const opt = {
  "SmartyUIåº”ç”¨æ¨¡ç‰ˆ(Vite)": "smarty-ui-vite",
  SmartyAdminæ¨¡ç‰ˆ: "admin",
  ç»„ä»¶åº“è„šæ‰‹æ¶: "uitemplate",
  ç»„ä»¶åº“æ–‡æ¡£ç½‘ç«™: "uitemplate",
  é€€å‡º: "quit",
};

const question = [
  {
    type: "rawlist" /* é€‰æ‹©æ¡† */,
    message: "è¯·é€‰æ‹©è¦åˆ›å»ºçš„é¡¹ç›®ï¼Ÿ",
    name: "operation",
    choices: Object.keys(opt),
  },
];

// æ‰“å°æ¬¢è¿ç”»é¢
clear();
const logo = figlet.textSync("Smarty UI!", {
  // font: "Ghost",
  horizontalLayout: "default",
  verticalLayout: "default",
  width: 80,
  whitespaceBreak: true,
});

const rainbow = chalkAnimation.rainbow(logo);
setTimeout(() => {
  rainbow.stop(); // Animation stops
  query();
}, 500);


async function query() {
  const answer = await inquirer.prompt(question);

  if (answer.operation === "é€€å‡º") return;

  const { default: op } = await import(
    `../lib/operations/${opt[answer.operation]}.js`
  );
  await op();
}
```

### å…‹éš†é¡¹ç›®æ¨¡ç‰ˆ

é¡¹ç›®çš„ä¸»ä½“ä¸€èˆ¬éƒ½æ˜¯é€šè¿‡ä» Github ç›´æ¥æ‹‰å–çš„å½¢å¼ã€‚åªæœ‰å°‘éƒ¨åˆ†éœ€è¦ä¿®æ”¹çš„ä»£ç ä½¿ç”¨ä»£ç æ¨¡ç‰ˆç”Ÿæˆçš„æ–¹å¼å®ç°ã€‚ ä½ ç†Ÿæ‚‰çš„ vue-cliã€create-react-app ä¹Ÿéƒ½æ˜¯ä¸€æ ·çš„åŸç†ã€‚

é¦–å…ˆä½¿ç”¨ download-git-repo è¿™ä¸ªåº“å®Œæˆå…‹éš†ã€‚ å…‹éš†æ˜¯ä¸€ä¸ªæ¼«é•¿çš„å¼‚æ­¥æ‰§è¡Œè¿‡ç¨‹ï¼Œå¯èƒ½ä¼šæŒç»­æ•°ç§’åˆ°å‡ åˆ†é’Ÿã€‚è¿™ä¸ªæ—¶å€™ä¸ºäº†ä¼˜åŒ–ç”¨æˆ·ä½“éªŒï¼Œä¸è¦è®©ç”¨æˆ·è®¤ä¸ºç¨‹åºæ­»æ‰äº†ï¼Œå°±éœ€è¦ä¸€ä¸ªè¿›åº¦æ¡è¡¨ç¤ºä¸€ç›´åœ¨åŠ è½½ã€‚æ¯”å¦‚ï¼š ora è¿™åº“ã€‚ä¸‹é¢æ˜¯ä»£ç å®ç°ã€‚

é¦–å…ˆç¼–å†™ä¸€ä¸ªè¿›åº¦æ¡å’Œ git ä¸‹è½½ç»“åˆçš„ clone å‡½æ•°ã€‚

```Bash
pnpm i ora@"6.1.2" download-git-repo@"3.0.2"
```

lib/utils/clone.js

```JavaScript
import { promisify } from "util";
import download from "download-git-repo";
import ora from "ora";
export default async (repo, desc) => {
  const process = ora(`ä¸‹è½½.....${repo}`);
  process.start();
  await promisify(download)(repo, desc);
  process.succeed();
};
```

ç„¶åç¼–å†™å…‹éš†è¿‡ç¨‹ï¼Œè¿™ä¸ªé‡Œé¢è¿˜éœ€è¦ä¸€ç‚¹äº¤äº’é—®ä¸€ä¸‹å®ƒçš„é¡¹ç›®åç§°ã€‚å’Œä¸Šé¢åŠŸèƒ½ç›¸ä¼¼æˆ‘å°±ä¸è®²äº†ã€‚å¦å¤–ä¸ºäº†è®©æ—¥å¿—æœ‰é¢œè‰²ï¼Œä½¿ç”¨äº† chalk åŒ…ã€‚

operations/smarty-ui-vite.js

```JavaScript
import clone from "../utils/clone.js";
import inquirer from "inquirer";
import { resolve } from "path";
import fs from "fs";

import chalk from "chalk";
const log = (...args) => console.log(chalk.green(...args));

import handlebars from "handlebars";

export default async () => {
  const { name } = await inquirer.prompt([
    {
      type: "input" /* é€‰æ‹©æ¡† */,
      message: "è¯·è¾“å…¥é¡¹ç›®çš„åç§°ï¼Ÿ",
      name: "name",
    },
  ]);

  log("ğŸšŒ åˆ›å»ºé¡¹ç›®:" + name);
  
  log(`
ğŸ‘Œ å®‰è£…å®Œæˆï¼š
To get Start:
===========================
cd ${name}
npm i
npm run dev
===========================
            `);
};
```

![img](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2ff1af3bc37f4888b2928d77943a7fc9~tplv-k3u1fbpfcp-zoom-1.image)

### æ¨¡ç‰ˆç”Ÿæˆä»£ç 

é™¤äº†æ¨¡ç‰ˆåº“ä¸­çš„ä»£ç ï¼Œè¿˜æœ‰ä¸€äº›ä»£ç éœ€è¦è‡ªåŠ¨ç”Ÿæˆã€‚æ¯”å¦‚ï¼š ä½ å¸Œæœ›é¡¹ç›®åæ˜¾ç¤ºåœ¨é¡µé¢ä¸­ï¼Œåˆæ¯”å¦‚ä½ å¸Œæœ›æ ¹æ®é…ç½®å†³å®šåŠ è½½ä»€ä¹ˆæ ·çš„ vue æ’ä»¶ã€‚ è¿™ç›¸å½“äºåŠ¨æ€çš„æ‹¼è£…ä»£ç ï¼Œè¿™ä¸ªè¿‡ç¨‹å…¶å®å’Œå‰ç«¯ä½¿ç”¨ä¸€ä¸ªæ¨¡ç‰ˆåº“æ¸²æŸ“ html å¹¶æ²¡æœ‰ä»€ä¹ˆåŒºåˆ«ã€‚è¿™ä¸ªæ—¶å€™å¯ä»¥é€‰æ‹©ä¸€ä¸ªæ¨¡ç‰ˆåº“å®Œæˆï¼Œå¸¸ç”¨çš„æ˜¯ handlebars è¿™ä¸ªåº“ã€‚

å…·ä½“åˆ°æœ¬ç¨‹åºï¼Œåªæœ‰ä¸€ä¸ªæœ€ç®€å•çš„ä»£ç éœ€è¦æ¨¡ç‰ˆç”Ÿæˆã€‚package.json ä¸­çš„é¡¹ç›®åæ”¹å†™ä¸ºåŒ…åã€‚é¦–å…ˆåœ¨æ¨¡ç‰ˆé¡¹ç›® smarty-ui-app-js-template ä¸­åˆ›å»ºä¸€ä¸ª template æ–‡ä»¶å¤¹ã€‚ç„¶ååˆ›å»ºä¸€ä¸ª package.json æ¨¡ç‰ˆã€‚

![img](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ca0bc23d027e41599821a253477a23f7~tplv-k3u1fbpfcp-zoom-1.image)

è¿™ä¸ªæ¨¡ç‰ˆå’Œ package.json å‡ ä¹ä¸€æ ·ï¼Œåªæ˜¯å°† name å±æ€§çš„å€¼å˜æˆäº†è¡¨è¾¾å¼ã€‚

template/package.hbs.json

```JSON
{
  "name": "{{ name }}",
  "private": true,
  "version": "0.0.0",
  "type": "module",
  "scripts": {
    "dev": "vite",
    "build": "vite build",
    "preview": "vite preview"
  },
  "dependencies": {
    "smarty-ui-vite": "^0.1.4",
    "vue": "^3.2.37"
  },
  "devDependencies": {
    "@vitejs/plugin-vue": "^3.0.3",
    "vite": "^3.0.7"
  }
}
```

ä¸‹é¢å°±åœ¨ CLI å·¥å…·ä¸­ç¼–å†™é€šè¿‡ template ç”Ÿæˆ package.json çš„ä»£ç ã€‚

```JavaScript
import clone from "../utils/clone.js";
import inquirer from "inquirer";
import { resolve } from "path";
import fs from "fs";

import chalk from "chalk";
const log = (...args) => console.log(chalk.green(...args));

import handlebars from "handlebars";

export default async () => {
  const { name } = await inquirer.prompt([
    {
      type: "input" /* é€‰æ‹©æ¡† */,
      message: "è¯·è¾“å…¥é¡¹ç›®çš„åç§°ï¼Ÿ",
      name: "name",
    },
  ]);

  log("ğŸšŒ åˆ›å»ºé¡¹ç›®:" + name);

  // ä»githubå…‹éš†é¡¹ç›®åˆ°æŒ‡å®šæ–‡ä»¶å¤¹
  await clone("github:smarty-team/smarty-ui-app-js-template", name);

  // ç”Ÿæˆè·¯ç”±å®šä¹‰
  compile(
    {
      name,
    },
    `./${name}/package.json`,
    `./${name}/template/package.hbs.json`
  );

  log(`
ğŸ‘Œ å®‰è£…å®Œæˆï¼š
To get Start:
===========================
cd ${name}
npm i
npm run dev
===========================
            `);
};


/**
 * ç¼–è¯‘æ¨¡æ¿æ–‡ä»¶
 * @param meta æ•°æ®å®šä¹‰
 * @param filePath ç›®æ ‡æ–‡ä»¶è·¯å¾„
 * @param templatePath æ¨¡æ¿æ–‡ä»¶è·¯å¾„
 */
function compile(meta, filePath, templatePath) {
  if (fs.existsSync(templatePath)) {
    const content = fs.readFileSync(templatePath).toString();
    const result = handlebars.compile(content)(meta);
    fs.writeFileSync(filePath, result);
    log(`ğŸ“š ${filePath} ä¿®æ”¹æˆåŠŸ`);
  } else {
    log(`âŒ ${filePath} ä¿®æ”¹å¤±è´¥`);
  }
}
```

### ä¸Šä¼  Npm ä»“åº“

æœ€åä¸€æ­¥æ˜¯ä¸Šä¼  npm ä»“åº“ã€‚è¿™ä¸ªæ­¥éª¤è¿˜æ˜¯éœ€è¦ä½¿ç”¨ Github Action å®Œæˆã€‚è¿™ä¸€æ­¥å‰é¢å·²ç»è®²è¿‡ï¼Œä¸å†èµ˜è¿°ã€‚

.github/workflows/publish-smarty-ui-vite.yml

```YAML
name: Publish Smarty-ui-vite To Npm

on:
  push:
    branches: [publish-smarty-ui-vite]

jobs:
  publish:
    runs-on: ubuntu-latest

    name: "publish npm"

    environment: npm

    steps:
      - uses: actions/checkout@master
      - uses: pnpm/action-setup@v2.1.0
        with:
          version: 6.31.0
      - name: Install modules
        run: pnpm install
      - name: Build
        run: cd packages/smarty-ui-vite && npm run build
      - name: "Publish to the npm registry"
        uses: primer/publish@3.0.0
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          NPM_AUTH_TOKEN: ${{ secrets.NPM_AUTH_TOKEN }} # è·Ÿå‰é¢æ­¥éª¤ä¸­çš„ NPM_AUTH_TOKEN ä¿æŒä¸€è‡´
        with:
          default_branch: "publish-smarty-ui-vite"
          dir: "packages/smarty-ui-vite/dist"
```

## å¤ç›˜

è¿™èŠ‚è¯¾çš„ä¸»è¦å†…å®¹æ˜¯ä»‹ç»å¦‚ä½•ç¼–å†™ä¸€ä¸ª CLI å·¥å…·ã€‚

è™½ç„¶åªæ˜¯ä»‹ç»äº†ä¸€ä¸ªå¾ˆåŸºæœ¬çš„åŠŸèƒ½ï¼Œä½†æ˜¯æˆ‘åŠ›äº‰é€šè¿‡è¿™ä¸ªå®è·µå°†æœ€æ ¸å¿ƒçš„ CLI æŠ€æœ¯ä¼ æˆç»™å¤§å®¶ã€‚ å…¶å®æˆ‘è®¤ä¸º CLI å·¥å…·æœ€é‡è¦çš„åŠŸèƒ½æ˜¯è‡ªåŠ¨åŒ–ç”Ÿæˆä»£ç ï¼Œæ›¿ä»£äººå·¥åŠ³åŠ¨ï¼Œæ¯”å¦‚è‡ªåŠ¨æ ¹æ®è§†å›¾æ–‡ä»¶ç”Ÿæˆè·¯ç”±ã€‚é€šè¿‡è¿™èŠ‚è¯¾çš„å­¦ä¹ å¤§å®¶å¯ä»¥å°è¯•ä¸€ä¸‹è¿™ä¸ªåŠŸèƒ½ã€‚

æˆ‘å¸Œæœ›è¿™èŠ‚è¯¾å¯èƒ½èµ·åˆ°æŠ›ç –å¼•ç‰çš„ä½œç”¨ï¼Œæœ‰æ›´å¤šçš„è‡ªåŠ¨åŒ–çš„åŠŸèƒ½å¯ä»¥æ¶Œç°å‡ºæ¥ã€‚

æœ€åç•™ä¸€äº›æ‰©å±•ä»»åŠ¡ã€‚

- åˆ›é€ ä¸€ä¸ªè‡ªå·±çš„ CLI å·¥å…·ï¼›

- ä½¿ç”¨è‡ªåŠ¨åŒ–ç”Ÿæˆä»£ç åŠŸèƒ½è§£å†³ä¸€ä¸ªé¡¹ç›®çš„å®é™…é—®é¢˜ã€‚

ä¸‹èŠ‚è¯¾ï¼Œæˆ‘ä»¬å°†ç»™å¤§å®¶è®²è§£å¦‚ä½•å®ç° Vue-CLI æ’ä»¶è®© Smarty-UI èå…¥vue ç”Ÿæ€ï¼Œä¸‹èŠ‚è¯¾è§ã€‚ 

