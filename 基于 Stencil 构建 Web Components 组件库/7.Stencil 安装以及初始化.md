å‰é¢å‡ ç¯‡ä»‹ç»äº†ä¸€äº›ç»„ä»¶åº“å¿…å¤‡çš„åŸºç¡€çŸ¥è¯†å’Œæ ¸å¿ƒæ¡†æ¶çš„æ¦‚å¿µï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å¼€å§‹è¿›è¡Œæˆ‘ä»¬ç»„ä»¶éƒ¨åˆ†çš„å®æˆ˜å¼€å‘ã€‚æˆ‘ä»¬çš„æ ¸å¿ƒç›®æ ‡å°±æ˜¯æ‰“é€ ä¸€ä¸ªè·¨æ¡†æ¶çš„ç»„ä»¶åº“ï¼Œå¹¶å®ç°ä¸€äº›åŸºæœ¬ç»„ä»¶ï¼Œå®Œå–„é™æ€æ–‡æ¡£å’Œæµ‹è¯•ç”¨ä¾‹ã€‚

## Stencil å®‰è£…

æˆ‘ä»¬é¦–å…ˆå›å¿†ä¸‹åœ¨ [lerna ä»‹ç»](https://juejin.cn/book/7057481500421259300/section/7058097781579186206) çš„é‚£ä¸€ç« åˆå§‹åŒ–åçš„é¡¹ç›®ç›®å½•ç»“æ„ï¼š

```
â”œâ”€â”€ lerna.json

â”œâ”€â”€ package.json

â””â”€â”€ packages

    â”œâ”€â”€ sten-components

    â”œâ”€â”€ sten-icons

    â””â”€â”€ sten-themes
```

å…¶ä¸­ icons ç”¨äºå­˜æ”¾ icons ç›¸å…³çš„ç»„ä»¶ä¿¡æ¯ï¼Œthemes å­˜æ”¾ä¸»é¢˜æ ·å¼ scss ç›¸å…³ï¼Œcomponents ä¸»è¦å­˜æ”¾ç»„ä»¶çš„åŸºæœ¬é€»è¾‘ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬æœ€é‡è¦çš„ä¸€éƒ¨åˆ†ã€‚æˆ‘ä»¬é¦–å…ˆåœ¨ sten-components è¿™ä¸ª package ä¸‹æ¥å®‰è£…åˆå§‹åŒ–æˆ‘ä»¬çš„ Stencil æ¡†æ¶ã€‚

### å®‰è£…

Stencil å¯ä»¥ç”¨ npm init æŒ‡ä»¤è¿›è¡Œå®‰è£…åˆå§‹åŒ–ï¼Œ**ä½†æ˜¯ä½ çš„ npm ç‰ˆæœ¬å¿…é¡»å¤§äº 6ã€‚**

```
// npm >= 6

npm init stencil
```

æ­¤æ—¶ï¼Œæˆ‘ä»¬è¿›å…¥åˆ° packages æ‰€åœ¨æ–‡ä»¶å¤¹ï¼Œå…ˆåˆ é™¤æ‰ç¤ºä¾‹çš„ sten-components æ–‡ä»¶å¤¹ï¼Œé‡æ–°è¿›è¡Œåˆå§‹åŒ–ã€‚

```
cd packages/

rm -rf sten-components/ //å¦‚æœå­˜åœ¨



// åˆå§‹åŒ– Stencilï¼Œå› ä¸ºæˆ‘ä»¬ç”¨çš„ pnpm æ‰€ä»¥ï¼Œå¯ä»¥ä½¿ç”¨ pnpm åˆå§‹åŒ–

pnpm init stencil
```

æ¥ä¸‹æ¥ Stencil ä¼šæœ‰ä¸€äº›äº¤äº’æ€§çš„æŒ‡ä»¤ï¼Œå¸®åŠ©æˆ‘ä»¬åˆå§‹åŒ–æˆ‘ä»¬çš„é¡¹ç›®ï¼š

```
? Pick a starter â€º - Use arrow-keys. Return to submit.



â¯  component     Collection of web components that can be used anywhere

   app           Minimal starter for building a Stencil app or website
```

é¦–å…ˆæ€è€ƒçš„é—®é¢˜æ˜¯ï¼šæˆ‘ä»¬ç”¨å“ªç§æ¨¡å¼æ¥åˆå§‹åŒ–æˆ‘ä»¬çš„é¡¹ç›®ã€‚ç¬¬ä¸€ç§æ¨¡å¼æ˜¯æ„å»ºä¸€ä¸ªå¯ä»¥ç”¨åˆ°ä»»ä½•åœ°æ–¹çš„ Web Components ç»„ä»¶åº“ï¼›ç¬¬äºŒç§æ¨¡å¼æ˜¯ç”¨æ¥æ„å»ºä¸€ä¸ªé™æ€ç½‘ç«™æˆ–è€…ä¸€ä¸ªåº”ç”¨ã€‚æˆ‘ä»¬é€‰æ‹©ç¬¬ä¸€ä¸ªç»„ä»¶åº“ç±»å‹ã€‚

æ¥ä¸‹æ¥å°±æ˜¯è¾“å…¥åç§°ï¼Œæˆ‘ä»¬è¿˜æ˜¯ä»¥ sten-components å‘½åè¿™ä¸ª packageã€‚

```
âœ” Pick a starter â€º component

âœ” Project name â€º sten-components



âœ” All setup  in 22 ms



  $ npm start

    Starts the development server.



  $ npm run build

    Builds your components/app in production mode.



  $ npm test

    Starts the test runner.





  We suggest that you begin by typing:



   $ cd sten-components

   $ npm install

   $ npm start



  Further reading:



   - https://github.com/ionic-team/stencil-component-starter



  Happy coding! ğŸˆ
```

æ­¤æ—¶ï¼Œåˆå§‹åŒ–å®‰è£…å®Œæˆï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œsten-components æ–‡ä»¶å¤¹å·²ç»è¢«é‡æ–°ç”Ÿæˆã€‚å…¶ç›®å½•ç»“æ„å¦‚ä¸‹ï¼š

```
â”œâ”€â”€ LICENSE

â”œâ”€â”€ package.json

â”œâ”€â”€ readme.md

â”œâ”€â”€ src

â”‚   â”œâ”€â”€ components

â”‚   â”‚   â””â”€â”€ my-component

â”‚   â”œâ”€â”€ components.d.ts

â”‚   â”œâ”€â”€ index.html

â”‚   â”œâ”€â”€ index.ts

â”‚   â””â”€â”€ utils

â”‚       â”œâ”€â”€ utils.spec.ts

â”‚       â””â”€â”€ utils.ts

â”œâ”€â”€ stencil.config.ts

â””â”€â”€ tsconfig.json
```

### é‡æ–°æ„å»ºä¾èµ–

å®‰è£…å®Œæˆåï¼Œæˆ‘ä»¬éœ€è¦é‡æ–°æ„å»ºä¸€ä¸‹ä¾èµ–ï¼Œä½†ä¸æ˜¯åœ¨å½“å‰æ–‡ä»¶å¤¹æ‰§è¡Œï¼Œæˆ‘ä»¬éœ€è¦å›åˆ°é¡¹ç›®çš„æ ¹ç›®å½•ï¼Œæˆ–è€…ç›´æ¥ä½¿ç”¨`  lerna bootstrap  `æ¥æ‰§è¡Œä¾èµ–çš„é‡æ–°æ„å»ºå’Œåˆ†æã€‚

æ‰§è¡Œå®Œåä¼šå‘ç° pnpm å·²ç»æŠŠéœ€è¦çš„ npm åŒ…è¿›è¡Œè¿æ¥ï¼Œä½†æ˜¯ä¸ä¼šæœ‰äºŒçº§ä¾èµ–æ·»åŠ ï¼Œçœ‹ç€æ˜¯ä¸æ˜¯å¾ˆæ¸…çˆ½å‘¢ã€‚

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c8f661202f88476e8d996fa30ef3681f~tplv-k3u1fbpfcp-zoom-1.image)

*å¦‚æœæ²¡æœ‰è¯†åˆ«åˆ° packages æ–‡ä»¶å¤¹å†…çš„ package.json æ–‡ä»¶ï¼Œåˆ™éœ€è¦æ·»åŠ  pnpm-workspace.yaml æ–‡ä»¶å£°æ˜ pnpm çš„ workspaceï¼š*

```
packages:

  - 'packages/**'

  - '!packages/__mocks__'

  - docs

  - '!**/__tests__/**'
```

æ¥ä¸‹æ¥æˆ‘ä»¬ä¿®æ”¹ä¸‹é»˜è®¤çš„ package.json é‡Œé¢çš„ name å±æ€§ï¼Œä½¿å…¶ä¿æŒç»Ÿä¸€ï¼š

```
{

   "name": "@sten-design/components"

}
```

æ­¤æ—¶æ‰§è¡Œ `lerna list` å°±å¯ä»¥çœ‹åˆ°å½“å‰ lerna ä»“åº“ä¸­å·²ç»æ³¨å†Œçš„ package æœ‰å“ªäº›äº†ã€‚

```
âœ  sten-design git:(master) âœ— lerna list

info cli using local version of lerna

lerna notice cli v4.0.0

lerna info versioning independent

@sten-design/components

@sten-design/icons

@sten-design/themes

lerna success found 3 packages
```

## å¯åŠ¨

Stencil åˆå§‹åŒ–å’Œ ` Lerna bootstrap  `æ‰§è¡Œå®Œæ¯•åï¼Œæˆ‘ä»¬å°±å¯ä»¥æ ¹æ®æŒ‡ä»¤æ¥å¯åŠ¨æˆ‘ä»¬çš„é¡¹ç›®ï¼Œä½†æ˜¯åœ¨æ ¹ç›®å½•ä¸‹ï¼Œæˆ‘ä»¬å¯åŠ¨å­ package çš„å‘½ä»¤è¿˜éœ€è¦åå¤è¿›è¡Œç›®å½•çš„åˆ‡æ¢ï¼Œæ¯”è¾ƒç¹çï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ® lerna æä¾›çš„æŒ‡ä»¤æ¥åœ¨æ ¹ç›®å½• package.json é‡Œé¢å®šä¹‰ script æ¥å¯åŠ¨å­ç›®å½•çš„ scriptã€‚å…·ä½“è®¾ç½®å¦‚ä¸‹ï¼š

```
// package.json



"scripts": {

    "commit": "git cz",

    "release": "standard-version",

    "start:components": "lerna run start --scope=@sten-design/components",

},
```

æ¥ä¸‹æ¥æˆ‘ä»¬å¯åŠ¨ Stencilï¼š

```
pnpm start:components
```

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7b22daf4672149e0bb423845b674f6df~tplv-k3u1fbpfcp-zoom-1.image)

å¯åŠ¨å®Œæ¯•~

å¯ä»¥çœ‹åˆ°ï¼Œé»˜è®¤åˆå§‹åŒ–çš„é¡¹ç›®ä¸‹ä¼šæœ‰ä¸€ä¸ªæµ‹è¯•çš„ components ä¸º "my-component" ï¼Œæˆ‘ä»¬æ¥å¯¹å®ƒè¿›è¡Œä¸€äº›ç®€å•çš„ä¿®æ”¹å°è¯•æ¥çœ‹ä¸‹å˜åŒ–å¦‚ä½•ã€‚

```
â”œâ”€â”€ components

â”‚   â””â”€â”€ my-component

â”‚       â”œâ”€â”€ my-component.css

â”‚       â”œâ”€â”€ my-component.e2e.ts

â”‚       â”œâ”€â”€ my-component.spec.ts

â”‚       â”œâ”€â”€ my-component.tsx

â”‚       â””â”€â”€ readme.md

â”œâ”€â”€ components.d.ts

â”œâ”€â”€ index.html

â”œâ”€â”€ index.ts
```

æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªå˜é‡ numï¼ŒåŠ ä¸€ä¸ªæŒ‰é’®ä½¿æ¯æ¬¡ç‚¹å‡»éƒ½+1ã€‚

```
  

{

 ...

 @State() num: number = 0;



  private getText(): string {

    return format(this.first, this.middle, this.last);

  }



  render() {

    return <div><button onClick={() => this.num += 1}>add</button>Hello, World! I'm {this.getText()}, number is {this.num}</div>;

  }

}
```

ç„¶ååœ¨æµè§ˆå™¨çœ‹ä¸‹æ•ˆæœï¼š

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b44167b3650d48b28705df42d4044265~tplv-k3u1fbpfcp-zoom-1.image)

## æ–°å¢ç»„ä»¶

Stencil æä¾›äº†è„šæœ¬ `generate` å¯ä»¥ç”¨æ¥å¿«é€Ÿæ–°å¢ç»„ä»¶ï¼Œå¹¶å¯é€‰æ‹©çš„åˆå§‹åŒ–é…å¥—çš„ e2e æ–‡ä»¶å’Œ unit æ–‡ä»¶ã€‚è€è§„çŸ©ï¼Œä¸ºäº†æ›´å¿«æ‰§è¡Œï¼Œæˆ‘ä»¬åœ¨æ ¹ç›®å½•çš„ package.json æ–‡ä»¶æ–°å¢ä¸€ä¸ªè„šæœ¬ï¼Œç”¨äºæ‰§è¡Œ `generate` å‘½ä»¤ï¼š

```
"scripts": {

    "commit": "git cz",

    "release": "standard-version",

    "start:components": "lerna run start --scope=@sten-design/components",

    "generate:components": "lerna run generate --scope=@sten-design/components"

 },
```

ç„¶åæˆ‘ä»¬æ‰§è¡Œ `pnpm generate:components`ï¼š

```
$ stencil generate

[48:40.4]  @stencil/core

[48:40.7]  v2.13.0 ğŸ£

? Component tag name (dash-case): â€º 
```

æ³¨æ„ï¼šcomponent çš„æ–‡ä»¶åå¿…é¡»ä»¥ â€œ-â€ è¿æ¥ï¼Œæ¯”å¦‚ sten-tooltipã€sten-tab ç­‰ã€‚

```
âœ” Component tag name (dash-case): â€¦ sten-button

? Which additional files do you want to generate? â€º  

Instructions:

    â†‘/â†“: Highlight option

    â†/â†’/[space]: Toggle selection

    a: Toggle all

    enter/return: Complete answer

â—‰   Stylesheet (.css)

â—‰   Spec Test  (.spec.tsx)

â—‰   E2E Test (.e2e.ts)
```

è¾“å…¥å®Œæ¯•ç»„ä»¶ååï¼Œä¼šæœ‰ä¸€ä¸ªäº¤äº’æ€§æŒ‡ä»¤è¯´æ˜æ˜¯æ˜¯å¦éœ€è¦é…å¥—çš„æ–‡ä»¶ï¼Œæˆ‘ä»¬æš‚æ—¶éƒ½é€‰æ˜¯ã€‚

æœ€åä¼šå‘ç°ä¸€ä¸ªæ–°çš„ç»„ä»¶æ–‡ä»¶å¤¹ä¼šè¢«æ·»åŠ ï¼š

```
$ stencil generate sten-button



The following files have been generated:

  - ./src/components/sten-button/sten-button.tsx

  - ./src/components/sten-button/sten-button.css

  - ./src/components/sten-button/test/sten-button.spec.tsx

  - ./src/components/sten-button/test/sten-button.e2e.ts
```

åŒ…å«äº† tsx ä¸»è¦é€»è¾‘ã€css æ–‡ä»¶ã€è¿˜æœ‰ä¸¤ä¸ªæµ‹è¯•æ–‡ä»¶ã€‚

æˆ‘ä»¬éšä¾¿åœ¨ tsx æ–‡ä»¶ä¸­å†™ç‚¹ä¸œè¥¿ï¼š

```
// sten-button.tsx

import { Component, Host, h } from '@stencil/core';



@Component({

  tag: 'sten-button',

  styleUrl: 'sten-button.css',

  shadow: true,

})

export class StenButton {



  render() {

    return (

      <Host>

        <button class="sten-button"><slot></slot></button>

      </Host>

    );

  }



}
```

```
// sten-button.css

:host {

  display: block;

}



.sten-button {

  width: 100px;

  height: 40px;

  border-radius: 20px;

  background-color: #00bcd4;

  color: #fff;
  
  border: none;

}
```

ç„¶åä¿®æ”¹ä¸‹ index.html æŠŠæˆ‘ä»¬æ–°å»ºçš„ç»„ä»¶æ·»åŠ ï¼š

```
<body>

    <my-component first="Stencil" last="'Don't call me a framework' JS"></my-component>

    <sten-button>ä½ å¥½</sten-button>

</body>
```

å¯ä»¥çœ‹åˆ°æ•ˆæœï¼š

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1f590cd4027b4aaeb858b2591f0ab745~tplv-k3u1fbpfcp-zoom-1.image)

## æ€»ç»“

æ­¤ç¯‡æˆ‘ä»¬å­¦åˆ°äº† Stencil æ¡†æ¶çš„å®‰è£…ã€åˆå§‹åŒ–ã€å¯åŠ¨ã€æ·»åŠ æ–°ç»„ä»¶ç­‰æ­¥éª¤ï¼Œè¿™ä¹Ÿæ˜¯æ„å»ºæˆ‘ä»¬ç»„ä»¶åº“çš„ç¬¬ä¸€æ­¥ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬ä¼šä»”ç»†å­¦ä¹ ä¸‹ Stencil çš„ä¸€äº›ç‰¹æ€§ï¼Œå¹¶ä¸”åŠ ä»¥å®è·µï¼Œé€æ¸æŠŠæˆ‘ä»¬çš„ç»„ä»¶åº“ä¸°å¯Œèµ·æ¥ã€‚